import{e as t}from"./p-4fef1e3b.js";import{b as n,f as r,r as e,d as i,a as s,g as o,c as a,h as u}from"./p-bea8cd94.js";import"./p-c1445dc6.js";var c=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){var r=t>>>16&65535,e=t&65535;var i=n>>>16&65535,s=n&65535;return e*s+(r*s+e*i<<16>>>0)|0}n.mul=Math.imul||r;function e(t,n){return t+n|0}n.add=e;function i(t,n){return t-n|0}n.sub=i;function s(t,n){return t<<n|t>>>32-n}n.rotl=s;function o(t,n){return t<<32-n|t>>>n}n.rotr=o;function a(t){return typeof t==="number"&&isFinite(t)&&Math.floor(t)===t}n.isInteger=Number.isInteger||a;n.MAX_SAFE_INTEGER=9007199254740991;n.isSafeInteger=function(t){return n.isInteger(t)&&(t>=-n.MAX_SAFE_INTEGER&&t<=n.MAX_SAFE_INTEGER)}}));var h=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(n===void 0){n=0}return(t[n+0]<<8|t[n+1])<<16>>16}n.readInt16BE=r;function e(t,n){if(n===void 0){n=0}return(t[n+0]<<8|t[n+1])>>>0}n.readUint16BE=e;function i(t,n){if(n===void 0){n=0}return(t[n+1]<<8|t[n])<<16>>16}n.readInt16LE=i;function s(t,n){if(n===void 0){n=0}return(t[n+1]<<8|t[n])>>>0}n.readUint16LE=s;function o(t,n,r){if(n===void 0){n=new Uint8Array(2)}if(r===void 0){r=0}n[r+0]=t>>>8;n[r+1]=t>>>0;return n}n.writeUint16BE=o;n.writeInt16BE=o;function a(t,n,r){if(n===void 0){n=new Uint8Array(2)}if(r===void 0){r=0}n[r+0]=t>>>0;n[r+1]=t>>>8;return n}n.writeUint16LE=a;n.writeInt16LE=a;function u(t,n){if(n===void 0){n=0}return t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3]}n.readInt32BE=u;function h(t,n){if(n===void 0){n=0}return(t[n]<<24|t[n+1]<<16|t[n+2]<<8|t[n+3])>>>0}n.readUint32BE=h;function f(t,n){if(n===void 0){n=0}return t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n]}n.readInt32LE=f;function l(t,n){if(n===void 0){n=0}return(t[n+3]<<24|t[n+2]<<16|t[n+1]<<8|t[n])>>>0}n.readUint32LE=l;function d(t,n,r){if(n===void 0){n=new Uint8Array(4)}if(r===void 0){r=0}n[r+0]=t>>>24;n[r+1]=t>>>16;n[r+2]=t>>>8;n[r+3]=t>>>0;return n}n.writeUint32BE=d;n.writeInt32BE=d;function p(t,n,r){if(n===void 0){n=new Uint8Array(4)}if(r===void 0){r=0}n[r+0]=t>>>0;n[r+1]=t>>>8;n[r+2]=t>>>16;n[r+3]=t>>>24;return n}n.writeUint32LE=p;n.writeInt32LE=p;function v(t,n){if(n===void 0){n=0}var r=u(t,n);var e=u(t,n+4);return r*4294967296+e-(e>>31)*4294967296}n.readInt64BE=v;function w(t,n){if(n===void 0){n=0}var r=h(t,n);var e=h(t,n+4);return r*4294967296+e}n.readUint64BE=w;function y(t,n){if(n===void 0){n=0}var r=f(t,n);var e=f(t,n+4);return e*4294967296+r-(r>>31)*4294967296}n.readInt64LE=y;function b(t,n){if(n===void 0){n=0}var r=l(t,n);var e=l(t,n+4);return e*4294967296+r}n.readUint64LE=b;function m(t,n,r){if(n===void 0){n=new Uint8Array(8)}if(r===void 0){r=0}d(t/4294967296>>>0,n,r);d(t>>>0,n,r+4);return n}n.writeUint64BE=m;n.writeInt64BE=m;function g(t,n,r){if(n===void 0){n=new Uint8Array(8)}if(r===void 0){r=0}p(t>>>0,n,r);p(t/4294967296>>>0,n,r+4);return n}n.writeUint64LE=g;n.writeInt64LE=g;function _(t,n,r){if(r===void 0){r=0}if(t%8!==0){throw new Error("readUintBE supports only bitLengths divisible by 8")}if(t/8>n.length-r){throw new Error("readUintBE: array is too short for the given bitLength")}var e=0;var i=1;for(var s=t/8+r-1;s>=r;s--){e+=n[s]*i;i*=256}return e}n.readUintBE=_;function E(t,n,r){if(r===void 0){r=0}if(t%8!==0){throw new Error("readUintLE supports only bitLengths divisible by 8")}if(t/8>n.length-r){throw new Error("readUintLE: array is too short for the given bitLength")}var e=0;var i=1;for(var s=r;s<r+t/8;s++){e+=n[s]*i;i*=256}return e}n.readUintLE=E;function O(t,n,r,e){if(r===void 0){r=new Uint8Array(t/8)}if(e===void 0){e=0}if(t%8!==0){throw new Error("writeUintBE supports only bitLengths divisible by 8")}if(!c.isSafeInteger(n)){throw new Error("writeUintBE value must be an integer")}var i=1;for(var s=t/8+e-1;s>=e;s--){r[s]=n/i&255;i*=256}return r}n.writeUintBE=O;function S(t,n,r,e){if(r===void 0){r=new Uint8Array(t/8)}if(e===void 0){e=0}if(t%8!==0){throw new Error("writeUintLE supports only bitLengths divisible by 8")}if(!c.isSafeInteger(n)){throw new Error("writeUintLE value must be an integer")}var i=1;for(var s=e;s<e+t/8;s++){r[s]=n/i&255;i*=256}return r}n.writeUintLE=S;function I(t,n){if(n===void 0){n=0}var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(n)}n.readFloat32BE=I;function j(t,n){if(n===void 0){n=0}var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(n,true)}n.readFloat32LE=j;function A(t,n){if(n===void 0){n=0}var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(n)}n.readFloat64BE=A;function N(t,n){if(n===void 0){n=0}var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(n,true)}n.readFloat64LE=N;function P(t,n,r){if(n===void 0){n=new Uint8Array(4)}if(r===void 0){r=0}var e=new DataView(n.buffer,n.byteOffset,n.byteLength);e.setFloat32(r,t);return n}n.writeFloat32BE=P;function x(t,n,r){if(n===void 0){n=new Uint8Array(4)}if(r===void 0){r=0}var e=new DataView(n.buffer,n.byteOffset,n.byteLength);e.setFloat32(r,t,true);return n}n.writeFloat32LE=x;function $(t,n,r){if(n===void 0){n=new Uint8Array(8)}if(r===void 0){r=0}var e=new DataView(n.buffer,n.byteOffset,n.byteLength);e.setFloat64(r,t);return n}n.writeFloat64BE=$;function T(t,n,r){if(n===void 0){n=new Uint8Array(8)}if(r===void 0){r=0}var e=new DataView(n.buffer,n.byteOffset,n.byteLength);e.setFloat64(r,t,true);return n}n.writeFloat64LE=T}));var f=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){for(var n=0;n<t.length;n++){t[n]=0}return t}n.wipe=r}));var l=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});var r=20;function e(t,n,e){var i=1634760805;var s=857760878;var o=2036477234;var a=1797285236;var u=e[3]<<24|e[2]<<16|e[1]<<8|e[0];var c=e[7]<<24|e[6]<<16|e[5]<<8|e[4];var f=e[11]<<24|e[10]<<16|e[9]<<8|e[8];var l=e[15]<<24|e[14]<<16|e[13]<<8|e[12];var d=e[19]<<24|e[18]<<16|e[17]<<8|e[16];var p=e[23]<<24|e[22]<<16|e[21]<<8|e[20];var v=e[27]<<24|e[26]<<16|e[25]<<8|e[24];var w=e[31]<<24|e[30]<<16|e[29]<<8|e[28];var y=n[3]<<24|n[2]<<16|n[1]<<8|n[0];var b=n[7]<<24|n[6]<<16|n[5]<<8|n[4];var m=n[11]<<24|n[10]<<16|n[9]<<8|n[8];var g=n[15]<<24|n[14]<<16|n[13]<<8|n[12];var _=i;var E=s;var O=o;var S=a;var I=u;var j=c;var A=f;var N=l;var P=d;var x=p;var $=v;var T=w;var M=y;var C=b;var R=m;var U=g;for(var D=0;D<r;D+=2){_=_+I|0;M^=_;M=M>>>32-16|M<<16;P=P+M|0;I^=P;I=I>>>32-12|I<<12;E=E+j|0;C^=E;C=C>>>32-16|C<<16;x=x+C|0;j^=x;j=j>>>32-12|j<<12;O=O+A|0;R^=O;R=R>>>32-16|R<<16;$=$+R|0;A^=$;A=A>>>32-12|A<<12;S=S+N|0;U^=S;U=U>>>32-16|U<<16;T=T+U|0;N^=T;N=N>>>32-12|N<<12;O=O+A|0;R^=O;R=R>>>32-8|R<<8;$=$+R|0;A^=$;A=A>>>32-7|A<<7;S=S+N|0;U^=S;U=U>>>32-8|U<<8;T=T+U|0;N^=T;N=N>>>32-7|N<<7;E=E+j|0;C^=E;C=C>>>32-8|C<<8;x=x+C|0;j^=x;j=j>>>32-7|j<<7;_=_+I|0;M^=_;M=M>>>32-8|M<<8;P=P+M|0;I^=P;I=I>>>32-7|I<<7;_=_+j|0;U^=_;U=U>>>32-16|U<<16;$=$+U|0;j^=$;j=j>>>32-12|j<<12;E=E+A|0;M^=E;M=M>>>32-16|M<<16;T=T+M|0;A^=T;A=A>>>32-12|A<<12;O=O+N|0;C^=O;C=C>>>32-16|C<<16;P=P+C|0;N^=P;N=N>>>32-12|N<<12;S=S+I|0;R^=S;R=R>>>32-16|R<<16;x=x+R|0;I^=x;I=I>>>32-12|I<<12;O=O+N|0;C^=O;C=C>>>32-8|C<<8;P=P+C|0;N^=P;N=N>>>32-7|N<<7;S=S+I|0;R^=S;R=R>>>32-8|R<<8;x=x+R|0;I^=x;I=I>>>32-7|I<<7;E=E+A|0;M^=E;M=M>>>32-8|M<<8;T=T+M|0;A^=T;A=A>>>32-7|A<<7;_=_+j|0;U^=_;U=U>>>32-8|U<<8;$=$+U|0;j^=$;j=j>>>32-7|j<<7}h.writeUint32LE(_+i|0,t,0);h.writeUint32LE(E+s|0,t,4);h.writeUint32LE(O+o|0,t,8);h.writeUint32LE(S+a|0,t,12);h.writeUint32LE(I+u|0,t,16);h.writeUint32LE(j+c|0,t,20);h.writeUint32LE(A+f|0,t,24);h.writeUint32LE(N+l|0,t,28);h.writeUint32LE(P+d|0,t,32);h.writeUint32LE(x+p|0,t,36);h.writeUint32LE($+v|0,t,40);h.writeUint32LE(T+w|0,t,44);h.writeUint32LE(M+y|0,t,48);h.writeUint32LE(C+b|0,t,52);h.writeUint32LE(R+m|0,t,56);h.writeUint32LE(U+g|0,t,60)}function i(t,n,r,i,s){if(s===void 0){s=0}if(t.length!==32){throw new Error("ChaCha: key size must be 32 bytes")}if(i.length<r.length){throw new Error("ChaCha: destination is shorter than source")}var a;var u;if(s===0){if(n.length!==8&&n.length!==12){throw new Error("ChaCha nonce must be 8 or 12 bytes")}a=new Uint8Array(16);u=a.length-n.length;a.set(n,u)}else{if(n.length!==16){throw new Error("ChaCha nonce with counter must be 16 bytes")}a=n;u=s}var c=new Uint8Array(64);for(var h=0;h<r.length;h+=64){e(c,a,t);for(var l=h;l<h+64&&l<r.length;l++){i[l]=r[l]^c[l-h]}o(a,0,u)}f.wipe(c);if(s===0){f.wipe(a)}return i}n.streamXOR=i;function s(t,n,r,e){if(e===void 0){e=0}f.wipe(r);return i(t,n,r,r,e)}n.stream=s;function o(t,n,r){var e=1;while(r--){e=e+(t[n]&255)|0;t[n]=e&255;e>>>=8;n++}if(e>0){throw new Error("ChaCha: counter overflow")}}}));var d=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n,r){return~(t-1)&n|t-1&r}n.select=r;function e(t,n){return(t|0)-(n|0)-1>>>31&1}n.lessOrEqual=e;function i(t,n){if(t.length!==n.length){return 0}var r=0;for(var e=0;e<t.length;e++){r|=t[e]^n[e]}return 1&r-1>>>8}n.compare=i;function s(t,n){if(t.length===0||n.length===0){return false}return i(t,n)!==0}n.equal=s}));var p=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.DIGEST_LENGTH=16;var r=function(){function t(t){this.digestLength=n.DIGEST_LENGTH;this._buffer=new Uint8Array(16);this._r=new Uint16Array(10);this._h=new Uint16Array(10);this._pad=new Uint16Array(8);this._leftover=0;this._fin=0;this._finished=false;var r=t[0]|t[1]<<8;this._r[0]=r&8191;var e=t[2]|t[3]<<8;this._r[1]=(r>>>13|e<<3)&8191;var i=t[4]|t[5]<<8;this._r[2]=(e>>>10|i<<6)&7939;var s=t[6]|t[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var o=t[8]|t[9]<<8;this._r[4]=(s>>>4|o<<12)&255;this._r[5]=o>>>1&8190;var a=t[10]|t[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var u=t[12]|t[13]<<8;this._r[7]=(a>>>11|u<<5)&8065;var c=t[14]|t[15]<<8;this._r[8]=(u>>>8|c<<8)&8191;this._r[9]=c>>>5&127;this._pad[0]=t[16]|t[17]<<8;this._pad[1]=t[18]|t[19]<<8;this._pad[2]=t[20]|t[21]<<8;this._pad[3]=t[22]|t[23]<<8;this._pad[4]=t[24]|t[25]<<8;this._pad[5]=t[26]|t[27]<<8;this._pad[6]=t[28]|t[29]<<8;this._pad[7]=t[30]|t[31]<<8}t.prototype._blocks=function(t,n,r){var e=this._fin?0:1<<11;var i=this._h[0],s=this._h[1],o=this._h[2],a=this._h[3],u=this._h[4],c=this._h[5],h=this._h[6],f=this._h[7],l=this._h[8],d=this._h[9];var p=this._r[0],v=this._r[1],w=this._r[2],y=this._r[3],b=this._r[4],m=this._r[5],g=this._r[6],_=this._r[7],E=this._r[8],O=this._r[9];while(r>=16){var S=t[n+0]|t[n+1]<<8;i+=S&8191;var I=t[n+2]|t[n+3]<<8;s+=(S>>>13|I<<3)&8191;var j=t[n+4]|t[n+5]<<8;o+=(I>>>10|j<<6)&8191;var A=t[n+6]|t[n+7]<<8;a+=(j>>>7|A<<9)&8191;var N=t[n+8]|t[n+9]<<8;u+=(A>>>4|N<<12)&8191;c+=N>>>1&8191;var P=t[n+10]|t[n+11]<<8;h+=(N>>>14|P<<2)&8191;var x=t[n+12]|t[n+13]<<8;f+=(P>>>11|x<<5)&8191;var $=t[n+14]|t[n+15]<<8;l+=(x>>>8|$<<8)&8191;d+=$>>>5|e;var T=0;var M=T;M+=i*p;M+=s*(5*O);M+=o*(5*E);M+=a*(5*_);M+=u*(5*g);T=M>>>13;M&=8191;M+=c*(5*m);M+=h*(5*b);M+=f*(5*y);M+=l*(5*w);M+=d*(5*v);T+=M>>>13;M&=8191;var C=T;C+=i*v;C+=s*p;C+=o*(5*O);C+=a*(5*E);C+=u*(5*_);T=C>>>13;C&=8191;C+=c*(5*g);C+=h*(5*m);C+=f*(5*b);C+=l*(5*y);C+=d*(5*w);T+=C>>>13;C&=8191;var R=T;R+=i*w;R+=s*v;R+=o*p;R+=a*(5*O);R+=u*(5*E);T=R>>>13;R&=8191;R+=c*(5*_);R+=h*(5*g);R+=f*(5*m);R+=l*(5*b);R+=d*(5*y);T+=R>>>13;R&=8191;var U=T;U+=i*y;U+=s*w;U+=o*v;U+=a*p;U+=u*(5*O);T=U>>>13;U&=8191;U+=c*(5*E);U+=h*(5*_);U+=f*(5*g);U+=l*(5*m);U+=d*(5*b);T+=U>>>13;U&=8191;var D=T;D+=i*b;D+=s*y;D+=o*w;D+=a*v;D+=u*p;T=D>>>13;D&=8191;D+=c*(5*O);D+=h*(5*E);D+=f*(5*_);D+=l*(5*g);D+=d*(5*m);T+=D>>>13;D&=8191;var k=T;k+=i*m;k+=s*b;k+=o*y;k+=a*w;k+=u*v;T=k>>>13;k&=8191;k+=c*p;k+=h*(5*O);k+=f*(5*E);k+=l*(5*_);k+=d*(5*g);T+=k>>>13;k&=8191;var L=T;L+=i*g;L+=s*m;L+=o*b;L+=a*y;L+=u*w;T=L>>>13;L&=8191;L+=c*v;L+=h*p;L+=f*(5*O);L+=l*(5*E);L+=d*(5*_);T+=L>>>13;L&=8191;var q=T;q+=i*_;q+=s*g;q+=o*m;q+=a*b;q+=u*y;T=q>>>13;q&=8191;q+=c*w;q+=h*v;q+=f*p;q+=l*(5*O);q+=d*(5*E);T+=q>>>13;q&=8191;var V=T;V+=i*E;V+=s*_;V+=o*g;V+=a*m;V+=u*b;T=V>>>13;V&=8191;V+=c*y;V+=h*w;V+=f*v;V+=l*p;V+=d*(5*O);T+=V>>>13;V&=8191;var F=T;F+=i*O;F+=s*E;F+=o*_;F+=a*g;F+=u*m;T=F>>>13;F&=8191;F+=c*b;F+=h*y;F+=f*w;F+=l*v;F+=d*p;T+=F>>>13;F&=8191;T=(T<<2)+T|0;T=T+M|0;M=T&8191;T=T>>>13;C+=T;i=M;s=C;o=R;a=U;u=D;c=k;h=L;f=q;l=V;d=F;n+=16;r-=16}this._h[0]=i;this._h[1]=s;this._h[2]=o;this._h[3]=a;this._h[4]=u;this._h[5]=c;this._h[6]=h;this._h[7]=f;this._h[8]=l;this._h[9]=d};t.prototype.finish=function(t,n){if(n===void 0){n=0}var r=new Uint16Array(10);var e;var i;var s;var o;if(this._leftover){o=this._leftover;this._buffer[o++]=1;for(;o<16;o++){this._buffer[o]=0}this._fin=1;this._blocks(this._buffer,0,16)}e=this._h[1]>>>13;this._h[1]&=8191;for(o=2;o<10;o++){this._h[o]+=e;e=this._h[o]>>>13;this._h[o]&=8191}this._h[0]+=e*5;e=this._h[0]>>>13;this._h[0]&=8191;this._h[1]+=e;e=this._h[1]>>>13;this._h[1]&=8191;this._h[2]+=e;r[0]=this._h[0]+5;e=r[0]>>>13;r[0]&=8191;for(o=1;o<10;o++){r[o]=this._h[o]+e;e=r[o]>>>13;r[o]&=8191}r[9]-=1<<13;i=(e^1)-1;for(o=0;o<10;o++){r[o]&=i}i=~i;for(o=0;o<10;o++){this._h[o]=this._h[o]&i|r[o]}this._h[0]=(this._h[0]|this._h[1]<<13)&65535;this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535;this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535;this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535;this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535;this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535;this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535;this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535;s=this._h[0]+this._pad[0];this._h[0]=s&65535;for(o=1;o<8;o++){s=(this._h[o]+this._pad[o]|0)+(s>>>16)|0;this._h[o]=s&65535}t[n+0]=this._h[0]>>>0;t[n+1]=this._h[0]>>>8;t[n+2]=this._h[1]>>>0;t[n+3]=this._h[1]>>>8;t[n+4]=this._h[2]>>>0;t[n+5]=this._h[2]>>>8;t[n+6]=this._h[3]>>>0;t[n+7]=this._h[3]>>>8;t[n+8]=this._h[4]>>>0;t[n+9]=this._h[4]>>>8;t[n+10]=this._h[5]>>>0;t[n+11]=this._h[5]>>>8;t[n+12]=this._h[6]>>>0;t[n+13]=this._h[6]>>>8;t[n+14]=this._h[7]>>>0;t[n+15]=this._h[7]>>>8;this._finished=true;return this};t.prototype.update=function(t){var n=0;var r=t.length;var e;if(this._leftover){e=16-this._leftover;if(e>r){e=r}for(var i=0;i<e;i++){this._buffer[this._leftover+i]=t[n+i]}r-=e;n+=e;this._leftover+=e;if(this._leftover<16){return this}this._blocks(this._buffer,0,16);this._leftover=0}if(r>=16){e=r-r%16;this._blocks(t,n,e);n+=e;r-=e}if(r){for(var i=0;i<r;i++){this._buffer[this._leftover+i]=t[n+i]}this._leftover+=r}return this};t.prototype.digest=function(){if(this._finished){throw new Error("Poly1305 was finished")}var t=new Uint8Array(16);this.finish(t);return t};t.prototype.clean=function(){f.wipe(this._buffer);f.wipe(this._r);f.wipe(this._h);f.wipe(this._pad);this._leftover=0;this._fin=0;this._finished=true;return this};return t}();n.Poly1305=r;function e(t,n){var e=new r(t);e.update(n);var i=e.digest();e.clean();return i}n.oneTimeAuth=e;function i(t,r){if(t.length!==n.DIGEST_LENGTH||r.length!==n.DIGEST_LENGTH){return false}return d.equal(t,r)}n.equal=i}));var v=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.KEY_LENGTH=32;n.NONCE_LENGTH=12;n.TAG_LENGTH=16;var r=new Uint8Array(16);var e=function(){function t(t){this.nonceLength=n.NONCE_LENGTH;this.tagLength=n.TAG_LENGTH;if(t.length!==n.KEY_LENGTH){throw new Error("ChaCha20Poly1305 needs 32-byte key")}this._key=new Uint8Array(t)}t.prototype.seal=function(t,n,r,e){if(t.length>16){throw new Error("ChaCha20Poly1305: incorrect nonce length")}var i=new Uint8Array(16);i.set(t,i.length-t.length);var s=new Uint8Array(32);l.stream(this._key,i,s,4);var o=n.length+this.tagLength;var a;if(e){if(e.length!==o){throw new Error("ChaCha20Poly1305: incorrect destination length")}a=e}else{a=new Uint8Array(o)}l.streamXOR(this._key,i,n,a,4);this._authenticate(a.subarray(a.length-this.tagLength,a.length),s,a.subarray(0,a.length-this.tagLength),r);f.wipe(i);return a};t.prototype.open=function(t,n,r,e){if(t.length>16){throw new Error("ChaCha20Poly1305: incorrect nonce length")}if(n.length<this.tagLength){return null}var i=new Uint8Array(16);i.set(t,i.length-t.length);var s=new Uint8Array(32);l.stream(this._key,i,s,4);var o=new Uint8Array(this.tagLength);this._authenticate(o,s,n.subarray(0,n.length-this.tagLength),r);if(!d.equal(o,n.subarray(n.length-this.tagLength,n.length))){return null}var a=n.length-this.tagLength;var u;if(e){if(e.length!==a){throw new Error("ChaCha20Poly1305: incorrect destination length")}u=e}else{u=new Uint8Array(a)}l.streamXOR(this._key,i,n.subarray(0,n.length-this.tagLength),u,4);f.wipe(i);return u};t.prototype.clean=function(){f.wipe(this._key);return this};t.prototype._authenticate=function(t,n,e,i){var s=new p.Poly1305(n);if(i){s.update(i);if(i.length%16>0){s.update(r.subarray(i.length%16))}}s.update(e);if(e.length%16>0){s.update(r.subarray(e.length%16))}var o=new Uint8Array(8);if(i){h.writeUint64LE(i.length,o)}s.update(o);h.writeUint64LE(e.length,o);s.update(o);var a=s.digest();for(var u=0;u<a.length;u++){t[u]=a[u]}s.clean();f.wipe(a);f.wipe(o)};return t}();n.ChaCha20Poly1305=e}));var w=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){return typeof t.saveState!=="undefined"&&typeof t.restoreState!=="undefined"&&typeof t.cleanSavedState!=="undefined"}n.isSerializableHash=r}));var y=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});var r=function(){function t(t,n){this._finished=false;this._inner=new t;this._outer=new t;this.blockSize=this._outer.blockSize;this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);if(n.length>this.blockSize){this._inner.update(n).finish(r).clean()}else{r.set(n)}for(var e=0;e<r.length;e++){r[e]^=54}this._inner.update(r);for(var e=0;e<r.length;e++){r[e]^=54^92}this._outer.update(r);if(w.isSerializableHash(this._inner)&&w.isSerializableHash(this._outer)){this._innerKeyedState=this._inner.saveState();this._outerKeyedState=this._outer.saveState()}f.wipe(r)}t.prototype.reset=function(){if(!w.isSerializableHash(this._inner)||!w.isSerializableHash(this._outer)){throw new Error("hmac: can't reset() because hash doesn't implement restoreState()")}this._inner.restoreState(this._innerKeyedState);this._outer.restoreState(this._outerKeyedState);this._finished=false;return this};t.prototype.clean=function(){if(w.isSerializableHash(this._inner)){this._inner.cleanSavedState(this._innerKeyedState)}if(w.isSerializableHash(this._outer)){this._outer.cleanSavedState(this._outerKeyedState)}this._inner.clean();this._outer.clean()};t.prototype.update=function(t){this._inner.update(t);return this};t.prototype.finish=function(t){if(this._finished){this._outer.finish(t);return this}this._inner.finish(t);this._outer.update(t.subarray(0,this.digestLength)).finish(t);this._finished=true;return this};t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);this.finish(t);return t};t.prototype.saveState=function(){if(!w.isSerializableHash(this._inner)){throw new Error("hmac: can't saveState() because hash doesn't implement it")}return this._inner.saveState()};t.prototype.restoreState=function(t){if(!w.isSerializableHash(this._inner)||!w.isSerializableHash(this._outer)){throw new Error("hmac: can't restoreState() because hash doesn't implement it")}this._inner.restoreState(t);this._outer.restoreState(this._outerKeyedState);this._finished=false;return this};t.prototype.cleanSavedState=function(t){if(!w.isSerializableHash(this._inner)){throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it")}this._inner.cleanSavedState(t)};return t}();n.HMAC=r;function e(t,n,e){var i=new r(t,n);i.update(e);var s=i.digest();i.clean();return s}n.hmac=e;n.equal=d.equal}));var b=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});var r=function(){function t(t,n,r,e){if(r===void 0){r=new Uint8Array(0)}this._counter=new Uint8Array(1);this._hash=t;this._info=e;var i=y.hmac(this._hash,r,n);this._hmac=new y.HMAC(t,i);this._buffer=new Uint8Array(this._hmac.digestLength);this._bufpos=this._buffer.length}t.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0){throw new Error("hkdf: cannot expand more")}this._hmac.reset();if(t>1){this._hmac.update(this._buffer)}if(this._info){this._hmac.update(this._info)}this._hmac.update(this._counter);this._hmac.finish(this._buffer);this._bufpos=0};t.prototype.expand=function(t){var n=new Uint8Array(t);for(var r=0;r<n.length;r++){if(this._bufpos===this._buffer.length){this._fillBuffer()}n[r]=this._buffer[this._bufpos++]}return n};t.prototype.clean=function(){this._hmac.clean();f.wipe(this._buffer);f.wipe(this._counter);this._bufpos=0};return t}();n.HKDF=r}));var m=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.BrowserRandomSource=void 0;const r=65536;class e{constructor(){this.isAvailable=false;this.isInstantiated=false;const t=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues!==undefined){this._crypto=t;this.isAvailable=true;this.isInstantiated=true}}randomBytes(t){if(!this.isAvailable||!this._crypto){throw new Error("Browser random byte generator is not available.")}const n=new Uint8Array(t);for(let t=0;t<n.length;t+=r){this._crypto.getRandomValues(n.subarray(t,t+Math.min(n.length-t,r)))}return n}}n.BrowserRandomSource=e}));var g=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.NodeRandomSource=void 0;class i{constructor(){this.isAvailable=false;this.isInstantiated=false;if(typeof r!=="undefined"){const t=e;if(t&&t.randomBytes){this._crypto=t;this.isAvailable=true;this.isInstantiated=true}}}randomBytes(t){if(!this.isAvailable||!this._crypto){throw new Error("Node.js random byte generator is not available.")}let n=this._crypto.randomBytes(t);if(n.length!==t){throw new Error("NodeRandomSource: got fewer bytes than requested")}const r=new Uint8Array(t);for(let t=0;t<r.length;t++){r[t]=n[t]}(0,f.wipe)(n);return r}}n.NodeRandomSource=i}));var _=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.SystemRandomSource=void 0;class r{constructor(){this.isAvailable=false;this.name="";this._source=new m.BrowserRandomSource;if(this._source.isAvailable){this.isAvailable=true;this.name="Browser";return}this._source=new g.NodeRandomSource;if(this._source.isAvailable){this.isAvailable=true;this.name="Node";return}}randomBytes(t){if(!this.isAvailable){throw new Error("System random byte generator is not available.")}return this._source.randomBytes(t)}}n.SystemRandomSource=r}));var E=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.randomStringForEntropy=n.randomString=n.randomUint32=n.randomBytes=n.defaultRandomSource=void 0;n.defaultRandomSource=new _.SystemRandomSource;function r(t,r=n.defaultRandomSource){return r.randomBytes(t)}n.randomBytes=r;function e(t=n.defaultRandomSource){const e=r(4,t);const i=(0,h.readUint32LE)(e);(0,f.wipe)(e);return i}n.randomUint32=e;const i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function s(t,e=i,s=n.defaultRandomSource){if(e.length<2){throw new Error("randomString charset is too short")}if(e.length>256){throw new Error("randomString charset is too long")}let o="";const a=e.length;const u=256-256%a;while(t>0){const n=r(Math.ceil(t*256/u),s);for(let r=0;r<n.length&&t>0;r++){const i=n[r];if(i<u){o+=e.charAt(i%a);t--}}(0,f.wipe)(n)}return o}n.randomString=s;function o(t,r=i,e=n.defaultRandomSource){const o=Math.ceil(t/(Math.log(r.length)/Math.LN2));return s(o,r,e)}n.randomStringForEntropy=o}));var O=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.DIGEST_LENGTH=32;n.BLOCK_SIZE=64;var r=function(){function t(){this.digestLength=n.DIGEST_LENGTH;this.blockSize=n.BLOCK_SIZE;this._state=new Int32Array(8);this._temp=new Int32Array(64);this._buffer=new Uint8Array(128);this._bufferLength=0;this._bytesHashed=0;this._finished=false;this.reset()}t.prototype._initState=function(){this._state[0]=1779033703;this._state[1]=3144134277;this._state[2]=1013904242;this._state[3]=2773480762;this._state[4]=1359893119;this._state[5]=2600822924;this._state[6]=528734635;this._state[7]=1541459225};t.prototype.reset=function(){this._initState();this._bufferLength=0;this._bytesHashed=0;this._finished=false;return this};t.prototype.clean=function(){f.wipe(this._buffer);f.wipe(this._temp);this.reset()};t.prototype.update=function(t,n){if(n===void 0){n=t.length}if(this._finished){throw new Error("SHA256: can't update because hash was finished.")}var r=0;this._bytesHashed+=n;if(this._bufferLength>0){while(this._bufferLength<this.blockSize&&n>0){this._buffer[this._bufferLength++]=t[r++];n--}if(this._bufferLength===this.blockSize){i(this._temp,this._state,this._buffer,0,this.blockSize);this._bufferLength=0}}if(n>=this.blockSize){r=i(this._temp,this._state,t,r,n);n%=this.blockSize}while(n>0){this._buffer[this._bufferLength++]=t[r++];n--}return this};t.prototype.finish=function(t){if(!this._finished){var n=this._bytesHashed;var r=this._bufferLength;var e=n/536870912|0;var s=n<<3;var o=n%64<56?64:128;this._buffer[r]=128;for(var a=r+1;a<o-8;a++){this._buffer[a]=0}h.writeUint32BE(e,this._buffer,o-8);h.writeUint32BE(s,this._buffer,o-4);i(this._temp,this._state,this._buffer,0,o);this._finished=true}for(var a=0;a<this.digestLength/4;a++){h.writeUint32BE(this._state[a],t,a*4)}return this};t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);this.finish(t);return t};t.prototype.saveState=function(){if(this._finished){throw new Error("SHA256: cannot save finished state")}return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):undefined,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}};t.prototype.restoreState=function(t){this._state.set(t.state);this._bufferLength=t.bufferLength;if(t.buffer){this._buffer.set(t.buffer)}this._bytesHashed=t.bytesHashed;this._finished=false;return this};t.prototype.cleanSavedState=function(t){f.wipe(t.state);if(t.buffer){f.wipe(t.buffer)}t.bufferLength=0;t.bytesHashed=0};return t}();n.SHA256=r;var e=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function i(t,n,r,i,s){while(s>=64){var o=n[0];var a=n[1];var u=n[2];var c=n[3];var f=n[4];var l=n[5];var d=n[6];var p=n[7];for(var v=0;v<16;v++){var w=i+v*4;t[v]=h.readUint32BE(r,w)}for(var v=16;v<64;v++){var y=t[v-2];var b=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=t[v-15];var m=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;t[v]=(b+t[v-7]|0)+(m+t[v-16]|0)}for(var v=0;v<64;v++){var b=(((f>>>6|f<<32-6)^(f>>>11|f<<32-11)^(f>>>25|f<<32-25))+(f&l^~f&d)|0)+(p+(e[v]+t[v]|0)|0)|0;var m=((o>>>2|o<<32-2)^(o>>>13|o<<32-13)^(o>>>22|o<<32-22))+(o&a^o&u^a&u)|0;p=d;d=l;l=f;f=c+b|0;c=u;u=a;a=o;o=b+m|0}n[0]+=o;n[1]+=a;n[2]+=u;n[3]+=c;n[4]+=f;n[5]+=l;n[6]+=d;n[7]+=p;i+=64;s-=64}return i}function s(t){var n=new r;n.update(t);var e=n.digest();n.clean();return e}n.hash=s}));var S=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.sharedKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.scalarMultBase=n.scalarMult=n.SHARED_KEY_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=void 0;n.PUBLIC_KEY_LENGTH=32;n.SECRET_KEY_LENGTH=32;n.SHARED_KEY_LENGTH=32;function r(t){const n=new Float64Array(16);if(t){for(let r=0;r<t.length;r++){n[r]=t[r]}}return n}const e=new Uint8Array(32);e[0]=9;const i=r([56129,1]);function s(t){let n=1;for(let r=0;r<16;r++){let e=t[r]+n+65535;n=Math.floor(e/65536);t[r]=e-n*65536}t[0]+=n-1+37*(n-1)}function o(t,n,r){const e=~(r-1);for(let r=0;r<16;r++){const i=e&(t[r]^n[r]);t[r]^=i;n[r]^=i}}function a(t,n){const e=r();const i=r();for(let t=0;t<16;t++){i[t]=n[t]}s(i);s(i);s(i);for(let t=0;t<2;t++){e[0]=i[0]-65517;for(let t=1;t<15;t++){e[t]=i[t]-65535-(e[t-1]>>16&1);e[t-1]&=65535}e[15]=i[15]-32767-(e[14]>>16&1);const t=e[15]>>16&1;e[14]&=65535;o(i,e,1-t)}for(let n=0;n<16;n++){t[2*n]=i[n]&255;t[2*n+1]=i[n]>>8}}function u(t,n){for(let r=0;r<16;r++){t[r]=n[2*r]+(n[2*r+1]<<8)}t[15]&=32767}function c(t,n,r){for(let e=0;e<16;e++){t[e]=n[e]+r[e]}}function h(t,n,r){for(let e=0;e<16;e++){t[e]=n[e]-r[e]}}function l(t,n,r){let e,i,s=0,o=0,a=0,u=0,c=0,h=0,f=0,l=0,d=0,p=0,v=0,w=0,y=0,b=0,m=0,g=0,_=0,E=0,O=0,S=0,I=0,j=0,A=0,N=0,P=0,x=0,$=0,T=0,M=0,C=0,R=0,U=r[0],D=r[1],k=r[2],L=r[3],q=r[4],V=r[5],F=r[6],G=r[7],H=r[8],z=r[9],W=r[10],B=r[11],K=r[12],J=r[13],Z=r[14],Q=r[15];e=n[0];s+=e*U;o+=e*D;a+=e*k;u+=e*L;c+=e*q;h+=e*V;f+=e*F;l+=e*G;d+=e*H;p+=e*z;v+=e*W;w+=e*B;y+=e*K;b+=e*J;m+=e*Z;g+=e*Q;e=n[1];o+=e*U;a+=e*D;u+=e*k;c+=e*L;h+=e*q;f+=e*V;l+=e*F;d+=e*G;p+=e*H;v+=e*z;w+=e*W;y+=e*B;b+=e*K;m+=e*J;g+=e*Z;_+=e*Q;e=n[2];a+=e*U;u+=e*D;c+=e*k;h+=e*L;f+=e*q;l+=e*V;d+=e*F;p+=e*G;v+=e*H;w+=e*z;y+=e*W;b+=e*B;m+=e*K;g+=e*J;_+=e*Z;E+=e*Q;e=n[3];u+=e*U;c+=e*D;h+=e*k;f+=e*L;l+=e*q;d+=e*V;p+=e*F;v+=e*G;w+=e*H;y+=e*z;b+=e*W;m+=e*B;g+=e*K;_+=e*J;E+=e*Z;O+=e*Q;e=n[4];c+=e*U;h+=e*D;f+=e*k;l+=e*L;d+=e*q;p+=e*V;v+=e*F;w+=e*G;y+=e*H;b+=e*z;m+=e*W;g+=e*B;_+=e*K;E+=e*J;O+=e*Z;S+=e*Q;e=n[5];h+=e*U;f+=e*D;l+=e*k;d+=e*L;p+=e*q;v+=e*V;w+=e*F;y+=e*G;b+=e*H;m+=e*z;g+=e*W;_+=e*B;E+=e*K;O+=e*J;S+=e*Z;I+=e*Q;e=n[6];f+=e*U;l+=e*D;d+=e*k;p+=e*L;v+=e*q;w+=e*V;y+=e*F;b+=e*G;m+=e*H;g+=e*z;_+=e*W;E+=e*B;O+=e*K;S+=e*J;I+=e*Z;j+=e*Q;e=n[7];l+=e*U;d+=e*D;p+=e*k;v+=e*L;w+=e*q;y+=e*V;b+=e*F;m+=e*G;g+=e*H;_+=e*z;E+=e*W;O+=e*B;S+=e*K;I+=e*J;j+=e*Z;A+=e*Q;e=n[8];d+=e*U;p+=e*D;v+=e*k;w+=e*L;y+=e*q;b+=e*V;m+=e*F;g+=e*G;_+=e*H;E+=e*z;O+=e*W;S+=e*B;I+=e*K;j+=e*J;A+=e*Z;N+=e*Q;e=n[9];p+=e*U;v+=e*D;w+=e*k;y+=e*L;b+=e*q;m+=e*V;g+=e*F;_+=e*G;E+=e*H;O+=e*z;S+=e*W;I+=e*B;j+=e*K;A+=e*J;N+=e*Z;P+=e*Q;e=n[10];v+=e*U;w+=e*D;y+=e*k;b+=e*L;m+=e*q;g+=e*V;_+=e*F;E+=e*G;O+=e*H;S+=e*z;I+=e*W;j+=e*B;A+=e*K;N+=e*J;P+=e*Z;x+=e*Q;e=n[11];w+=e*U;y+=e*D;b+=e*k;m+=e*L;g+=e*q;_+=e*V;E+=e*F;O+=e*G;S+=e*H;I+=e*z;j+=e*W;A+=e*B;N+=e*K;P+=e*J;x+=e*Z;$+=e*Q;e=n[12];y+=e*U;b+=e*D;m+=e*k;g+=e*L;_+=e*q;E+=e*V;O+=e*F;S+=e*G;I+=e*H;j+=e*z;A+=e*W;N+=e*B;P+=e*K;x+=e*J;$+=e*Z;T+=e*Q;e=n[13];b+=e*U;m+=e*D;g+=e*k;_+=e*L;E+=e*q;O+=e*V;S+=e*F;I+=e*G;j+=e*H;A+=e*z;N+=e*W;P+=e*B;x+=e*K;$+=e*J;T+=e*Z;M+=e*Q;e=n[14];m+=e*U;g+=e*D;_+=e*k;E+=e*L;O+=e*q;S+=e*V;I+=e*F;j+=e*G;A+=e*H;N+=e*z;P+=e*W;x+=e*B;$+=e*K;T+=e*J;M+=e*Z;C+=e*Q;e=n[15];g+=e*U;_+=e*D;E+=e*k;O+=e*L;S+=e*q;I+=e*V;j+=e*F;A+=e*G;N+=e*H;P+=e*z;x+=e*W;$+=e*B;T+=e*K;M+=e*J;C+=e*Z;R+=e*Q;s+=38*_;o+=38*E;a+=38*O;u+=38*S;c+=38*I;h+=38*j;f+=38*A;l+=38*N;d+=38*P;p+=38*x;v+=38*$;w+=38*T;y+=38*M;b+=38*C;m+=38*R;i=1;e=s+i+65535;i=Math.floor(e/65536);s=e-i*65536;e=o+i+65535;i=Math.floor(e/65536);o=e-i*65536;e=a+i+65535;i=Math.floor(e/65536);a=e-i*65536;e=u+i+65535;i=Math.floor(e/65536);u=e-i*65536;e=c+i+65535;i=Math.floor(e/65536);c=e-i*65536;e=h+i+65535;i=Math.floor(e/65536);h=e-i*65536;e=f+i+65535;i=Math.floor(e/65536);f=e-i*65536;e=l+i+65535;i=Math.floor(e/65536);l=e-i*65536;e=d+i+65535;i=Math.floor(e/65536);d=e-i*65536;e=p+i+65535;i=Math.floor(e/65536);p=e-i*65536;e=v+i+65535;i=Math.floor(e/65536);v=e-i*65536;e=w+i+65535;i=Math.floor(e/65536);w=e-i*65536;e=y+i+65535;i=Math.floor(e/65536);y=e-i*65536;e=b+i+65535;i=Math.floor(e/65536);b=e-i*65536;e=m+i+65535;i=Math.floor(e/65536);m=e-i*65536;e=g+i+65535;i=Math.floor(e/65536);g=e-i*65536;s+=i-1+37*(i-1);i=1;e=s+i+65535;i=Math.floor(e/65536);s=e-i*65536;e=o+i+65535;i=Math.floor(e/65536);o=e-i*65536;e=a+i+65535;i=Math.floor(e/65536);a=e-i*65536;e=u+i+65535;i=Math.floor(e/65536);u=e-i*65536;e=c+i+65535;i=Math.floor(e/65536);c=e-i*65536;e=h+i+65535;i=Math.floor(e/65536);h=e-i*65536;e=f+i+65535;i=Math.floor(e/65536);f=e-i*65536;e=l+i+65535;i=Math.floor(e/65536);l=e-i*65536;e=d+i+65535;i=Math.floor(e/65536);d=e-i*65536;e=p+i+65535;i=Math.floor(e/65536);p=e-i*65536;e=v+i+65535;i=Math.floor(e/65536);v=e-i*65536;e=w+i+65535;i=Math.floor(e/65536);w=e-i*65536;e=y+i+65535;i=Math.floor(e/65536);y=e-i*65536;e=b+i+65535;i=Math.floor(e/65536);b=e-i*65536;e=m+i+65535;i=Math.floor(e/65536);m=e-i*65536;e=g+i+65535;i=Math.floor(e/65536);g=e-i*65536;s+=i-1+37*(i-1);t[0]=s;t[1]=o;t[2]=a;t[3]=u;t[4]=c;t[5]=h;t[6]=f;t[7]=l;t[8]=d;t[9]=p;t[10]=v;t[11]=w;t[12]=y;t[13]=b;t[14]=m;t[15]=g}function d(t,n){l(t,n,n)}function p(t,n){const e=r();for(let t=0;t<16;t++){e[t]=n[t]}for(let t=253;t>=0;t--){d(e,e);if(t!==2&&t!==4){l(e,e,n)}}for(let n=0;n<16;n++){t[n]=e[n]}}function v(t,n){const e=new Uint8Array(32);const s=new Float64Array(80);const f=r(),v=r(),w=r(),y=r(),b=r(),m=r();for(let n=0;n<31;n++){e[n]=t[n]}e[31]=t[31]&127|64;e[0]&=248;u(s,n);for(let t=0;t<16;t++){v[t]=s[t]}f[0]=y[0]=1;for(let t=254;t>=0;--t){const n=e[t>>>3]>>>(t&7)&1;o(f,v,n);o(w,y,n);c(b,f,w);h(f,f,w);c(w,v,y);h(v,v,y);d(y,b);d(m,f);l(f,w,f);l(w,v,b);c(b,f,w);h(f,f,w);d(v,f);h(w,y,m);l(f,w,i);c(f,f,y);l(w,w,f);l(f,y,m);l(y,v,s);d(v,b);o(f,v,n);o(w,y,n)}for(let t=0;t<16;t++){s[t+16]=f[t];s[t+32]=w[t];s[t+48]=v[t];s[t+64]=y[t]}const g=s.subarray(32);const _=s.subarray(16);p(g,g);l(_,_,g);const E=new Uint8Array(32);a(E,_);return E}n.scalarMult=v;function w(t){return v(t,e)}n.scalarMultBase=w;function y(t){if(t.length!==n.SECRET_KEY_LENGTH){throw new Error(`x25519: seed must be ${n.SECRET_KEY_LENGTH} bytes`)}const r=new Uint8Array(t);const e=w(r);return{publicKey:e,secretKey:r}}n.generateKeyPairFromSeed=y;function b(t){const n=(0,E.randomBytes)(32,t);const r=y(n);(0,f.wipe)(n);return r}n.generateKeyPair=b;function m(t,r,e=false){if(t.length!==n.PUBLIC_KEY_LENGTH){throw new Error("X25519: incorrect secret key length")}if(r.length!==n.PUBLIC_KEY_LENGTH){throw new Error("X25519: incorrect public key length")}const i=v(t,r);if(e){let t=0;for(let n=0;n<i.length;n++){t|=i[n]}if(t===0){throw new Error("X25519: invalid shared key")}}return i}n.sharedKey=m}));var I=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){for(let r=0;r<t.byteLength;r++){if(t[r]<n[r]){return-1}if(t[r]>n[r]){return 1}}if(t.byteLength>n.byteLength){return 1}if(t.byteLength<n.byteLength){return-1}return 0}n.compare=r}));var j=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){if(globalThis.Buffer!=null){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}return t}n.asUint8Array=r}));var A=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null){return j.asUint8Array(globalThis.Buffer.alloc(t))}return new Uint8Array(t)}function e(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null){return j.asUint8Array(globalThis.Buffer.allocUnsafe(t))}return new Uint8Array(t)}n.alloc=r;n.allocUnsafe=e}));var N=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(!n){n=t.reduce(((t,n)=>t+n.length),0)}const r=A.allocUnsafe(n);let e=0;for(const n of t){r.set(n,e);e+=n.length}return j.asUint8Array(r)}n.concat=r}));var P=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(t===n){return true}if(t.byteLength!==n.byteLength){return false}for(let r=0;r<t.byteLength;r++){if(t[r]!==n[r]){return false}}return true}n.equals=r}));function x(t,n){if(t.length>=255){throw new TypeError("Alphabet too long")}var r=new Uint8Array(256);for(var e=0;e<r.length;e++){r[e]=255}for(var i=0;i<t.length;i++){var s=t.charAt(i);var o=s.charCodeAt(0);if(r[o]!==255){throw new TypeError(s+" is ambiguous")}r[o]=i}var a=t.length;var u=t.charAt(0);var c=Math.log(a)/Math.log(256);var h=Math.log(256)/Math.log(a);function f(n){if(n instanceof Uint8Array);else if(ArrayBuffer.isView(n)){n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}else if(Array.isArray(n)){n=Uint8Array.from(n)}if(!(n instanceof Uint8Array)){throw new TypeError("Expected Uint8Array")}if(n.length===0){return""}var r=0;var e=0;var i=0;var s=n.length;while(i!==s&&n[i]===0){i++;r++}var o=(s-i)*h+1>>>0;var c=new Uint8Array(o);while(i!==s){var f=n[i];var l=0;for(var d=o-1;(f!==0||l<e)&&d!==-1;d--,l++){f+=256*c[d]>>>0;c[d]=f%a>>>0;f=f/a>>>0}if(f!==0){throw new Error("Non-zero carry")}e=l;i++}var p=o-e;while(p!==o&&c[p]===0){p++}var v=u.repeat(r);for(;p<o;++p){v+=t.charAt(c[p])}return v}function l(t){if(typeof t!=="string"){throw new TypeError("Expected String")}if(t.length===0){return new Uint8Array}var n=0;if(t[n]===" "){return}var e=0;var i=0;while(t[n]===u){e++;n++}var s=(t.length-n)*c+1>>>0;var o=new Uint8Array(s);while(t[n]){var h=r[t.charCodeAt(n)];if(h===255){return}var f=0;for(var l=s-1;(h!==0||f<i)&&l!==-1;l--,f++){h+=a*o[l]>>>0;o[l]=h%256>>>0;h=h/256>>>0}if(h!==0){throw new Error("Non-zero carry")}i=f;n++}if(t[n]===" "){return}var d=s-i;while(d!==s&&o[d]===0){d++}var p=new Uint8Array(e+(s-d));var v=e;while(d!==s){p[v++]=o[d++]}return p}function d(t){var r=l(t);if(r){return r}throw new Error(`Non-${n} character`)}return{encode:f,decodeUnsafe:l,decode:d}}var $=x;var T=$;var M=T;var C=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=new Uint8Array(0);const e=t=>t.reduce(((t,n)=>t+n.toString(16).padStart(2,"0")),"");const i=t=>{const n=t.match(/../g);return n?new Uint8Array(n.map((t=>parseInt(t,16)))):r};const s=(t,n)=>{if(t===n)return true;if(t.byteLength!==n.byteLength){return false}for(let r=0;r<t.byteLength;r++){if(t[r]!==n[r]){return false}}return true};const o=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t)){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}throw new Error("Unknown type, must be binary type")};const a=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t);const u=t=>(new TextEncoder).encode(t);const c=t=>(new TextDecoder).decode(t);n.coerce=o;n.empty=r;n.equals=s;n.fromHex=i;n.fromString=u;n.isBinary=a;n.toHex=e;n.toString=c}));var R=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});class r{constructor(t,n,r){this.name=t;this.prefix=n;this.baseEncode=r}encode(t){if(t instanceof Uint8Array){return`${this.prefix}${this.baseEncode(t)}`}else{throw Error("Unknown type, must be binary type")}}}class e{constructor(t,n,r){this.name=t;this.prefix=n;if(n.codePointAt(0)===undefined){throw new Error("Invalid prefix character")}this.prefixCodePoint=n.codePointAt(0);this.baseDecode=r}decode(t){if(typeof t==="string"){if(t.codePointAt(0)!==this.prefixCodePoint){throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}return this.baseDecode(t.slice(this.prefix.length))}else{throw Error("Can only multibase decode strings")}}or(t){return s(this,t)}}class i{constructor(t){this.decoders=t}or(t){return s(this,t)}decode(t){const n=t[0];const r=this.decoders[n];if(r){return r.decode(t)}else{throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}}const s=(t,n)=>new i({...t.decoders||{[t.prefix]:t},...n.decoders||{[n.prefix]:n}});class o{constructor(t,n,i,s){this.name=t;this.prefix=n;this.baseEncode=i;this.baseDecode=s;this.encoder=new r(t,n,i);this.decoder=new e(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const a=({name:t,prefix:n,encode:r,decode:e})=>new o(t,n,r,e);const u=({prefix:t,name:n,alphabet:r})=>{const{encode:e,decode:i}=M(r,n);return a({prefix:t,name:n,encode:e,decode:t=>C.coerce(i(t))})};const c=(t,n,r,e)=>{const i={};for(let t=0;t<n.length;++t){i[n[t]]=t}let s=t.length;while(t[s-1]==="="){--s}const o=new Uint8Array(s*r/8|0);let a=0;let u=0;let c=0;for(let n=0;n<s;++n){const s=i[t[n]];if(s===undefined){throw new SyntaxError(`Non-${e} character`)}u=u<<r|s;a+=r;if(a>=8){a-=8;o[c++]=255&u>>a}}if(a>=r||255&u<<8-a){throw new SyntaxError("Unexpected end of data")}return o};const h=(t,n,r)=>{const e=n[n.length-1]==="=";const i=(1<<r)-1;let s="";let o=0;let a=0;for(let e=0;e<t.length;++e){a=a<<8|t[e];o+=8;while(o>r){o-=r;s+=n[i&a>>o]}}if(o){s+=n[i&a<<r-o]}if(e){while(s.length*r&7){s+="="}}return s};const f=({name:t,prefix:n,bitsPerChar:r,alphabet:e})=>a({prefix:n,name:t,encode(t){return h(t,e,r)},decode(n){return c(n,e,r,t)}});n.Codec=o;n.baseX=u;n.from=a;n.or=s;n.rfc4648=f}));var U=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.from({prefix:"\0",name:"identity",encode:t=>C.toString(t),decode:t=>C.fromString(t)});n.identity=r}));var D=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});n.base2=r}));var k=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});n.base8=r}));var L=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.baseX({prefix:"9",name:"base10",alphabet:"0123456789"});n.base10=r}));var q=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4});const e=R.rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});n.base16=r;n.base16upper=e}));var V=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});const e=R.rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});const i=R.rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});const s=R.rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});const o=R.rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});const a=R.rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});const u=R.rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});const c=R.rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});const h=R.rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});n.base32=r;n.base32hex=o;n.base32hexpad=u;n.base32hexpadupper=c;n.base32hexupper=a;n.base32pad=i;n.base32padupper=s;n.base32upper=e;n.base32z=h}));var F=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});const e=R.baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});n.base36=r;n.base36upper=e}));var G=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});const e=R.baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});n.base58btc=r;n.base58flickr=e}));var H=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=R.rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});const e=R.rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const i=R.rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});const s=R.rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});n.base64=r;n.base64pad=e;n.base64url=i;n.base64urlpad=s}));var z=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂");const e=r.reduce(((t,n,r)=>{t[r]=n;return t}),[]);const i=r.reduce(((t,n,r)=>{t[n.codePointAt(0)]=r;return t}),[]);function s(t){return t.reduce(((t,n)=>{t+=e[n];return t}),"")}function o(t){const n=[];for(const r of t){const t=i[r.codePointAt(0)];if(t===undefined){throw new Error(`Non-base256emoji character: ${r}`)}n.push(t)}return new Uint8Array(n)}const a=R.from({prefix:"🚀",name:"base256emoji",encode:s,decode:o});n.base256emoji=a}));var W=Q;var B=128,K=127,J=~K,Z=Math.pow(2,31);function Q(t,n,r){n=n||[];r=r||0;var e=r;while(t>=Z){n[r++]=t&255|B;t/=128}while(t&J){n[r++]=t&255|B;t>>>=7}n[r]=t|0;Q.bytes=r-e+1;return n}var X=nt;var Y=128,tt=127;function nt(t,n){var r=0,n=n||0,e=0,i=n,s,o=t.length;do{if(i>=o){nt.bytes=0;throw new RangeError("Could not decode varint")}s=t[i++];r+=e<28?(s&tt)<<e:(s&tt)*Math.pow(2,e);e+=7}while(s>=Y);nt.bytes=i-n;return r}var rt=Math.pow(2,7);var et=Math.pow(2,14);var it=Math.pow(2,21);var st=Math.pow(2,28);var ot=Math.pow(2,35);var at=Math.pow(2,42);var ut=Math.pow(2,49);var ct=Math.pow(2,56);var ht=Math.pow(2,63);var ft=function(t){return t<rt?1:t<et?2:t<it?3:t<st?4:t<ot?5:t<at?6:t<ut?7:t<ct?8:t<ht?9:10};var lt={encode:W,decode:X,encodingLength:ft};var dt=lt;var pt=dt;var vt=pt;var wt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=(t,n=0)=>{const r=vt.decode(t,n);return[r,vt.decode.bytes]};const e=(t,n,r=0)=>{vt.encode(t,n,r);return n};const i=t=>vt.encodingLength(t);n.decode=r;n.encodeTo=e;n.encodingLength=i}));var yt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=(t,n)=>{const r=n.byteLength;const e=wt.encodingLength(t);const i=e+wt.encodingLength(r);const o=new Uint8Array(i+r);wt.encodeTo(t,o,0);wt.encodeTo(r,o,e);o.set(n,i);return new s(t,r,n,o)};const e=t=>{const n=C.coerce(t);const[r,e]=wt.decode(n);const[i,o]=wt.decode(n.subarray(e));const a=n.subarray(e+o);if(a.byteLength!==i){throw new Error("Incorrect length")}return new s(r,i,a,n)};const i=(t,n)=>{if(t===n){return true}else{return t.code===n.code&&t.size===n.size&&C.equals(t.bytes,n.bytes)}};class s{constructor(t,n,r,e){this.code=t;this.size=n;this.digest=r;this.bytes=e}}n.Digest=s;n.create=r;n.decode=e;n.equals=i}));var bt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=({name:t,code:n,encode:r})=>new e(t,n,r);class e{constructor(t,n,r){this.name=t;this.code=n;this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?yt.create(this.code,n):n.then((t=>yt.create(this.code,t)))}else{throw Error("Unknown type, must be binary type")}}}n.Hasher=e;n.from=r}));var mt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=t=>async n=>new Uint8Array(await crypto.subtle.digest(t,n));const e=bt.from({name:"sha2-256",code:18,encode:r("SHA-256")});const i=bt.from({name:"sha2-512",code:19,encode:r("SHA-512")});n.sha256=e;n.sha512=i}));var gt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=0;const e="identity";const i=C.coerce;const s=t=>yt.create(r,i(t));const o={code:r,name:e,encode:i,digest:s};n.identity=o}));var _t=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r="raw";const e=85;const i=t=>C.coerce(t);const s=t=>C.coerce(t);n.code=e;n.decode=s;n.encode=i;n.name=r}));var Et=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r=new TextEncoder;const e=new TextDecoder;const i="json";const s=512;const o=t=>r.encode(JSON.stringify(t));const a=t=>JSON.parse(e.decode(t));n.code=s;n.decode=a;n.encode=o;n.name=i}));var Ot=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});class r{constructor(t,n,r,e){this.code=n;this.version=t;this.multihash=r;this.bytes=e;this.byteOffset=e.byteOffset;this.byteLength=e.byteLength;this.asCID=this;this._baseCache=new Map;Object.defineProperties(this,{byteOffset:f,byteLength:f,code:h,version:h,multihash:h,bytes:h,_baseCache:f,asCID:f})}toV0(){switch(this.version){case 0:{return this}default:{const{code:t,multihash:n}=this;if(t!==o){throw new Error("Cannot convert a non dag-pb CID to CIDv0")}if(n.code!==a){throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0")}return r.createV0(n)}}}toV1(){switch(this.version){case 0:{const{code:t,digest:n}=this.multihash;const e=yt.create(t,n);return r.createV1(this.code,e)}case 1:{return this}default:{throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}}equals(t){return t&&this.code===t.code&&this.version===t.version&&yt.equals(this.multihash,t.multihash)}toString(t){const{bytes:n,version:r,_baseCache:e}=this;switch(r){case 0:return i(n,e,t||G.base58btc.encoder);default:return s(n,e,t||V.base32.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(t){d(/^0\.0/,p);return!!(t&&(t[c]||t.asCID===t))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(t){if(t instanceof r){return t}else if(t!=null&&t.asCID===t){const{version:n,code:e,multihash:i,bytes:s}=t;return new r(n,e,i,s||u(n,e,i.bytes))}else if(t!=null&&t[c]===true){const{version:n,multihash:e,code:i}=t;const s=yt.decode(e);return r.create(n,i,s)}else{return null}}static create(t,n,e){if(typeof n!=="number"){throw new Error("String codecs are no longer supported")}switch(t){case 0:{if(n!==o){throw new Error(`Version 0 CID must use dag-pb (code: ${o}) block encoding`)}else{return new r(t,n,e,e.bytes)}}case 1:{const i=u(t,n,e.bytes);return new r(t,n,e,i)}default:{throw new Error("Invalid version")}}}static createV0(t){return r.create(0,o,t)}static createV1(t,n){return r.create(1,t,n)}static decode(t){const[n,e]=r.decodeFirst(t);if(e.length){throw new Error("Incorrect length")}return n}static decodeFirst(t){const n=r.inspectBytes(t);const e=n.size-n.multihashSize;const i=C.coerce(t.subarray(e,e+n.multihashSize));if(i.byteLength!==n.multihashSize){throw new Error("Incorrect length")}const s=i.subarray(n.multihashSize-n.digestSize);const o=new yt.Digest(n.multihashCode,n.digestSize,s,i);const a=n.version===0?r.createV0(o):r.createV1(n.codec,o);return[a,t.subarray(n.size)]}static inspectBytes(t){let n=0;const r=()=>{const[r,e]=wt.decode(t.subarray(n));n+=e;return r};let e=r();let i=o;if(e===18){e=0;n=0}else if(e===1){i=r()}if(e!==0&&e!==1){throw new RangeError(`Invalid CID version ${e}`)}const s=n;const a=r();const u=r();const c=n+u;const h=c-s;return{version:e,codec:i,multihashCode:a,digestSize:u,multihashSize:h,size:c}}static parse(t,n){const[i,s]=e(t,n);const o=r.decode(s);o._baseCache.set(i,t);return o}}const e=(t,n)=>{switch(t[0]){case"Q":{const r=n||G.base58btc;return[G.base58btc.prefix,r.decode(`${G.base58btc.prefix}${t}`)]}case G.base58btc.prefix:{const r=n||G.base58btc;return[G.base58btc.prefix,r.decode(t)]}case V.base32.prefix:{const r=n||V.base32;return[V.base32.prefix,r.decode(t)]}default:{if(n==null){throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided")}return[t[0],n.decode(t)]}}};const i=(t,n,r)=>{const{prefix:e}=r;if(e!==G.base58btc.prefix){throw Error(`Cannot string encode V0 in ${r.name} encoding`)}const i=n.get(e);if(i==null){const i=r.encode(t).slice(1);n.set(e,i);return i}else{return i}};const s=(t,n,r)=>{const{prefix:e}=r;const i=n.get(e);if(i==null){const i=r.encode(t);n.set(e,i);return i}else{return i}};const o=112;const a=18;const u=(t,n,r)=>{const e=wt.encodingLength(t);const i=e+wt.encodingLength(n);const s=new Uint8Array(i+r.byteLength);wt.encodeTo(t,s,0);wt.encodeTo(n,s,e);s.set(r,i);return s};const c=Symbol.for("@ipld/js-cid/CID");const h={writable:false,configurable:false,enumerable:true};const f={writable:false,enumerable:false,configurable:false};const l="0.0.0-dev";const d=(t,n)=>{if(t.test(l)){console.warn(n)}else{throw new Error(n)}};const p=`CID.isCID(v) is deprecated and will be removed in the next major release.\nFollowing code pattern:\n\nif (CID.isCID(value)) {\n  doSomethingWithCID(value)\n}\n\nIs replaced with:\n\nconst cid = CID.asCID(value)\nif (cid) {\n  // Make sure to use cid instead of value\n  doSomethingWithCID(cid)\n}\n`;n.CID=r}));n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.CID=Ot.CID;n.varint=wt;n.bytes=C;n.hasher=bt;n.digest=yt}));var St=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});const r={...U,...D,...k,...L,...q,...V,...F,...G,...H,...z};const e={...mt,...gt};const i={raw:_t,json:Et};n.CID=Ot.CID;n.hasher=bt;n.digest=yt;n.varint=wt;n.bytes=C;n.bases=r;n.codecs=i;n.hashes=e}));function It(t,n,r,e){return{name:t,prefix:n,encoder:{name:t,prefix:n,encode:r},decoder:{decode:e}}}const jt=It("utf8","u",(t=>{const n=new TextDecoder("utf8");return"u"+n.decode(t)}),(t=>{const n=new TextEncoder;return n.encode(t.substring(1))}));const At=It("ascii","a",(t=>{let n="a";for(let r=0;r<t.length;r++){n+=String.fromCharCode(t[r])}return n}),(t=>{t=t.substring(1);const n=A.allocUnsafe(t.length);for(let r=0;r<t.length;r++){n[r]=t.charCodeAt(r)}return n}));const Nt={utf8:jt,"utf-8":jt,hex:St.bases.base16,latin1:At,ascii:At,binary:At,...St.bases};var Pt=Nt;var xt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=Pt[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return j.asUint8Array(globalThis.Buffer.from(t,"utf-8"))}return r.decoder.decode(`${r.prefix}${t}`)}n.fromString=r}));var $t=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=Pt[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8")}return r.encoder.encode(t).substring(1)}n.toString=r}));var Tt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(t.length!==n.length){throw new Error("Inputs should have the same length")}const r=A.allocUnsafe(t.length);for(let e=0;e<t.length;e++){r[e]=t[e]^n[e]}return j.asUint8Array(r)}n.xor=r}));var Mt=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.compare=I.compare;n.concat=N.concat;n.equals=P.equals;n.fromString=xt.fromString;n.toString=$t.toString;n.xor=Tt.xor}));var Ct=undefined&&undefined.__spreadArray||function(t,n,r){if(r||arguments.length===2)for(var e=0,i=n.length,s;e<i;e++){if(s||!(e in n)){if(!s)s=Array.prototype.slice.call(n,0,e);s[e]=n[e]}}return t.concat(s||Array.prototype.slice.call(n))};var Rt=function(){function t(t,n,r){this.name=t;this.version=n;this.os=r;this.type="browser"}return t}();var Ut=function(){function t(t){this.version=t;this.type="node";this.name="node";this.os=i.platform}return t}();var Dt=function(){function t(t,n,r,e){this.name=t;this.version=n;this.os=r;this.bot=e;this.type="bot-device"}return t}();var kt=function(){function t(){this.type="bot";this.bot=true;this.name="bot";this.version=null;this.os=null}return t}();var Lt=function(){function t(){this.type="react-native";this.name="react-native";this.version=null;this.os=null}return t}();var qt=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/;var Vt=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/;var Ft=3;var Gt=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",qt]];var Ht=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function zt(t){if(!!t){return Bt(t)}if(typeof document==="undefined"&&typeof navigator!=="undefined"&&navigator.product==="ReactNative"){return new Lt}if(typeof navigator!=="undefined"){return Bt(navigator.userAgent)}return Jt()}function Wt(t){return t!==""&&Gt.reduce((function(n,r){var e=r[0],i=r[1];if(n){return n}var s=i.exec(t);return!!s&&[e,s]}),false)}function Bt(t){var n=Wt(t);if(!n){return null}var r=n[0],e=n[1];if(r==="searchbot"){return new kt}var i=e[1]&&e[1].split(".").join("_").split("_").slice(0,3);if(i){if(i.length<Ft){i=Ct(Ct([],i,true),Zt(Ft-i.length),true)}}else{i=[]}var s=i.join(".");var o=Kt(t);var a=Vt.exec(t);if(a&&a[1]){return new Dt(r,s,o,a[1])}return new Rt(r,s,o)}function Kt(t){for(var n=0,r=Ht.length;n<r;n++){var e=Ht[n],i=e[0],s=e[1];var o=s.exec(t);if(o){return i}}return null}function Jt(){var t=typeof i!=="undefined"&&i.version;return t?new Ut(i.version.slice(1)):null}function Zt(t){var n=[];for(var r=0;r<t;r++){n.push("0")}return n}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qt=function(t,n){Qt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)if(n.hasOwnProperty(r))t[r]=n[r]};return Qt(t,n)};function Xt(t,n){Qt(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var Yt=function(){Yt=Object.assign||function t(n){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))n[s]=r[s]}return n};return Yt.apply(this,arguments)};function tn(t,n){var r={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0)r[e]=t[e];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,e=Object.getOwnPropertySymbols(t);i<e.length;i++){if(n.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i]))r[e[i]]=t[e[i]]}return r}function nn(t,n,r,e){var i=arguments.length,s=i<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,r):e,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)if(o=t[a])s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s}function rn(t,n){return function(r,e){n(r,e,t)}}function en(t,n){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)}function sn(t,n,r,e){function i(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{u(e.next(t))}catch(t){s(t)}}function a(t){try{u(e["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):i(t.value).then(o,a)}u((e=e.apply(t,n||[])).next())}))}function on(t,n){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return u([t,n])}}function u(o){if(e)throw new TypeError("Generator is already executing.");while(r)try{if(e=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=n.call(t,r)}catch(t){o=[6,t];i=0}finally{e=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}function an(t,n,r,e){if(e===undefined)e=r;t[e]=n[r]}function un(t,n){for(var r in t)if(r!=="default"&&!n.hasOwnProperty(r))n[r]=t[r]}function cn(t){var n=typeof Symbol==="function"&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&e>=t.length)t=void 0;return{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function hn(t,n){var r=typeof Symbol==="function"&&t[Symbol.iterator];if(!r)return t;var e=r.call(t),i,s=[],o;try{while((n===void 0||n-- >0)&&!(i=e.next()).done)s.push(i.value)}catch(t){o={error:t}}finally{try{if(i&&!i.done&&(r=e["return"]))r.call(e)}finally{if(o)throw o.error}}return s}function fn(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(hn(arguments[n]));return t}function ln(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;for(var e=Array(t),i=0,n=0;n<r;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,i++)e[i]=s[o];return e}function dn(t){return this instanceof dn?(this.v=t,this):new dn(t)}function pn(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r.apply(t,n||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){if(e[t])i[t]=function(n){return new Promise((function(r,e){s.push([t,n,r,e])>1||a(t,n)}))}}function a(t,n){try{u(e[t](n))}catch(t){f(s[0][3],t)}}function u(t){t.value instanceof dn?Promise.resolve(t.value.v).then(c,h):f(s[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,n){if(t(n),s.shift(),s.length)a(s[0][0],s[0][1])}}function vn(t){var n,r;return n={},e("next"),e("throw",(function(t){throw t})),e("return"),n[Symbol.iterator]=function(){return this},n;function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:dn(t[e](n)),done:e==="return"}:i?i(n):n}:i}}function wn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],r;return n?n.call(t):(t=typeof cn==="function"?cn(t):t[Symbol.iterator](),r={},e("next"),e("throw"),e("return"),r[Symbol.asyncIterator]=function(){return this},r);function e(n){r[n]=t[n]&&function(r){return new Promise((function(e,s){r=t[n](r),i(e,s,r.done,r.value)}))}}function i(t,n,r,e){Promise.resolve(e).then((function(n){t({value:n,done:r})}),n)}}function yn(t,n){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:n})}else{t.raw=n}return t}function bn(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))n[r]=t[r];n.default=t;return n}function mn(t){return t&&t.__esModule?t:{default:t}}function gn(t,n){if(!n.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n.get(t)}function _n(t,n,r){if(!n.has(t)){throw new TypeError("attempted to set private field on non-instance")}n.set(t,r);return r}const En=Object.freeze({__proto__:null,__extends:Xt,get __assign(){return Yt},__rest:tn,__decorate:nn,__param:rn,__metadata:en,__awaiter:sn,__generator:on,__createBinding:an,__exportStar:un,__values:cn,__read:hn,__spread:fn,__spreadArrays:ln,__await:dn,__asyncGenerator:pn,__asyncDelegator:vn,__asyncValues:wn,__makeTemplateObject:yn,__importStar:bn,__importDefault:mn,__classPrivateFieldGet:gn,__classPrivateFieldSet:_n});var On=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.delay=void 0;function r(t){return new Promise((n=>{setTimeout((()=>{n(true)}),t)}))}n.delay=r}));var Sn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.ONE_THOUSAND=n.ONE_HUNDRED=void 0;n.ONE_HUNDRED=100;n.ONE_THOUSAND=1e3}));var In=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.ONE_YEAR=n.FOUR_WEEKS=n.THREE_WEEKS=n.TWO_WEEKS=n.ONE_WEEK=n.THIRTY_DAYS=n.SEVEN_DAYS=n.FIVE_DAYS=n.THREE_DAYS=n.ONE_DAY=n.TWENTY_FOUR_HOURS=n.TWELVE_HOURS=n.SIX_HOURS=n.THREE_HOURS=n.ONE_HOUR=n.SIXTY_MINUTES=n.THIRTY_MINUTES=n.TEN_MINUTES=n.FIVE_MINUTES=n.ONE_MINUTE=n.SIXTY_SECONDS=n.THIRTY_SECONDS=n.TEN_SECONDS=n.FIVE_SECONDS=n.ONE_SECOND=void 0;n.ONE_SECOND=1;n.FIVE_SECONDS=5;n.TEN_SECONDS=10;n.THIRTY_SECONDS=30;n.SIXTY_SECONDS=60;n.ONE_MINUTE=n.SIXTY_SECONDS;n.FIVE_MINUTES=n.ONE_MINUTE*5;n.TEN_MINUTES=n.ONE_MINUTE*10;n.THIRTY_MINUTES=n.ONE_MINUTE*30;n.SIXTY_MINUTES=n.ONE_MINUTE*60;n.ONE_HOUR=n.SIXTY_MINUTES;n.THREE_HOURS=n.ONE_HOUR*3;n.SIX_HOURS=n.ONE_HOUR*6;n.TWELVE_HOURS=n.ONE_HOUR*12;n.TWENTY_FOUR_HOURS=n.ONE_HOUR*24;n.ONE_DAY=n.TWENTY_FOUR_HOURS;n.THREE_DAYS=n.ONE_DAY*3;n.FIVE_DAYS=n.ONE_DAY*5;n.SEVEN_DAYS=n.ONE_DAY*7;n.THIRTY_DAYS=n.ONE_DAY*30;n.ONE_WEEK=n.SEVEN_DAYS;n.TWO_WEEKS=n.ONE_WEEK*2;n.THREE_WEEKS=n.ONE_WEEK*3;n.FOUR_WEEKS=n.ONE_WEEK*4;n.ONE_YEAR=n.ONE_DAY*365}));const jn=s(En);var An=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});jn.__exportStar(Sn,n);jn.__exportStar(In,n)}));var Nn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.fromMiliseconds=n.toMiliseconds=void 0;function r(t){return t*An.ONE_THOUSAND}n.toMiliseconds=r;function e(t){return Math.floor(t/An.ONE_THOUSAND)}n.fromMiliseconds=e}));var Pn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});jn.__exportStar(On,n);jn.__exportStar(Nn,n)}));var xn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t)){throw new Error(`Watch already started for label: ${t}`)}this.timestamps.set(t,{started:Date.now()})}stop(t){const n=this.get(t);if(typeof n.elapsed!=="undefined"){throw new Error(`Watch already stopped for label: ${t}`)}const r=Date.now()-n.started;this.timestamps.set(t,{started:n.started,elapsed:r})}get(t){const n=this.timestamps.get(t);if(typeof n==="undefined"){throw new Error(`No timestamp found for label: ${t}`)}return n}elapsed(t){const n=this.get(t);const r=n.elapsed||Date.now()-n.started;return r}}n.Watch=r;n.default=r}));var $n=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.IWatch=void 0;class r{}n.IWatch=r}));var Tn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});jn.__exportStar($n,n)}));var Mn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});jn.__exportStar(Pn,n);jn.__exportStar(xn,n);jn.__exportStar(Tn,n);jn.__exportStar(An,n)}));var Cn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.getLocalStorage=n.getLocalStorageOrThrow=n.getCrypto=n.getCryptoOrThrow=n.getLocation=n.getLocationOrThrow=n.getNavigator=n.getNavigatorOrThrow=n.getDocument=n.getDocumentOrThrow=n.getFromWindowOrThrow=n.getFromWindow=void 0;function r(t){let n=undefined;if(typeof window!=="undefined"&&typeof window[t]!=="undefined"){n=window[t]}return n}n.getFromWindow=r;function e(t){const n=r(t);if(!n){throw new Error(`${t} is not defined in Window`)}return n}n.getFromWindowOrThrow=e;function i(){return e("document")}n.getDocumentOrThrow=i;function s(){return r("document")}n.getDocument=s;function o(){return e("navigator")}n.getNavigatorOrThrow=o;function a(){return r("navigator")}n.getNavigator=a;function u(){return e("location")}n.getLocationOrThrow=u;function c(){return r("location")}n.getLocation=c;function h(){return e("crypto")}n.getCryptoOrThrow=h;function f(){return r("crypto")}n.getCrypto=f;function l(){return e("localStorage")}n.getLocalStorageOrThrow=l;function d(){return r("localStorage")}n.getLocalStorage=d}));var Rn=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.getWindowMetadata=void 0;function r(){let t;let n;try{t=Cn.getDocumentOrThrow();n=Cn.getLocationOrThrow()}catch(t){return null}function r(){const r=t.getElementsByTagName("link");const e=[];for(let t=0;t<r.length;t++){const i=r[t];const s=i.getAttribute("rel");if(s){if(s.toLowerCase().indexOf("icon")>-1){const t=i.getAttribute("href");if(t){if(t.toLowerCase().indexOf("https:")===-1&&t.toLowerCase().indexOf("http:")===-1&&t.indexOf("//")!==0){let r=n.protocol+"//"+n.host;if(t.indexOf("/")===0){r+=t}else{const e=n.pathname.split("/");e.pop();const i=e.join("/");r+=i+"/"+t}e.push(r)}else if(t.indexOf("//")===0){const r=n.protocol+t;e.push(r)}else{e.push(t)}}}}}return e}function e(...n){const r=t.getElementsByTagName("meta");for(let t=0;t<r.length;t++){const e=r[t];const i=["itemprop","property","name"].map((t=>e.getAttribute(t))).filter((t=>{if(t){return n.includes(t)}return false}));if(i.length&&i){const t=e.getAttribute("content");if(t){return t}}}return""}function i(){let n=e("name","og:site_name","og:title","twitter:title");if(!n){n=t.title}return n}function s(){const t=e("description","og:description","twitter:description","keywords");return t}const o=i();const a=s();const u=n.origin;const c=r();const h={description:a,url:u,icons:c,name:o};return h}n.getWindowMetadata=r}));var Un=t=>encodeURIComponent(t).replace(/[!'()*]/g,(t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`));var Dn="%[a-f0-9]{2}";var kn=new RegExp("("+Dn+")|([^%]+?)","gi");var Ln=new RegExp("("+Dn+")+","gi");function qn(t,n){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(t.length===1){return t}n=n||1;var r=t.slice(0,n);var e=t.slice(n);return Array.prototype.concat.call([],qn(r),qn(e))}function Vn(t){try{return decodeURIComponent(t)}catch(e){var n=t.match(kn)||[];for(var r=1;r<n.length;r++){t=qn(n,r).join("");n=t.match(kn)||[]}return t}}function Fn(t){var n={"%FE%FF":"��","%FF%FE":"��"};var r=Ln.exec(t);while(r){try{n[r[0]]=decodeURIComponent(r[0])}catch(t){var e=Vn(r[0]);if(e!==r[0]){n[r[0]]=e}}r=Ln.exec(t)}n["%C2"]="�";var i=Object.keys(n);for(var s=0;s<i.length;s++){var o=i[s];t=t.replace(new RegExp(o,"g"),n[o])}return t}var Gn=function(t){if(typeof t!=="string"){throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`")}try{t=t.replace(/\+/g," ");return decodeURIComponent(t)}catch(n){return Fn(t)}};var Hn=(t,n)=>{if(!(typeof t==="string"&&typeof n==="string")){throw new TypeError("Expected the arguments to be of type `string`")}if(n===""){return[t]}const r=t.indexOf(n);if(r===-1){return[t]}return[t.slice(0,r),t.slice(r+n.length)]};var zn=function(t,n){var r={};var e=Object.keys(t);var i=Array.isArray(n);for(var s=0;s<e.length;s++){var o=e[s];var a=t[o];if(i?n.indexOf(o)!==-1:n(o,a,t)){r[o]=a}}return r};var Wn=n((function(t,n){const r=t=>t===null||t===undefined;const e=Symbol("encodeFragmentIdentifier");function i(t){switch(t.arrayFormat){case"index":return n=>(r,e)=>{const i=r.length;if(e===undefined||t.skipNull&&e===null||t.skipEmptyString&&e===""){return r}if(e===null){return[...r,[a(n,t),"[",i,"]"].join("")]}return[...r,[a(n,t),"[",a(i,t),"]=",a(e,t)].join("")]};case"bracket":return n=>(r,e)=>{if(e===undefined||t.skipNull&&e===null||t.skipEmptyString&&e===""){return r}if(e===null){return[...r,[a(n,t),"[]"].join("")]}return[...r,[a(n,t),"[]=",a(e,t)].join("")]};case"colon-list-separator":return n=>(r,e)=>{if(e===undefined||t.skipNull&&e===null||t.skipEmptyString&&e===""){return r}if(e===null){return[...r,[a(n,t),":list="].join("")]}return[...r,[a(n,t),":list=",a(e,t)].join("")]};case"comma":case"separator":case"bracket-separator":{const n=t.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(e,i)=>{if(i===undefined||t.skipNull&&i===null||t.skipEmptyString&&i===""){return e}i=i===null?"":i;if(e.length===0){return[[a(r,t),n,a(i,t)].join("")]}return[[e,a(i,t)].join(t.arrayFormatSeparator)]}}default:return n=>(r,e)=>{if(e===undefined||t.skipNull&&e===null||t.skipEmptyString&&e===""){return r}if(e===null){return[...r,a(n,t)]}return[...r,[a(n,t),"=",a(e,t)].join("")]}}}function s(t){let n;switch(t.arrayFormat){case"index":return(t,r,e)=>{n=/\[(\d*)\]$/.exec(t);t=t.replace(/\[\d*\]$/,"");if(!n){e[t]=r;return}if(e[t]===undefined){e[t]={}}e[t][n[1]]=r};case"bracket":return(t,r,e)=>{n=/(\[\])$/.exec(t);t=t.replace(/\[\]$/,"");if(!n){e[t]=r;return}if(e[t]===undefined){e[t]=[r];return}e[t]=[].concat(e[t],r)};case"colon-list-separator":return(t,r,e)=>{n=/(:list)$/.exec(t);t=t.replace(/:list$/,"");if(!n){e[t]=r;return}if(e[t]===undefined){e[t]=[r];return}e[t]=[].concat(e[t],r)};case"comma":case"separator":return(n,r,e)=>{const i=typeof r==="string"&&r.includes(t.arrayFormatSeparator);const s=typeof r==="string"&&!i&&u(r,t).includes(t.arrayFormatSeparator);r=s?u(r,t):r;const o=i||s?r.split(t.arrayFormatSeparator).map((n=>u(n,t))):r===null?r:u(r,t);e[n]=o};case"bracket-separator":return(n,r,e)=>{const i=/(\[\])$/.test(n);n=n.replace(/\[\]$/,"");if(!i){e[n]=r?u(r,t):r;return}const s=r===null?[]:r.split(t.arrayFormatSeparator).map((n=>u(n,t)));if(e[n]===undefined){e[n]=s;return}e[n]=[].concat(e[n],s)};default:return(t,n,r)=>{if(r[t]===undefined){r[t]=n;return}r[t]=[].concat(r[t],n)}}}function o(t){if(typeof t!=="string"||t.length!==1){throw new TypeError("arrayFormatSeparator must be single character string")}}function a(t,n){if(n.encode){return n.strict?Un(t):encodeURIComponent(t)}return t}function u(t,n){if(n.decode){return Gn(t)}return t}function c(t){if(Array.isArray(t)){return t.sort()}if(typeof t==="object"){return c(Object.keys(t)).sort(((t,n)=>Number(t)-Number(n))).map((n=>t[n]))}return t}function h(t){const n=t.indexOf("#");if(n!==-1){t=t.slice(0,n)}return t}function f(t){let n="";const r=t.indexOf("#");if(r!==-1){n=t.slice(r)}return n}function l(t){t=h(t);const n=t.indexOf("?");if(n===-1){return""}return t.slice(n+1)}function d(t,n){if(n.parseNumbers&&!Number.isNaN(Number(t))&&(typeof t==="string"&&t.trim()!=="")){t=Number(t)}else if(n.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")){t=t.toLowerCase()==="true"}return t}function p(t,n){n=Object.assign({decode:true,sort:true,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:false,parseBooleans:false},n);o(n.arrayFormatSeparator);const r=s(n);const e=Object.create(null);if(typeof t!=="string"){return e}t=t.trim().replace(/^[?#&]/,"");if(!t){return e}for(const i of t.split("&")){if(i===""){continue}let[t,s]=Hn(n.decode?i.replace(/\+/g," "):i,"=");s=s===undefined?null:["comma","separator","bracket-separator"].includes(n.arrayFormat)?s:u(s,n);r(u(t,n),s,e)}for(const t of Object.keys(e)){const r=e[t];if(typeof r==="object"&&r!==null){for(const t of Object.keys(r)){r[t]=d(r[t],n)}}else{e[t]=d(r,n)}}if(n.sort===false){return e}return(n.sort===true?Object.keys(e).sort():Object.keys(e).sort(n.sort)).reduce(((t,n)=>{const r=e[n];if(Boolean(r)&&typeof r==="object"&&!Array.isArray(r)){t[n]=c(r)}else{t[n]=r}return t}),Object.create(null))}n.extract=l;n.parse=p;n.stringify=(t,n)=>{if(!t){return""}n=Object.assign({encode:true,strict:true,arrayFormat:"none",arrayFormatSeparator:","},n);o(n.arrayFormatSeparator);const e=e=>n.skipNull&&r(t[e])||n.skipEmptyString&&t[e]==="";const s=i(n);const u={};for(const n of Object.keys(t)){if(!e(n)){u[n]=t[n]}}const c=Object.keys(u);if(n.sort!==false){c.sort(n.sort)}return c.map((r=>{const e=t[r];if(e===undefined){return""}if(e===null){return a(r,n)}if(Array.isArray(e)){if(e.length===0&&n.arrayFormat==="bracket-separator"){return a(r,n)+"[]"}return e.reduce(s(r),[]).join("&")}return a(r,n)+"="+a(e,n)})).filter((t=>t.length>0)).join("&")};n.parseUrl=(t,n)=>{n=Object.assign({decode:true},n);const[r,e]=Hn(t,"#");return Object.assign({url:r.split("?")[0]||"",query:p(l(t),n)},n&&n.parseFragmentIdentifier&&e?{fragmentIdentifier:u(e,n)}:{})};n.stringifyUrl=(t,r)=>{r=Object.assign({encode:true,strict:true,[e]:true},r);const i=h(t.url).split("?")[0]||"";const s=n.extract(t.url);const o=n.parse(s,{sort:false});const u=Object.assign(o,t.query);let c=n.stringify(u,r);if(c){c=`?${c}`}let l=f(t.url);if(t.fragmentIdentifier){l=`#${r[e]?a(t.fragmentIdentifier,r):t.fragmentIdentifier}`}return`${i}${c}${l}`};n.pick=(t,r,i)=>{i=Object.assign({parseFragmentIdentifier:true,[e]:false},i);const{url:s,query:o,fragmentIdentifier:a}=n.parseUrl(t,i);return n.stringifyUrl({url:s,query:zn(o,r),fragmentIdentifier:a},i)};n.exclude=(t,r,e)=>{const i=Array.isArray(r)?t=>!r.includes(t):(t,n)=>!r(t,n);return n.pick(t,i,e)}}));const Bn={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};const Kn=":";function Jn(t){const[n,r]=t.split(Kn);return{namespace:n,reference:r}}function Zn(t,n=[]){const r=[];return Object.keys(t).forEach((e=>{if(n.length&&!n.includes(e))return;const i=t[e];r.push(...i.accounts)})),r}function Qn(t,n){return t.includes(":")?[t]:n.chains||[]}const Xn="base10",Yn="base16",tr="base64pad",nr="utf8",rr=0,er=1,ir=0,sr=1,or=12,ar=32;function ur(){const t=S.generateKeyPair();return{privateKey:Mt.toString(t.secretKey,Yn),publicKey:Mt.toString(t.publicKey,Yn)}}function cr(){const t=E.randomBytes(ar);return Mt.toString(t,Yn)}function hr(t,n){const r=S.sharedKey(Mt.fromString(t,Yn),Mt.fromString(n,Yn),!0),e=new b.HKDF(O.SHA256,r).expand(ar);return Mt.toString(e,Yn)}function fr(t){const n=O.hash(Mt.fromString(t,Yn));return Mt.toString(n,Yn)}function lr(t){const n=O.hash(Mt.fromString(t,nr));return Mt.toString(n,Yn)}function dr(t){return Mt.fromString(`${t}`,Xn)}function pr(t){return Number(Mt.toString(t,Xn))}function vr(t){const n=dr(typeof t.type<"u"?t.type:rr);if(pr(n)===er&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?Mt.fromString(t.senderPublicKey,Yn):void 0,e=typeof t.iv<"u"?Mt.fromString(t.iv,Yn):E.randomBytes(or),i=new v.ChaCha20Poly1305(Mt.fromString(t.symKey,Yn)).seal(e,Mt.fromString(t.message,nr));return yr({type:n,sealed:i,iv:e,senderPublicKey:r})}function wr(t){const n=new v.ChaCha20Poly1305(Mt.fromString(t.symKey,Yn)),{sealed:r,iv:e}=br(t.encoded),i=n.open(e,r);if(i===null)throw new Error("Failed to decrypt");return Mt.toString(i,nr)}function yr(t){if(pr(t.type)===er){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Mt.toString(Mt.concat([t.type,t.senderPublicKey,t.iv,t.sealed]),tr)}return Mt.toString(Mt.concat([t.type,t.iv,t.sealed]),tr)}function br(t){const n=Mt.fromString(t,tr),r=n.slice(ir,sr),e=sr;if(pr(r)===er){const t=e+ar,i=t+or,s=n.slice(e,t),o=n.slice(t,i),a=n.slice(i);return{type:r,sealed:a,iv:o,senderPublicKey:s}}const i=e+or,s=n.slice(e,i),o=n.slice(i);return{type:r,sealed:o,iv:s}}function mr(t,n){const r=br(t);return gr({type:pr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Mt.toString(r.senderPublicKey,Yn):void 0,receiverPublicKey:n?.receiverPublicKey})}function gr(t){const n=t?.type||rr;if(n===er){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:n,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function _r(t){return t.type===er&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Er=Object.defineProperty,Or=Object.getOwnPropertySymbols,Sr=Object.prototype.hasOwnProperty,Ir=Object.prototype.propertyIsEnumerable,jr=(t,n,r)=>n in t?Er(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,Ar=(t,n)=>{for(var r in n||(n={}))Sr.call(n,r)&&jr(t,r,n[r]);if(Or)for(var r of Or(n))Ir.call(n,r)&&jr(t,r,n[r]);return t};const Nr="ReactNative",Pr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},xr="js";function $r(){return typeof i<"u"&&typeof i.versions<"u"&&typeof i.versions.node<"u"}function Tr(){return!Cn.getDocument()&&!!Cn.getNavigator()&&navigator.product===Nr}function Mr(){return!$r()&&!!Cn.getNavigator()}function Cr(){return Tr()?Pr.reactNative:$r()?Pr.node:Mr()?Pr.browser:Pr.unknown}function Rr(t,n){let r=Wn.parse(t);return r=Ar(Ar({},r),n),t=Wn.stringify(r),t}function Ur(){return Rn.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Dr(){if(Cr()===Pr.reactNative&&typeof o<"u"&&typeof(o==null?void 0:o.Platform)<"u"){const{OS:t,Version:n}=o.Platform;return[t,n].join("-")}const t=zt();if(t===null)return"unknown";const n=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[n,t.name,t.version].join("-"):[n,t.version].join("-")}function kr(){var t;const n=Cr();return n===Pr.browser?[n,((t=Cn.getLocation())==null?void 0:t.host)||"unknown"].join(":"):n}function Lr(t,n,r){const e=Dr(),i=kr();return[[t,n].join("-"),[xr,r].join("-"),e,i].join("/")}function qr({protocol:t,version:n,relayUrl:r,sdkVersion:e,auth:i,projectId:s,useOnCloseEvent:o}){const a=r.split("?"),u=Lr(t,n,e),c={auth:i,ua:u,projectId:s,useOnCloseEvent:o||void 0},h=Rr(a[1]||"",c);return a[0]+"?"+h}function Vr(t,n){return t.filter((t=>n.includes(t))).length===t.length}function Fr(t){return Object.fromEntries(t.entries())}function Gr(t){return new Map(Object.entries(t))}function Hr(t=Mn.FIVE_MINUTES,n){const r=Mn.toMiliseconds(t||Mn.FIVE_MINUTES);let e,i,s;return{resolve:t=>{s&&e&&(clearTimeout(s),e(t))},reject:t=>{s&&i&&(clearTimeout(s),i(t))},done:()=>new Promise(((t,o)=>{s=setTimeout((()=>{o(new Error(n))}),r),e=t,i=o}))}}function zr(t,n,r){return new Promise((async(e,i)=>{const s=setTimeout((()=>i(new Error(r))),n);try{const n=await t;e(n)}catch(t){i(t)}clearTimeout(s)}))}function Wr(t,n){if(typeof n=="string"&&n.startsWith(`${t}:`))return n;if(t.toLowerCase()==="topic"){if(typeof n!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${n}`}else if(t.toLowerCase()==="id"){if(typeof n!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${n}`}throw new Error(`Unknown expirer target type: ${t}`)}function Br(t){return Wr("topic",t)}function Kr(t){return Wr("id",t)}function Jr(t){const[n,r]=t.split(":"),e={id:void 0,topic:void 0};if(n==="topic"&&typeof r=="string")e.topic=r;else if(n==="id"&&Number.isInteger(Number(r)))e.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${n}:${r}`);return e}function Zr(t,n){return Mn.fromMiliseconds((n||Date.now())+Mn.toMiliseconds(t))}function Qr(t){return Date.now()>=Mn.toMiliseconds(t)}function Xr(t,n){return`${t}${n?`:${n}`:""}`}function Yr(t=[],n=[]){return[...new Set([...t,...n])]}async function te({id:t,topic:n,wcDeepLink:r}){try{if(!r)return;const e=typeof r=="string"?JSON.parse(r):r;let i=e?.href;if(typeof i!="string")return;i.endsWith("/")&&(i=i.slice(0,-1));const s=`${i}/wc?requestId=${t}&sessionTopic=${n}`,a=Cr();a===Pr.browser?s.startsWith("https://")?window.open(s,"_blank","noreferrer noopener"):window.open(s,"_self","noreferrer noopener"):a===Pr.reactNative&&typeof(o==null?void 0:o.Linking)<"u"&&await o.Linking.openURL(s)}catch(t){console.error(t)}}const ne="irn";function re(t){return t?.relay||{protocol:ne}}function ee(t){const n=Bn[t];if(typeof n>"u")throw new Error(`Relay Protocol not supported: ${t}`);return n}var ie=Object.defineProperty,se=Object.getOwnPropertySymbols,oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,ue=(t,n,r)=>n in t?ie(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,ce=(t,n)=>{for(var r in n||(n={}))oe.call(n,r)&&ue(t,r,n[r]);if(se)for(var r of se(n))ae.call(n,r)&&ue(t,r,n[r]);return t};function he(t,n="-"){const r={},e="relay"+n;return Object.keys(t).forEach((n=>{if(n.startsWith(e)){const i=n.replace(e,""),s=t[n];r[i]=s}})),r}function fe(t){const n=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,e=t.substring(0,n),i=t.substring(n+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Wn.parse(s);return{protocol:e,topic:le(i[0]),version:parseInt(i[1],10),symKey:o.symKey,relay:he(o)}}function le(t){return t.startsWith("//")?t.substring(2):t}function de(t,n="-"){const r="relay",e={};return Object.keys(t).forEach((i=>{const s=r+n+i;t[i]&&(e[s]=t[i])})),e}function pe(t){return`${t.protocol}:${t.topic}@${t.version}?`+Wn.stringify(ce({symKey:t.symKey},de(t.relay)))}function ve(t){const n=[];return t.forEach((t=>{const[r,e]=t.split(":");n.push(`${r}:${e}`)})),n}function we(t){const n=[];return Object.values(t).forEach((t=>{n.push(...ve(t.accounts))})),n}function ye(t,n){const r=[];return Object.values(t).forEach((t=>{ve(t.accounts).includes(n)&&r.push(...t.methods)})),r}function be(t,n){const r=[];return Object.values(t).forEach((t=>{ve(t.accounts).includes(n)&&r.push(...t.events)})),r}function me(t,n){const r=We(t,n);if(r)throw new Error(r.message);const e={};for(const[n,r]of Object.entries(t))e[n]={methods:r.methods,events:r.events,chains:r.accounts.map((t=>`${t.split(":")[0]}:${t.split(":")[1]}`))};return e}function ge(t){return t.includes(":")}function _e(t){return ge(t)?t.split(":")[0]:t}const Ee={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Oe={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Se(t,n){const{message:r,code:e}=Oe[t];return{message:n?`${r} ${n}`:r,code:e}}function Ie(t,n){const{message:r,code:e}=Ee[t];return{message:n?`${r} ${n}`:r,code:e}}function je(t,n){return Array.isArray(t)?typeof n<"u"&&t.length?t.every(n):!0:!1}function Ae(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Ne(t){return typeof t>"u"}function Pe(t,n){return n&&Ne(t)?!0:typeof t=="string"&&!!t.trim().length}function xe(t,n){return n&&Ne(t)?!0:typeof t=="number"&&!isNaN(t)}function $e(t,n){const{requiredNamespaces:r}=n,e=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return Vr(i,e)?(e.forEach((n=>{const{accounts:e,methods:i,events:o}=t.namespaces[n],a=ve(e),u=r[n];(!Vr(Qn(n,u),a)||!Vr(u.methods,i)||!Vr(u.events,o))&&(s=!1)})),s):!1}function Te(t){return Pe(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Me(t){if(Pe(t,!1)&&t.includes(":")){const n=t.split(":");if(n.length===3){const t=n[0]+":"+n[1];return!!n[2]&&Te(t)}}return!1}function Ce(t){if(Pe(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Re(t){var n;return(n=t?.proposer)==null?void 0:n.publicKey}function Ue(t){return t?.topic}function De(t,n){let r=null;return Pe(t?.publicKey,!1)||(r=Se("MISSING_OR_INVALID",`${n} controller public key should be a string`)),r}function ke(t){let n=!0;return je(t)?t.length&&(n=t.every((t=>Pe(t,!1)))):n=!1,n}function Le(t,n,r){let e=null;return je(n)&&n.length?n.forEach((t=>{e||Te(t)||(e=Ie("UNSUPPORTED_CHAINS",`${r}, chain ${t} should be a string and conform to "namespace:chainId" format`))})):Te(t)||(e=Ie("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),e}function qe(t,n,r){let e=null;return Object.entries(t).forEach((([t,i])=>{if(e)return;const s=Le(t,Qn(t,i),`${n} ${r}`);s&&(e=s)})),e}function Ve(t,n){let r=null;return je(t)?t.forEach((t=>{r||Me(t)||(r=Ie("UNSUPPORTED_ACCOUNTS",`${n}, account ${t} should be a string and conform to "namespace:chainId:address" format`))})):r=Ie("UNSUPPORTED_ACCOUNTS",`${n}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Fe(t,n){let r=null;return Object.values(t).forEach((t=>{if(r)return;const e=Ve(t?.accounts,`${n} namespace`);e&&(r=e)})),r}function Ge(t,n){let r=null;return ke(t?.methods)?ke(t?.events)||(r=Ie("UNSUPPORTED_EVENTS",`${n}, events should be an array of strings or empty array for no events`)):r=Ie("UNSUPPORTED_METHODS",`${n}, methods should be an array of strings or empty array for no methods`),r}function He(t,n){let r=null;return Object.values(t).forEach((t=>{if(r)return;const e=Ge(t,`${n}, namespace`);e&&(r=e)})),r}function ze(t,n,r){let e=null;if(t&&Ae(t)){const i=He(t,n);i&&(e=i);const s=qe(t,n,r);s&&(e=s)}else e=Se("MISSING_OR_INVALID",`${n}, ${r} should be an object with data`);return e}function We(t,n){let r=null;if(t&&Ae(t)){const e=He(t,n);e&&(r=e);const i=Fe(t,n);i&&(r=i)}else r=Se("MISSING_OR_INVALID",`${n}, namespaces should be an object with data`);return r}function Be(t){return Pe(t.protocol,!0)}function Ke(t,n){let r=!1;return n&&!t?r=!0:t&&je(t)&&t.length&&t.forEach((t=>{r=Be(t)})),r}function Je(t){return typeof t=="number"}function Ze(t){return typeof t<"u"&&typeof t!==null}function Qe(t){return!(!t||typeof t!="object"||!t.code||!xe(t.code,!1)||!t.message||!Pe(t.message,!1))}function Xe(t){return!(Ne(t)||!Pe(t.method,!1))}function Ye(t){return!(Ne(t)||Ne(t.result)&&Ne(t.error)||!xe(t.id,!1)||!Pe(t.jsonrpc,!1))}function ti(t){return!(Ne(t)||!Pe(t.name,!1))}function ni(t,n){return!(!Te(n)||!we(t).includes(n))}function ri(t,n,r){return Pe(r,!1)?ye(t,n).includes(r):!1}function ei(t,n,r){return Pe(r,!1)?be(t,n).includes(r):!1}function ii(t,n,r){let e=null;const i=si(t),s=ai(n),o=Object.keys(i),a=Object.keys(s),u=oi(Object.keys(t)),c=oi(Object.keys(n)),h=u.filter((t=>!c.includes(t)));return h.length&&(e=Se("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${h.toString()}\n      Received: ${Object.keys(n).toString()}`)),Vr(o,a)||(e=Se("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${o.toString()}\n      Approved: ${a.toString()}`)),Object.keys(n).forEach((t=>{if(!t.includes(":")||e)return;const i=ve(n[t].accounts);i.includes(t)||(e=Se("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${t}\n        Required: ${t}\n        Approved: ${i.toString()}`))})),o.forEach((t=>{e||(Vr(i[t].methods,s[t].methods)?Vr(i[t].events,s[t].events)||(e=Se("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${t}`)):e=Se("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${t}`))})),e}function si(t){const n={};return Object.keys(t).forEach((r=>{var e;r.includes(":")?n[r]=t[r]:(e=t[r].chains)==null||e.forEach((e=>{n[e]={methods:t[r].methods,events:t[r].events}}))})),n}function oi(t){return[...new Set(t.map((t=>t.includes(":")?t.split(":")[0]:t)))]}function ai(t){const n={};return Object.keys(t).forEach((r=>{if(r.includes(":"))n[r]=t[r];else{const e=ve(t[r].accounts);e?.forEach((e=>{n[e]={accounts:t[r].accounts.filter((t=>t.includes(`${e}:`))),methods:t[r].methods,events:t[r].events}}))}})),n}function ui(t,n){return xe(t,!1)&&t<=n.max&&t>=n.min}function ci(){const t=Cr();return new Promise((n=>{switch(t){case Pr.browser:n(hi());break;case Pr.reactNative:n(fi());break;case Pr.node:n(li());break;default:n(!0)}}))}function hi(){return Mr()&&navigator?.onLine}async function fi(){if(Tr()&&typeof o<"u"&&o!=null&&o.NetInfo){const t=await(o==null?void 0:o.NetInfo.fetch());return t?.isConnected}return!0}function li(){return!0}function di(t){switch(Cr()){case Pr.browser:pi(t);break;case Pr.reactNative:vi(t);break}}function pi(t){!Tr()&&Mr()&&(window.addEventListener("online",(()=>t(!0))),window.addEventListener("offline",(()=>t(!1))))}function vi(t){Tr()&&typeof o<"u"&&o!=null&&o.NetInfo&&o?.NetInfo.addEventListener((n=>t(n?.isConnected)))}const wi={};class yi{static get(t){return wi[t]}static set(t,n){wi[t]=n}static delete(t){delete wi[t]}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bi=function(t,n){bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)if(n.hasOwnProperty(r))t[r]=n[r]};return bi(t,n)};function mi(t,n){bi(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var gi=function(){gi=Object.assign||function t(n){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))n[s]=r[s]}return n};return gi.apply(this,arguments)};function _i(t,n){var r={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0)r[e]=t[e];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,e=Object.getOwnPropertySymbols(t);i<e.length;i++){if(n.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i]))r[e[i]]=t[e[i]]}return r}function Ei(t,n,r,e){var i=arguments.length,s=i<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,r):e,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)if(o=t[a])s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s}function Oi(t,n){return function(r,e){n(r,e,t)}}function Si(t,n){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)}function Ii(t,n,r,e){function i(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{u(e.next(t))}catch(t){s(t)}}function a(t){try{u(e["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):i(t.value).then(o,a)}u((e=e.apply(t,n||[])).next())}))}function ji(t,n){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return u([t,n])}}function u(o){if(e)throw new TypeError("Generator is already executing.");while(r)try{if(e=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=n.call(t,r)}catch(t){o=[6,t];i=0}finally{e=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}function Ai(t,n,r,e){if(e===undefined)e=r;t[e]=n[r]}function Ni(t,n){for(var r in t)if(r!=="default"&&!n.hasOwnProperty(r))n[r]=t[r]}function Pi(t){var n=typeof Symbol==="function"&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&e>=t.length)t=void 0;return{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function xi(t,n){var r=typeof Symbol==="function"&&t[Symbol.iterator];if(!r)return t;var e=r.call(t),i,s=[],o;try{while((n===void 0||n-- >0)&&!(i=e.next()).done)s.push(i.value)}catch(t){o={error:t}}finally{try{if(i&&!i.done&&(r=e["return"]))r.call(e)}finally{if(o)throw o.error}}return s}function $i(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(xi(arguments[n]));return t}function Ti(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;for(var e=Array(t),i=0,n=0;n<r;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,i++)e[i]=s[o];return e}function Mi(t){return this instanceof Mi?(this.v=t,this):new Mi(t)}function Ci(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r.apply(t,n||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){if(e[t])i[t]=function(n){return new Promise((function(r,e){s.push([t,n,r,e])>1||a(t,n)}))}}function a(t,n){try{u(e[t](n))}catch(t){f(s[0][3],t)}}function u(t){t.value instanceof Mi?Promise.resolve(t.value.v).then(c,h):f(s[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,n){if(t(n),s.shift(),s.length)a(s[0][0],s[0][1])}}function Ri(t){var n,r;return n={},e("next"),e("throw",(function(t){throw t})),e("return"),n[Symbol.iterator]=function(){return this},n;function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:Mi(t[e](n)),done:e==="return"}:i?i(n):n}:i}}function Ui(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],r;return n?n.call(t):(t=typeof Pi==="function"?Pi(t):t[Symbol.iterator](),r={},e("next"),e("throw"),e("return"),r[Symbol.asyncIterator]=function(){return this},r);function e(n){r[n]=t[n]&&function(r){return new Promise((function(e,s){r=t[n](r),i(e,s,r.done,r.value)}))}}function i(t,n,r,e){Promise.resolve(e).then((function(n){t({value:n,done:r})}),n)}}function Di(t,n){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:n})}else{t.raw=n}return t}function ki(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))n[r]=t[r];n.default=t;return n}function Li(t){return t&&t.__esModule?t:{default:t}}function qi(t,n){if(!n.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n.get(t)}function Vi(t,n,r){if(!n.has(t)){throw new TypeError("attempted to set private field on non-instance")}n.set(t,r);return r}const Fi=Object.freeze({__proto__:null,__extends:mi,get __assign(){return gi},__rest:_i,__decorate:Ei,__param:Oi,__metadata:Si,__awaiter:Ii,__generator:ji,__createBinding:Ai,__exportStar:Ni,__values:Pi,__read:xi,__spread:$i,__spreadArrays:Ti,__await:Mi,__asyncGenerator:Ci,__asyncDelegator:Ri,__asyncValues:Ui,__makeTemplateObject:Di,__importStar:ki,__importDefault:Li,__classPrivateFieldGet:qi,__classPrivateFieldSet:Vi});var Gi=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){if(typeof t!=="string"){throw new Error(`Cannot safe json parse value of type ${typeof t}`)}try{return JSON.parse(t)}catch(n){return t}}n.safeJsonParse=r;function e(t){return typeof t==="string"?t:JSON.stringify(t,((t,n)=>typeof n==="undefined"?null:n))}n.safeJsonStringify=e}));var Hi=n((function(t){(function(){let n;function r(){}n=r;n.prototype.getItem=function(t){if(this.hasOwnProperty(t)){return String(this[t])}return null};n.prototype.setItem=function(t,n){this[t]=String(n)};n.prototype.removeItem=function(t){delete this[t]};n.prototype.clear=function(){const t=this;Object.keys(t).forEach((function(n){t[n]=undefined;delete t[n]}))};n.prototype.key=function(t){t=t||0;return Object.keys(this)[t]};n.prototype.__defineGetter__("length",(function(){return Object.keys(this).length}));if(typeof a!=="undefined"&&a.localStorage){t.exports=a.localStorage}else if(typeof window!=="undefined"&&window.localStorage){t.exports=window.localStorage}else{t.exports=new r}})()}));var zi=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.IKeyValueStorage=void 0;class r{}n.IKeyValueStorage=r}));var Wi=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.parseEntry=void 0;function r(t){var n;return[t[0],Gi.safeJsonParse((n=t[1])!==null&&n!==void 0?n:"")]}n.parseEntry=r}));const Bi=s(Fi);var Ki=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});Bi.__exportStar(zi,n);Bi.__exportStar(Wi,n)}));var Ji=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.KeyValueStorage=void 0;const r=Bi.__importDefault(Hi);class e{constructor(){this.localStorage=r.default}getKeys(){return Bi.__awaiter(this,void 0,void 0,(function*(){return Object.keys(this.localStorage)}))}getEntries(){return Bi.__awaiter(this,void 0,void 0,(function*(){return Object.entries(this.localStorage).map(Ki.parseEntry)}))}getItem(t){return Bi.__awaiter(this,void 0,void 0,(function*(){const n=this.localStorage.getItem(t);if(n===null){return undefined}return Gi.safeJsonParse(n)}))}setItem(t,n){return Bi.__awaiter(this,void 0,void 0,(function*(){this.localStorage.setItem(t,Gi.safeJsonStringify(n))}))}removeItem(t){return Bi.__awaiter(this,void 0,void 0,(function*(){this.localStorage.removeItem(t)}))}}n.KeyValueStorage=e;n.default=e}));const Zi=u(Ji);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qi=function(t,n){Qi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)if(n.hasOwnProperty(r))t[r]=n[r]};return Qi(t,n)};function Xi(t,n){Qi(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var Yi=function(){Yi=Object.assign||function t(n){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))n[s]=r[s]}return n};return Yi.apply(this,arguments)};function ts(t,n){var r={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0)r[e]=t[e];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,e=Object.getOwnPropertySymbols(t);i<e.length;i++){if(n.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i]))r[e[i]]=t[e[i]]}return r}function ns(t,n,r,e){var i=arguments.length,s=i<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,r):e,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)if(o=t[a])s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s}function rs(t,n){return function(r,e){n(r,e,t)}}function es(t,n){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)}function is(t,n,r,e){function i(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{u(e.next(t))}catch(t){s(t)}}function a(t){try{u(e["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):i(t.value).then(o,a)}u((e=e.apply(t,n||[])).next())}))}function ss(t,n){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return u([t,n])}}function u(o){if(e)throw new TypeError("Generator is already executing.");while(r)try{if(e=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=n.call(t,r)}catch(t){o=[6,t];i=0}finally{e=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}function os(t,n,r,e){if(e===undefined)e=r;t[e]=n[r]}function as(t,n){for(var r in t)if(r!=="default"&&!n.hasOwnProperty(r))n[r]=t[r]}function us(t){var n=typeof Symbol==="function"&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&e>=t.length)t=void 0;return{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function cs(t,n){var r=typeof Symbol==="function"&&t[Symbol.iterator];if(!r)return t;var e=r.call(t),i,s=[],o;try{while((n===void 0||n-- >0)&&!(i=e.next()).done)s.push(i.value)}catch(t){o={error:t}}finally{try{if(i&&!i.done&&(r=e["return"]))r.call(e)}finally{if(o)throw o.error}}return s}function hs(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(cs(arguments[n]));return t}function fs(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;for(var e=Array(t),i=0,n=0;n<r;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,i++)e[i]=s[o];return e}function ls(t){return this instanceof ls?(this.v=t,this):new ls(t)}function ds(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r.apply(t,n||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){if(e[t])i[t]=function(n){return new Promise((function(r,e){s.push([t,n,r,e])>1||a(t,n)}))}}function a(t,n){try{u(e[t](n))}catch(t){f(s[0][3],t)}}function u(t){t.value instanceof ls?Promise.resolve(t.value.v).then(c,h):f(s[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,n){if(t(n),s.shift(),s.length)a(s[0][0],s[0][1])}}function ps(t){var n,r;return n={},e("next"),e("throw",(function(t){throw t})),e("return"),n[Symbol.iterator]=function(){return this},n;function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:ls(t[e](n)),done:e==="return"}:i?i(n):n}:i}}function vs(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],r;return n?n.call(t):(t=typeof us==="function"?us(t):t[Symbol.iterator](),r={},e("next"),e("throw"),e("return"),r[Symbol.asyncIterator]=function(){return this},r);function e(n){r[n]=t[n]&&function(r){return new Promise((function(e,s){r=t[n](r),i(e,s,r.done,r.value)}))}}function i(t,n,r,e){Promise.resolve(e).then((function(n){t({value:n,done:r})}),n)}}function ws(t,n){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:n})}else{t.raw=n}return t}function ys(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))n[r]=t[r];n.default=t;return n}function bs(t){return t&&t.__esModule?t:{default:t}}function ms(t,n){if(!n.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n.get(t)}function gs(t,n,r){if(!n.has(t)){throw new TypeError("attempted to set private field on non-instance")}n.set(t,r);return r}const _s=Object.freeze({__proto__:null,__extends:Xi,get __assign(){return Yi},__rest:ts,__decorate:ns,__param:rs,__metadata:es,__awaiter:is,__generator:ss,__createBinding:os,__exportStar:as,__values:us,__read:cs,__spread:hs,__spreadArrays:fs,__await:ls,__asyncGenerator:ds,__asyncDelegator:ps,__asyncValues:vs,__makeTemplateObject:ws,__importStar:ys,__importDefault:bs,__classPrivateFieldGet:ms,__classPrivateFieldSet:gs});class Es{}const Os=Object.freeze({__proto__:null,IEvents:Es});const Ss=s(Os);var Is=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.IHeartBeat=void 0;class r extends Ss.IEvents{constructor(t){super()}}n.IHeartBeat=r}));const js=s(_s);var As=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});js.__exportStar(Is,n)}));var Ns=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.HEARTBEAT_EVENTS=n.HEARTBEAT_INTERVAL=void 0;n.HEARTBEAT_INTERVAL=Mn.FIVE_SECONDS;n.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}}));var Ps=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});js.__exportStar(Ns,n)}));var xs=n((function(n,r){Object.defineProperty(r,"__esModule",{value:true});r.HeartBeat=void 0;class e extends As.IHeartBeat{constructor(n){super(n);this.events=new t.EventEmitter;this.interval=Ps.HEARTBEAT_INTERVAL;this.interval=(n===null||n===void 0?void 0:n.interval)||Ps.HEARTBEAT_INTERVAL}static init(t){return js.__awaiter(this,void 0,void 0,(function*(){const n=new e(t);yield n.init();return n}))}init(){return js.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}stop(){clearInterval(this.intervalRef)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}initialize(){return js.__awaiter(this,void 0,void 0,(function*(){this.intervalRef=setInterval((()=>this.pulse()),Mn.toMiliseconds(this.interval))}))}pulse(){this.events.emit(Ps.HEARTBEAT_EVENTS.pulse)}}r.HeartBeat=e}));var $s=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});js.__exportStar(xs,n);js.__exportStar(As,n);js.__exportStar(Ps,n)}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ts=function(t,n){Ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)if(n.hasOwnProperty(r))t[r]=n[r]};return Ts(t,n)};function Ms(t,n){Ts(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var Cs=function(){Cs=Object.assign||function t(n){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))n[s]=r[s]}return n};return Cs.apply(this,arguments)};function Rs(t,n){var r={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0)r[e]=t[e];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,e=Object.getOwnPropertySymbols(t);i<e.length;i++){if(n.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i]))r[e[i]]=t[e[i]]}return r}function Us(t,n,r,e){var i=arguments.length,s=i<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,r):e,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)if(o=t[a])s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s}function Ds(t,n){return function(r,e){n(r,e,t)}}function ks(t,n){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)}function Ls(t,n,r,e){function i(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{u(e.next(t))}catch(t){s(t)}}function a(t){try{u(e["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):i(t.value).then(o,a)}u((e=e.apply(t,n||[])).next())}))}function qs(t,n){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return u([t,n])}}function u(o){if(e)throw new TypeError("Generator is already executing.");while(r)try{if(e=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=n.call(t,r)}catch(t){o=[6,t];i=0}finally{e=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}function Vs(t,n,r,e){if(e===undefined)e=r;t[e]=n[r]}function Fs(t,n){for(var r in t)if(r!=="default"&&!n.hasOwnProperty(r))n[r]=t[r]}function Gs(t){var n=typeof Symbol==="function"&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&e>=t.length)t=void 0;return{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Hs(t,n){var r=typeof Symbol==="function"&&t[Symbol.iterator];if(!r)return t;var e=r.call(t),i,s=[],o;try{while((n===void 0||n-- >0)&&!(i=e.next()).done)s.push(i.value)}catch(t){o={error:t}}finally{try{if(i&&!i.done&&(r=e["return"]))r.call(e)}finally{if(o)throw o.error}}return s}function zs(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(Hs(arguments[n]));return t}function Ws(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;for(var e=Array(t),i=0,n=0;n<r;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,i++)e[i]=s[o];return e}function Bs(t){return this instanceof Bs?(this.v=t,this):new Bs(t)}function Ks(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r.apply(t,n||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){if(e[t])i[t]=function(n){return new Promise((function(r,e){s.push([t,n,r,e])>1||a(t,n)}))}}function a(t,n){try{u(e[t](n))}catch(t){f(s[0][3],t)}}function u(t){t.value instanceof Bs?Promise.resolve(t.value.v).then(c,h):f(s[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,n){if(t(n),s.shift(),s.length)a(s[0][0],s[0][1])}}function Js(t){var n,r;return n={},e("next"),e("throw",(function(t){throw t})),e("return"),n[Symbol.iterator]=function(){return this},n;function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:Bs(t[e](n)),done:e==="return"}:i?i(n):n}:i}}function Zs(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],r;return n?n.call(t):(t=typeof Gs==="function"?Gs(t):t[Symbol.iterator](),r={},e("next"),e("throw"),e("return"),r[Symbol.asyncIterator]=function(){return this},r);function e(n){r[n]=t[n]&&function(r){return new Promise((function(e,s){r=t[n](r),i(e,s,r.done,r.value)}))}}function i(t,n,r,e){Promise.resolve(e).then((function(n){t({value:n,done:r})}),n)}}function Qs(t,n){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:n})}else{t.raw=n}return t}function Xs(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))n[r]=t[r];n.default=t;return n}function Ys(t){return t&&t.__esModule?t:{default:t}}function to(t,n){if(!n.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n.get(t)}function no(t,n,r){if(!n.has(t)){throw new TypeError("attempted to set private field on non-instance")}n.set(t,r);return r}const ro=Object.freeze({__proto__:null,__extends:Ms,get __assign(){return Cs},__rest:Rs,__decorate:Us,__param:Ds,__metadata:ks,__awaiter:Ls,__generator:qs,__createBinding:Vs,__exportStar:Fs,__values:Gs,__read:Hs,__spread:zs,__spreadArrays:Ws,__await:Bs,__asyncGenerator:Ks,__asyncDelegator:Js,__asyncValues:Zs,__makeTemplateObject:Qs,__importStar:Xs,__importDefault:Ys,__classPrivateFieldGet:to,__classPrivateFieldSet:no});function eo(t){try{return JSON.stringify(t)}catch(t){return'"[Circular]"'}}var io=so;function so(t,n,r){var e=r&&r.stringify||eo;var i=1;if(typeof t==="object"&&t!==null){var s=n.length+i;if(s===1)return t;var o=new Array(s);o[0]=e(t);for(var a=1;a<s;a++){o[a]=e(n[a])}return o.join(" ")}if(typeof t!=="string"){return t}var u=n.length;if(u===0)return t;var c="";var h=1-i;var f=-1;var l=t&&t.length||0;for(var d=0;d<l;){if(t.charCodeAt(d)===37&&d+1<l){f=f>-1?f:0;switch(t.charCodeAt(d+1)){case 100:case 102:if(h>=u)break;if(n[h]==null)break;if(f<d)c+=t.slice(f,d);c+=Number(n[h]);f=d+2;d++;break;case 105:if(h>=u)break;if(n[h]==null)break;if(f<d)c+=t.slice(f,d);c+=Math.floor(Number(n[h]));f=d+2;d++;break;case 79:case 111:case 106:if(h>=u)break;if(n[h]===undefined)break;if(f<d)c+=t.slice(f,d);var p=typeof n[h];if(p==="string"){c+="'"+n[h]+"'";f=d+2;d++;break}if(p==="function"){c+=n[h].name||"<anonymous>";f=d+2;d++;break}c+=e(n[h]);f=d+2;d++;break;case 115:if(h>=u)break;if(f<d)c+=t.slice(f,d);c+=String(n[h]);f=d+2;d++;break;case 37:if(f<d)c+=t.slice(f,d);c+="%";f=d+2;d++;h--;break}++h}++d}if(f===-1)return t;else if(f<l){c+=t.slice(f)}return c}var oo=ho;const ao=No().console||{};const uo={mapHttpRequest:_o,mapHttpResponse:_o,wrapRequestSerializer:Eo,wrapResponseSerializer:Eo,wrapErrorSerializer:Eo,req:_o,res:_o,err:mo};function co(t,n){if(Array.isArray(t)){const n=t.filter((function(t){return t!=="!stdSerializers.err"}));return n}else if(t===true){return Object.keys(n)}return false}function ho(t){t=t||{};t.browser=t.browser||{};const n=t.browser.transmit;if(n&&typeof n.send!=="function"){throw Error("pino: transmit option must have a send function")}const r=t.browser.write||ao;if(t.browser.write)t.browser.asObject=true;const e=t.serializers||{};const i=co(t.browser.serialize,e);let s=t.browser.serialize;if(Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1)s=false;const o=["error","fatal","warn","info","debug","trace"];if(typeof r==="function"){r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r}if(t.enabled===false)t.level="silent";const a=t.level||"info";const u=Object.create(r);if(!u.log)u.log=Oo;Object.defineProperty(u,"levelVal",{get:h});Object.defineProperty(u,"level",{get:f,set:l});const c={transmit:n,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:go(t)};u.levels=ho.levels;u.level=a;u.setMaxListeners=u.getMaxListeners=u.emit=u.addListener=u.on=u.prependListener=u.once=u.prependOnceListener=u.removeListener=u.removeAllListeners=u.listeners=u.listenerCount=u.eventNames=u.write=u.flush=Oo;u.serializers=e;u._serialize=i;u._stdErrSerialize=s;u.child=d;if(n)u._logEvent=bo();function h(){return this.level==="silent"?Infinity:this.levels.values[this.level]}function f(){return this._level}function l(t){if(t!=="silent"&&!this.levels.values[t]){throw Error("unknown level "+t)}this._level=t;fo(c,u,"error","log");fo(c,u,"fatal","error");fo(c,u,"warn","error");fo(c,u,"info","log");fo(c,u,"debug","log");fo(c,u,"trace","log")}function d(r,s){if(!r){throw new Error("missing bindings for child Pino")}s=s||{};if(i&&r.serializers){s.serializers=r.serializers}const o=s.serializers;if(i&&o){var a=Object.assign({},e,o);var u=t.browser.serialize===true?Object.keys(a):i;delete r.serializers;vo([r],u,a,this._stdErrSerialize)}function c(t){this._childLevel=(t._childLevel|0)+1;this.error=wo(t,r,"error");this.fatal=wo(t,r,"fatal");this.warn=wo(t,r,"warn");this.info=wo(t,r,"info");this.debug=wo(t,r,"debug");this.trace=wo(t,r,"trace");if(a){this.serializers=a;this._serialize=u}if(n){this._logEvent=bo([].concat(t._logEvent.bindings,r))}}c.prototype=this;return new c(this)}return u}ho.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};ho.stdSerializers=uo;ho.stdTimeFunctions=Object.assign({},{nullTime:So,epochTime:Io,unixTime:jo,isoTime:Ao});function fo(t,n,r,e){const i=Object.getPrototypeOf(n);n[r]=n.levelVal>n.levels.values[r]?Oo:i[r]?i[r]:ao[r]||ao[e]||Oo;lo(t,n,r)}function lo(t,n,r){if(!t.transmit&&n[r]===Oo)return;n[r]=function(e){return function i(){const s=t.timestamp();const o=new Array(arguments.length);const a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===ao?ao:this;for(var u=0;u<o.length;u++)o[u]=arguments[u];if(t.serialize&&!t.asObject){vo(o,this._serialize,this.serializers,this._stdErrSerialize)}if(t.asObject)e.call(a,po(this,r,o,s));else e.apply(a,o);if(t.transmit){const e=t.transmit.level||n.level;const i=ho.levels.values[e];const a=ho.levels.values[r];if(a<i)return;yo(this,{ts:s,methodLevel:r,methodValue:a,transmitLevel:e,transmitValue:ho.levels.values[t.transmit.level||n.level],send:t.transmit.send,val:n.levelVal},o)}}}(n[r])}function po(t,n,r,e){if(t._serialize)vo(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};if(e){o.time=e}o.level=ho.levels.values[n];let a=(t._childLevel|0)+1;if(a<1)a=1;if(s!==null&&typeof s==="object"){while(a--&&typeof i[0]==="object"){Object.assign(o,i.shift())}s=i.length?io(i.shift(),i):undefined}else if(typeof s==="string")s=io(i.shift(),i);if(s!==undefined)o.msg=s;return o}function vo(t,n,r,e){for(const i in t){if(e&&t[i]instanceof Error){t[i]=ho.stdSerializers.err(t[i])}else if(typeof t[i]==="object"&&!Array.isArray(t[i])){for(const e in t[i]){if(n&&n.indexOf(e)>-1&&e in r){t[i][e]=r[e](t[i][e])}}}}}function wo(t,n,r){return function(){const e=new Array(1+arguments.length);e[0]=n;for(var i=1;i<e.length;i++){e[i]=arguments[i-1]}return t[r].apply(this,e)}}function yo(t,n,r){const e=n.send;const i=n.ts;const s=n.methodLevel;const o=n.methodValue;const a=n.val;const u=t._logEvent.bindings;vo(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===undefined?true:t._stdErrSerialize);t._logEvent.ts=i;t._logEvent.messages=r.filter((function(t){return u.indexOf(t)===-1}));t._logEvent.level.label=s;t._logEvent.level.value=o;e(s,t._logEvent,a);t._logEvent=bo(u)}function bo(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function mo(t){const n={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t){if(n[r]===undefined){n[r]=t[r]}}return n}function go(t){if(typeof t.timestamp==="function"){return t.timestamp}if(t.timestamp===false){return So}return Io}function _o(){return{}}function Eo(t){return t}function Oo(){}function So(){return false}function Io(){return Date.now()}function jo(){return Math.round(Date.now()/1e3)}function Ao(){return new Date(Date.now()).toISOString()}function No(){function t(t){return typeof t!=="undefined"&&t}try{if(typeof globalThis!=="undefined")return globalThis;Object.defineProperty(Object.prototype,"globalThis",{get:function(){delete Object.prototype.globalThis;return this.globalThis=this},configurable:true});return globalThis}catch(n){return t(self)||t(window)||t(this)||{}}}var Po=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.PINO_CUSTOM_CONTEXT_KEY=n.PINO_LOGGER_DEFAULTS=void 0;n.PINO_LOGGER_DEFAULTS={level:"info"};n.PINO_CUSTOM_CONTEXT_KEY="custom_context"}));var xo=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.generateChildLogger=n.formatChildLoggerContext=n.getLoggerContext=n.setBrowserLoggerContext=n.getBrowserLoggerContext=n.getDefaultLoggerOptions=void 0;function r(t){return Object.assign(Object.assign({},t),{level:(t===null||t===void 0?void 0:t.level)||Po.PINO_LOGGER_DEFAULTS.level})}n.getDefaultLoggerOptions=r;function e(t,n=Po.PINO_CUSTOM_CONTEXT_KEY){return t[n]||""}n.getBrowserLoggerContext=e;function i(t,n,r=Po.PINO_CUSTOM_CONTEXT_KEY){t[r]=n;return t}n.setBrowserLoggerContext=i;function s(t,n=Po.PINO_CUSTOM_CONTEXT_KEY){let r="";if(typeof t.bindings==="undefined"){r=e(t,n)}else{r=t.bindings().context||""}return r}n.getLoggerContext=s;function o(t,n,r=Po.PINO_CUSTOM_CONTEXT_KEY){const e=s(t,r);const i=e.trim()?`${e}/${n}`:n;return i}n.formatChildLoggerContext=o;function a(t,n,r=Po.PINO_CUSTOM_CONTEXT_KEY){const e=o(t,n,r);const s=t.child({context:e});return i(s,e,r)}n.generateChildLogger=a}));const $o=s(ro);var To=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.pino=void 0;const r=$o.__importDefault(oo);Object.defineProperty(n,"pino",{enumerable:true,get:function(){return r.default}});$o.__exportStar(Po,n);$o.__exportStar(xo,n)}));class Mo extends Es{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Co extends Es{constructor(t,n){super(),this.core=t,this.logger=n,this.records=new Map}}class Ro{constructor(t,n){this.logger=t,this.core=n}}class Uo extends Es{constructor(t,n){super(),this.relayer=t,this.logger=n}}class Do extends Es{constructor(t){super()}}class ko{constructor(t,n,r,e){this.core=t,this.logger=n,this.name=r}}class Lo extends Es{constructor(t,n){super(),this.relayer=t,this.logger=n}}class qo extends Es{constructor(t,n){super(),this.core=t,this.logger=n}}class Vo{constructor(t,n){this.projectId=t,this.logger=n}}const Fo=t=>JSON.stringify(t,((t,n)=>typeof n==="bigint"?n.toString()+"n":n));const Go=t=>{const n=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g;const r=t.replace(n,'$1"$2n"$3');return JSON.parse(r,((t,n)=>{const r=typeof n==="string"&&n.match(/^\d+n$/);if(r)return BigInt(n.substring(0,n.length-1));return n}))};function Ho(t){if(typeof t!=="string"){throw new Error(`Cannot safe json parse value of type ${typeof t}`)}try{return Go(t)}catch(n){return t}}function zo(t){return typeof t==="string"?t:Fo(t)||""}var Wo=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.DIGEST_LENGTH=64;n.BLOCK_SIZE=128;var r=function(){function t(){this.digestLength=n.DIGEST_LENGTH;this.blockSize=n.BLOCK_SIZE;this._stateHi=new Int32Array(8);this._stateLo=new Int32Array(8);this._tempHi=new Int32Array(16);this._tempLo=new Int32Array(16);this._buffer=new Uint8Array(256);this._bufferLength=0;this._bytesHashed=0;this._finished=false;this.reset()}t.prototype._initState=function(){this._stateHi[0]=1779033703;this._stateHi[1]=3144134277;this._stateHi[2]=1013904242;this._stateHi[3]=2773480762;this._stateHi[4]=1359893119;this._stateHi[5]=2600822924;this._stateHi[6]=528734635;this._stateHi[7]=1541459225;this._stateLo[0]=4089235720;this._stateLo[1]=2227873595;this._stateLo[2]=4271175723;this._stateLo[3]=1595750129;this._stateLo[4]=2917565137;this._stateLo[5]=725511199;this._stateLo[6]=4215389547;this._stateLo[7]=327033209};t.prototype.reset=function(){this._initState();this._bufferLength=0;this._bytesHashed=0;this._finished=false;return this};t.prototype.clean=function(){f.wipe(this._buffer);f.wipe(this._tempHi);f.wipe(this._tempLo);this.reset()};t.prototype.update=function(t,r){if(r===void 0){r=t.length}if(this._finished){throw new Error("SHA512: can't update because hash was finished.")}var e=0;this._bytesHashed+=r;if(this._bufferLength>0){while(this._bufferLength<n.BLOCK_SIZE&&r>0){this._buffer[this._bufferLength++]=t[e++];r--}if(this._bufferLength===this.blockSize){i(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize);this._bufferLength=0}}if(r>=this.blockSize){e=i(this._tempHi,this._tempLo,this._stateHi,this._stateLo,t,e,r);r%=this.blockSize}while(r>0){this._buffer[this._bufferLength++]=t[e++];r--}return this};t.prototype.finish=function(t){if(!this._finished){var n=this._bytesHashed;var r=this._bufferLength;var e=n/536870912|0;var s=n<<3;var o=n%128<112?128:256;this._buffer[r]=128;for(var a=r+1;a<o-8;a++){this._buffer[a]=0}h.writeUint32BE(e,this._buffer,o-8);h.writeUint32BE(s,this._buffer,o-4);i(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,o);this._finished=true}for(var a=0;a<this.digestLength/8;a++){h.writeUint32BE(this._stateHi[a],t,a*8);h.writeUint32BE(this._stateLo[a],t,a*8+4)}return this};t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);this.finish(t);return t};t.prototype.saveState=function(){if(this._finished){throw new Error("SHA256: cannot save finished state")}return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):undefined,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}};t.prototype.restoreState=function(t){this._stateHi.set(t.stateHi);this._stateLo.set(t.stateLo);this._bufferLength=t.bufferLength;if(t.buffer){this._buffer.set(t.buffer)}this._bytesHashed=t.bytesHashed;this._finished=false;return this};t.prototype.cleanSavedState=function(t){f.wipe(t.stateHi);f.wipe(t.stateLo);if(t.buffer){f.wipe(t.buffer)}t.bufferLength=0;t.bytesHashed=0};return t}();n.SHA512=r;var e=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function i(t,n,r,i,s,o,a){var u=r[0],c=r[1],f=r[2],l=r[3],d=r[4],p=r[5],v=r[6],w=r[7],y=i[0],b=i[1],m=i[2],g=i[3],_=i[4],E=i[5],O=i[6],S=i[7];var I,j;var A,N;var P,x,$,T;while(a>=128){for(var M=0;M<16;M++){var C=8*M+o;t[M]=h.readUint32BE(s,C);n[M]=h.readUint32BE(s,C+4)}for(var M=0;M<80;M++){var R=u;var U=c;var D=f;var k=l;var L=d;var q=p;var V=v;var F=w;var G=y;var H=b;var z=m;var W=g;var B=_;var K=E;var J=O;var Z=S;I=w;j=S;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=(d>>>14|_<<32-14)^(d>>>18|_<<32-18)^(_>>>41-32|d<<32-(41-32));j=(_>>>14|d<<32-14)^(_>>>18|d<<32-18)^(d>>>41-32|_<<32-(41-32));P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;I=d&p^~d&v;j=_&E^~_&O;P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;I=e[M*2];j=e[M*2+1];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;I=t[M%16];j=n[M%16];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;A=$&65535|T<<16;N=P&65535|x<<16;I=A;j=N;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=(u>>>28|y<<32-28)^(y>>>34-32|u<<32-(34-32))^(y>>>39-32|u<<32-(39-32));j=(y>>>28|u<<32-28)^(u>>>34-32|y<<32-(34-32))^(u>>>39-32|y<<32-(39-32));P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;I=u&c^u&f^c&f;j=y&b^y&m^b&m;P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;F=$&65535|T<<16;Z=P&65535|x<<16;I=k;j=W;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=A;j=N;P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;k=$&65535|T<<16;W=P&65535|x<<16;c=R;f=U;l=D;d=k;p=L;v=q;w=V;u=F;b=G;m=H;g=z;_=W;E=B;O=K;S=J;y=Z;if(M%16===15){for(var C=0;C<16;C++){I=t[C];j=n[C];P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=t[(C+9)%16];j=n[(C+9)%16];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;A=t[(C+1)%16];N=n[(C+1)%16];I=(A>>>1|N<<32-1)^(A>>>8|N<<32-8)^A>>>7;j=(N>>>1|A<<32-1)^(N>>>8|A<<32-8)^(N>>>7|A<<32-7);P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;A=t[(C+14)%16];N=n[(C+14)%16];I=(A>>>19|N<<32-19)^(N>>>61-32|A<<32-(61-32))^A>>>6;j=(N>>>19|A<<32-19)^(A>>>61-32|N<<32-(61-32))^(N>>>6|A<<32-6);P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;t[C]=$&65535|T<<16;n[C]=P&65535|x<<16}}}I=u;j=y;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[0];j=i[0];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[0]=u=$&65535|T<<16;i[0]=y=P&65535|x<<16;I=c;j=b;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[1];j=i[1];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[1]=c=$&65535|T<<16;i[1]=b=P&65535|x<<16;I=f;j=m;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[2];j=i[2];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[2]=f=$&65535|T<<16;i[2]=m=P&65535|x<<16;I=l;j=g;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[3];j=i[3];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[3]=l=$&65535|T<<16;i[3]=g=P&65535|x<<16;I=d;j=_;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[4];j=i[4];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[4]=d=$&65535|T<<16;i[4]=_=P&65535|x<<16;I=p;j=E;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[5];j=i[5];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[5]=p=$&65535|T<<16;i[5]=E=P&65535|x<<16;I=v;j=O;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[6];j=i[6];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[6]=v=$&65535|T<<16;i[6]=O=P&65535|x<<16;I=w;j=S;P=j&65535;x=j>>>16;$=I&65535;T=I>>>16;I=r[7];j=i[7];P+=j&65535;x+=j>>>16;$+=I&65535;T+=I>>>16;x+=P>>>16;$+=x>>>16;T+=$>>>16;r[7]=w=$&65535|T<<16;i[7]=S=P&65535|x<<16;o+=128;a-=128}return o}function s(t){var n=new r;n.update(t);var e=n.digest();n.clean();return e}n.hash=s}));var Bo=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;n.SIGNATURE_LENGTH=64;n.PUBLIC_KEY_LENGTH=32;n.SECRET_KEY_LENGTH=64;n.SEED_LENGTH=32;function r(t){const n=new Float64Array(16);if(t){for(let r=0;r<t.length;r++){n[r]=t[r]}}return n}const e=new Uint8Array(32);e[0]=9;const i=r();const s=r([1]);const o=r([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]);const a=r([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]);const u=r([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]);const c=r([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);const h=r([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function l(t,n){for(let r=0;r<16;r++){t[r]=n[r]|0}}function d(t){let n=1;for(let r=0;r<16;r++){let e=t[r]+n+65535;n=Math.floor(e/65536);t[r]=e-n*65536}t[0]+=n-1+37*(n-1)}function p(t,n,r){const e=~(r-1);for(let r=0;r<16;r++){const i=e&(t[r]^n[r]);t[r]^=i;n[r]^=i}}function v(t,n){const e=r();const i=r();for(let t=0;t<16;t++){i[t]=n[t]}d(i);d(i);d(i);for(let t=0;t<2;t++){e[0]=i[0]-65517;for(let t=1;t<15;t++){e[t]=i[t]-65535-(e[t-1]>>16&1);e[t-1]&=65535}e[15]=i[15]-32767-(e[14]>>16&1);const t=e[15]>>16&1;e[14]&=65535;p(i,e,1-t)}for(let n=0;n<16;n++){t[2*n]=i[n]&255;t[2*n+1]=i[n]>>8}}function w(t,n){let r=0;for(let e=0;e<32;e++){r|=t[e]^n[e]}return(1&r-1>>>8)-1}function y(t,n){const r=new Uint8Array(32);const e=new Uint8Array(32);v(r,t);v(e,n);return w(r,e)}function b(t){const n=new Uint8Array(32);v(n,t);return n[0]&1}function m(t,n){for(let r=0;r<16;r++){t[r]=n[2*r]+(n[2*r+1]<<8)}t[15]&=32767}function g(t,n,r){for(let e=0;e<16;e++){t[e]=n[e]+r[e]}}function _(t,n,r){for(let e=0;e<16;e++){t[e]=n[e]-r[e]}}function O(t,n,r){let e,i,s=0,o=0,a=0,u=0,c=0,h=0,f=0,l=0,d=0,p=0,v=0,w=0,y=0,b=0,m=0,g=0,_=0,E=0,O=0,S=0,I=0,j=0,A=0,N=0,P=0,x=0,$=0,T=0,M=0,C=0,R=0,U=r[0],D=r[1],k=r[2],L=r[3],q=r[4],V=r[5],F=r[6],G=r[7],H=r[8],z=r[9],W=r[10],B=r[11],K=r[12],J=r[13],Z=r[14],Q=r[15];e=n[0];s+=e*U;o+=e*D;a+=e*k;u+=e*L;c+=e*q;h+=e*V;f+=e*F;l+=e*G;d+=e*H;p+=e*z;v+=e*W;w+=e*B;y+=e*K;b+=e*J;m+=e*Z;g+=e*Q;e=n[1];o+=e*U;a+=e*D;u+=e*k;c+=e*L;h+=e*q;f+=e*V;l+=e*F;d+=e*G;p+=e*H;v+=e*z;w+=e*W;y+=e*B;b+=e*K;m+=e*J;g+=e*Z;_+=e*Q;e=n[2];a+=e*U;u+=e*D;c+=e*k;h+=e*L;f+=e*q;l+=e*V;d+=e*F;p+=e*G;v+=e*H;w+=e*z;y+=e*W;b+=e*B;m+=e*K;g+=e*J;_+=e*Z;E+=e*Q;e=n[3];u+=e*U;c+=e*D;h+=e*k;f+=e*L;l+=e*q;d+=e*V;p+=e*F;v+=e*G;w+=e*H;y+=e*z;b+=e*W;m+=e*B;g+=e*K;_+=e*J;E+=e*Z;O+=e*Q;e=n[4];c+=e*U;h+=e*D;f+=e*k;l+=e*L;d+=e*q;p+=e*V;v+=e*F;w+=e*G;y+=e*H;b+=e*z;m+=e*W;g+=e*B;_+=e*K;E+=e*J;O+=e*Z;S+=e*Q;e=n[5];h+=e*U;f+=e*D;l+=e*k;d+=e*L;p+=e*q;v+=e*V;w+=e*F;y+=e*G;b+=e*H;m+=e*z;g+=e*W;_+=e*B;E+=e*K;O+=e*J;S+=e*Z;I+=e*Q;e=n[6];f+=e*U;l+=e*D;d+=e*k;p+=e*L;v+=e*q;w+=e*V;y+=e*F;b+=e*G;m+=e*H;g+=e*z;_+=e*W;E+=e*B;O+=e*K;S+=e*J;I+=e*Z;j+=e*Q;e=n[7];l+=e*U;d+=e*D;p+=e*k;v+=e*L;w+=e*q;y+=e*V;b+=e*F;m+=e*G;g+=e*H;_+=e*z;E+=e*W;O+=e*B;S+=e*K;I+=e*J;j+=e*Z;A+=e*Q;e=n[8];d+=e*U;p+=e*D;v+=e*k;w+=e*L;y+=e*q;b+=e*V;m+=e*F;g+=e*G;_+=e*H;E+=e*z;O+=e*W;S+=e*B;I+=e*K;j+=e*J;A+=e*Z;N+=e*Q;e=n[9];p+=e*U;v+=e*D;w+=e*k;y+=e*L;b+=e*q;m+=e*V;g+=e*F;_+=e*G;E+=e*H;O+=e*z;S+=e*W;I+=e*B;j+=e*K;A+=e*J;N+=e*Z;P+=e*Q;e=n[10];v+=e*U;w+=e*D;y+=e*k;b+=e*L;m+=e*q;g+=e*V;_+=e*F;E+=e*G;O+=e*H;S+=e*z;I+=e*W;j+=e*B;A+=e*K;N+=e*J;P+=e*Z;x+=e*Q;e=n[11];w+=e*U;y+=e*D;b+=e*k;m+=e*L;g+=e*q;_+=e*V;E+=e*F;O+=e*G;S+=e*H;I+=e*z;j+=e*W;A+=e*B;N+=e*K;P+=e*J;x+=e*Z;$+=e*Q;e=n[12];y+=e*U;b+=e*D;m+=e*k;g+=e*L;_+=e*q;E+=e*V;O+=e*F;S+=e*G;I+=e*H;j+=e*z;A+=e*W;N+=e*B;P+=e*K;x+=e*J;$+=e*Z;T+=e*Q;e=n[13];b+=e*U;m+=e*D;g+=e*k;_+=e*L;E+=e*q;O+=e*V;S+=e*F;I+=e*G;j+=e*H;A+=e*z;N+=e*W;P+=e*B;x+=e*K;$+=e*J;T+=e*Z;M+=e*Q;e=n[14];m+=e*U;g+=e*D;_+=e*k;E+=e*L;O+=e*q;S+=e*V;I+=e*F;j+=e*G;A+=e*H;N+=e*z;P+=e*W;x+=e*B;$+=e*K;T+=e*J;M+=e*Z;C+=e*Q;e=n[15];g+=e*U;_+=e*D;E+=e*k;O+=e*L;S+=e*q;I+=e*V;j+=e*F;A+=e*G;N+=e*H;P+=e*z;x+=e*W;$+=e*B;T+=e*K;M+=e*J;C+=e*Z;R+=e*Q;s+=38*_;o+=38*E;a+=38*O;u+=38*S;c+=38*I;h+=38*j;f+=38*A;l+=38*N;d+=38*P;p+=38*x;v+=38*$;w+=38*T;y+=38*M;b+=38*C;m+=38*R;i=1;e=s+i+65535;i=Math.floor(e/65536);s=e-i*65536;e=o+i+65535;i=Math.floor(e/65536);o=e-i*65536;e=a+i+65535;i=Math.floor(e/65536);a=e-i*65536;e=u+i+65535;i=Math.floor(e/65536);u=e-i*65536;e=c+i+65535;i=Math.floor(e/65536);c=e-i*65536;e=h+i+65535;i=Math.floor(e/65536);h=e-i*65536;e=f+i+65535;i=Math.floor(e/65536);f=e-i*65536;e=l+i+65535;i=Math.floor(e/65536);l=e-i*65536;e=d+i+65535;i=Math.floor(e/65536);d=e-i*65536;e=p+i+65535;i=Math.floor(e/65536);p=e-i*65536;e=v+i+65535;i=Math.floor(e/65536);v=e-i*65536;e=w+i+65535;i=Math.floor(e/65536);w=e-i*65536;e=y+i+65535;i=Math.floor(e/65536);y=e-i*65536;e=b+i+65535;i=Math.floor(e/65536);b=e-i*65536;e=m+i+65535;i=Math.floor(e/65536);m=e-i*65536;e=g+i+65535;i=Math.floor(e/65536);g=e-i*65536;s+=i-1+37*(i-1);i=1;e=s+i+65535;i=Math.floor(e/65536);s=e-i*65536;e=o+i+65535;i=Math.floor(e/65536);o=e-i*65536;e=a+i+65535;i=Math.floor(e/65536);a=e-i*65536;e=u+i+65535;i=Math.floor(e/65536);u=e-i*65536;e=c+i+65535;i=Math.floor(e/65536);c=e-i*65536;e=h+i+65535;i=Math.floor(e/65536);h=e-i*65536;e=f+i+65535;i=Math.floor(e/65536);f=e-i*65536;e=l+i+65535;i=Math.floor(e/65536);l=e-i*65536;e=d+i+65535;i=Math.floor(e/65536);d=e-i*65536;e=p+i+65535;i=Math.floor(e/65536);p=e-i*65536;e=v+i+65535;i=Math.floor(e/65536);v=e-i*65536;e=w+i+65535;i=Math.floor(e/65536);w=e-i*65536;e=y+i+65535;i=Math.floor(e/65536);y=e-i*65536;e=b+i+65535;i=Math.floor(e/65536);b=e-i*65536;e=m+i+65535;i=Math.floor(e/65536);m=e-i*65536;e=g+i+65535;i=Math.floor(e/65536);g=e-i*65536;s+=i-1+37*(i-1);t[0]=s;t[1]=o;t[2]=a;t[3]=u;t[4]=c;t[5]=h;t[6]=f;t[7]=l;t[8]=d;t[9]=p;t[10]=v;t[11]=w;t[12]=y;t[13]=b;t[14]=m;t[15]=g}function S(t,n){O(t,n,n)}function I(t,n){const e=r();let i;for(i=0;i<16;i++){e[i]=n[i]}for(i=253;i>=0;i--){S(e,e);if(i!==2&&i!==4){O(e,e,n)}}for(i=0;i<16;i++){t[i]=e[i]}}function j(t,n){const e=r();let i;for(i=0;i<16;i++){e[i]=n[i]}for(i=250;i>=0;i--){S(e,e);if(i!==1){O(e,e,n)}}for(i=0;i<16;i++){t[i]=e[i]}}function A(t,n){const e=r(),i=r(),s=r(),o=r(),u=r(),c=r(),h=r(),f=r(),l=r();_(e,t[1],t[0]);_(l,n[1],n[0]);O(e,e,l);g(i,t[0],t[1]);g(l,n[0],n[1]);O(i,i,l);O(s,t[3],n[3]);O(s,s,a);O(o,t[2],n[2]);g(o,o,o);_(u,i,e);_(c,o,s);g(h,o,s);g(f,i,e);O(t[0],u,c);O(t[1],f,h);O(t[2],h,c);O(t[3],u,f)}function N(t,n,r){for(let e=0;e<4;e++){p(t[e],n[e],r)}}function P(t,n){const e=r(),i=r(),s=r();I(s,n[2]);O(e,n[0],s);O(i,n[1],s);v(t,i);t[31]^=b(e)<<7}function x(t,n,r){l(t[0],i);l(t[1],s);l(t[2],s);l(t[3],i);for(let e=255;e>=0;--e){const i=r[e/8|0]>>(e&7)&1;N(t,n,i);A(n,t);A(t,t);N(t,n,i)}}function $(t,n){const e=[r(),r(),r(),r()];l(e[0],u);l(e[1],c);l(e[2],s);O(e[3],u,c);x(t,e,n)}function T(t){if(t.length!==n.SEED_LENGTH){throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`)}const e=(0,Wo.hash)(t);e[0]&=248;e[31]&=127;e[31]|=64;const i=new Uint8Array(32);const s=[r(),r(),r(),r()];$(s,e);P(i,s);const o=new Uint8Array(64);o.set(t);o.set(i,32);return{publicKey:i,secretKey:o}}n.generateKeyPairFromSeed=T;function M(t){const n=(0,E.randomBytes)(32,t);const r=T(n);(0,f.wipe)(n);return r}n.generateKeyPair=M;function C(t){if(t.length!==n.SECRET_KEY_LENGTH){throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`)}return new Uint8Array(t.subarray(32))}n.extractPublicKeyFromSecretKey=C;const R=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function U(t,n){let r;let e;let i;let s;for(e=63;e>=32;--e){r=0;for(i=e-32,s=e-12;i<s;++i){n[i]+=r-16*n[e]*R[i-(e-32)];r=Math.floor((n[i]+128)/256);n[i]-=r*256}n[i]+=r;n[e]=0}r=0;for(i=0;i<32;i++){n[i]+=r-(n[31]>>4)*R[i];r=n[i]>>8;n[i]&=255}for(i=0;i<32;i++){n[i]-=r*R[i]}for(e=0;e<32;e++){n[e+1]+=n[e]>>8;t[e]=n[e]&255}}function D(t){const n=new Float64Array(64);for(let r=0;r<64;r++){n[r]=t[r]}for(let n=0;n<64;n++){t[n]=0}U(t,n)}function k(t,n){const e=new Float64Array(64);const i=[r(),r(),r(),r()];const s=(0,Wo.hash)(t.subarray(0,32));s[0]&=248;s[31]&=127;s[31]|=64;const o=new Uint8Array(64);o.set(s.subarray(32),32);const a=new Wo.SHA512;a.update(o.subarray(32));a.update(n);const u=a.digest();a.clean();D(u);$(i,u);P(o,i);a.reset();a.update(o.subarray(0,32));a.update(t.subarray(32));a.update(n);const c=a.digest();D(c);for(let t=0;t<32;t++){e[t]=u[t]}for(let t=0;t<32;t++){for(let n=0;n<32;n++){e[t+n]+=c[t]*s[n]}}U(o.subarray(32),e);return o}n.sign=k;function L(t,n){const e=r(),a=r(),u=r(),c=r(),f=r(),d=r(),p=r();l(t[2],s);m(t[1],n);S(u,t[1]);O(c,u,o);_(u,u,t[2]);g(c,t[2],c);S(f,c);S(d,f);O(p,d,f);O(e,p,u);O(e,e,c);j(e,e);O(e,e,u);O(e,e,c);O(e,e,c);O(t[0],e,c);S(a,t[0]);O(a,a,c);if(y(a,u)){O(t[0],t[0],h)}S(a,t[0]);O(a,a,c);if(y(a,u)){return-1}if(b(t[0])===n[31]>>7){_(t[0],i,t[0])}O(t[3],t[0],t[1]);return 0}function q(t,e,i){const s=new Uint8Array(32);const o=[r(),r(),r(),r()];const a=[r(),r(),r(),r()];if(i.length!==n.SIGNATURE_LENGTH){throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`)}if(L(a,t)){return false}const u=new Wo.SHA512;u.update(i.subarray(0,32));u.update(t);u.update(e);const c=u.digest();D(c);x(o,a,c);$(a,i.subarray(32));A(o,a);P(s,o);if(w(i,s)){return false}return true}n.verify=q;function V(t){let n=[r(),r(),r(),r()];if(L(n,t)){throw new Error("Ed25519: invalid public key")}let e=r();let i=r();let o=n[1];g(e,s,o);_(i,s,o);I(i,i);O(e,e,i);let a=new Uint8Array(32);v(a,e);return a}n.convertPublicKeyToX25519=V;function F(t){const n=(0,Wo.hash)(t.subarray(0,32));n[0]&=248;n[31]&=127;n[31]|=64;const r=new Uint8Array(n.subarray(0,32));(0,f.wipe)(n);return r}n.convertSecretKeyToX25519=F}));const Ko="EdDSA";const Jo="JWT";const Zo=".";const Qo="base64url";const Xo="utf8";const Yo="utf8";const ta=":";const na="did";const ra="key";const ea="base58btc";const ia="z";const sa="K36";const oa=32;var aa=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){if(globalThis.Buffer!=null){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}return t}n.asUint8Array=r}));var ua=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null){return aa.asUint8Array(globalThis.Buffer.alloc(t))}return new Uint8Array(t)}function e(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null){return aa.asUint8Array(globalThis.Buffer.allocUnsafe(t))}return new Uint8Array(t)}n.alloc=r;n.allocUnsafe=e}));var ca=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(!n){n=t.reduce(((t,n)=>t+n.length),0)}const r=ua.allocUnsafe(n);let e=0;for(const n of t){r.set(n,e);e+=n.length}return aa.asUint8Array(r)}n.concat=r}));function ha(t,n,r,e){return{name:t,prefix:n,encoder:{name:t,prefix:n,encode:r},decoder:{decode:e}}}const fa=ha("utf8","u",(t=>{const n=new TextDecoder("utf8");return"u"+n.decode(t)}),(t=>{const n=new TextEncoder;return n.encode(t.substring(1))}));const la=ha("ascii","a",(t=>{let n="a";for(let r=0;r<t.length;r++){n+=String.fromCharCode(t[r])}return n}),(t=>{t=t.substring(1);const n=ua.allocUnsafe(t.length);for(let r=0;r<t.length;r++){n[r]=t.charCodeAt(r)}return n}));const da={utf8:fa,"utf-8":fa,hex:St.bases.base16,latin1:la,ascii:la,binary:la,...St.bases};var pa=da;var va=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=pa[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8")}return r.encoder.encode(t).substring(1)}n.toString=r}));var wa=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=pa[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return aa.asUint8Array(globalThis.Buffer.from(t,"utf-8"))}return r.decoder.decode(`${r.prefix}${t}`)}n.fromString=r}));const ya=t=>JSON.stringify(t,((t,n)=>typeof n==="bigint"?n.toString()+"n":n));function ba(t){return typeof t==="string"?t:ya(t)||""}function ma(t){return va.toString(wa.fromString(ba(t),Xo),Qo)}function ga(t){const n=wa.fromString(sa,ea);const r=ia+va.toString(ca.concat([n,t]),ea);return[na,ra,r].join(ta)}function _a(t){return va.toString(t,Qo)}function Ea(t){return wa.fromString([ma(t.header),ma(t.payload)].join(Zo),Yo)}function Oa(t){return[ma(t.header),ma(t.payload),_a(t.signature)].join(Zo)}function Sa(t=E.randomBytes(oa)){return Bo.generateKeyPairFromSeed(t)}async function Ia(t,n,r,e,i=Mn.fromMiliseconds(Date.now())){const s={alg:Ko,typ:Jo};const o=ga(e.publicKey);const a=i+r;const u={iss:o,sub:t,aud:n,iat:i,exp:a};const c=Ea({header:s,payload:u});const h=Bo.sign(e.secretKey,c);return Oa({header:s,payload:u,signature:h})}var ja=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){for(let r=0;r<t.byteLength;r++){if(t[r]<n[r]){return-1}if(t[r]>n[r]){return 1}}if(t.byteLength>n.byteLength){return 1}if(t.byteLength<n.byteLength){return-1}return 0}n.compare=r}));var Aa=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t){if(globalThis.Buffer!=null){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}return t}n.asUint8Array=r}));var Na=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.alloc!=null){return Aa.asUint8Array(globalThis.Buffer.alloc(t))}return new Uint8Array(t)}function e(t=0){if(globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null){return Aa.asUint8Array(globalThis.Buffer.allocUnsafe(t))}return new Uint8Array(t)}n.alloc=r;n.allocUnsafe=e}));var Pa=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(!n){n=t.reduce(((t,n)=>t+n.length),0)}const r=Na.allocUnsafe(n);let e=0;for(const n of t){r.set(n,e);e+=n.length}return Aa.asUint8Array(r)}n.concat=r}));var xa=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(t===n){return true}if(t.byteLength!==n.byteLength){return false}for(let r=0;r<t.byteLength;r++){if(t[r]!==n[r]){return false}}return true}n.equals=r}));function $a(t,n,r,e){return{name:t,prefix:n,encoder:{name:t,prefix:n,encode:r},decoder:{decode:e}}}const Ta=$a("utf8","u",(t=>{const n=new TextDecoder("utf8");return"u"+n.decode(t)}),(t=>{const n=new TextEncoder;return n.encode(t.substring(1))}));const Ma=$a("ascii","a",(t=>{let n="a";for(let r=0;r<t.length;r++){n+=String.fromCharCode(t[r])}return n}),(t=>{t=t.substring(1);const n=Na.allocUnsafe(t.length);for(let r=0;r<t.length;r++){n[r]=t.charCodeAt(r)}return n}));const Ca={utf8:Ta,"utf-8":Ta,hex:St.bases.base16,latin1:Ma,ascii:Ma,binary:Ma,...St.bases};var Ra=Ca;var Ua=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=Ra[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return Aa.asUint8Array(globalThis.Buffer.from(t,"utf-8"))}return r.decoder.decode(`${r.prefix}${t}`)}n.fromString=r}));var Da=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n="utf8"){const r=Ra[n];if(!r){throw new Error(`Unsupported encoding "${n}"`)}if((n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null){return globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8")}return r.encoder.encode(t).substring(1)}n.toString=r}));var ka=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});function r(t,n){if(t.length!==n.length){throw new Error("Inputs should have the same length")}const r=Na.allocUnsafe(t.length);for(let e=0;e<t.length;e++){r[e]=t[e]^n[e]}return Aa.asUint8Array(r)}n.xor=r}));var La=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.compare=ja.compare;n.concat=Pa.concat;n.equals=xa.equals;n.fromString=Ua.fromString;n.toString=Da.toString;n.xor=ka.xor}));const qa="PARSE_ERROR";const Va="INVALID_REQUEST";const Fa="METHOD_NOT_FOUND";const Ga="INVALID_PARAMS";const Ha="INTERNAL_ERROR";const za="SERVER_ERROR";const Wa=[-32700,-32600,-32601,-32602,-32603];const Ba={[qa]:{code:-32700,message:"Parse error"},[Va]:{code:-32600,message:"Invalid Request"},[Fa]:{code:-32601,message:"Method not found"},[Ga]:{code:-32602,message:"Invalid params"},[Ha]:{code:-32603,message:"Internal error"},[za]:{code:-32e3,message:"Server error"}};const Ka=za;function Ja(t){return Wa.includes(t)}function Za(t){if(!Object.keys(Ba).includes(t)){return Ba[Ka]}return Ba[t]}function Qa(t){const n=Object.values(Ba).find((n=>n.code===t));if(!n){return Ba[Ka]}return n}function Xa(t,n,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${n}`):t}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ya=function(t,n){Ya=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)if(n.hasOwnProperty(r))t[r]=n[r]};return Ya(t,n)};function tu(t,n){Ya(t,n);function r(){this.constructor=t}t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}var nu=function(){nu=Object.assign||function t(n){for(var r,e=1,i=arguments.length;e<i;e++){r=arguments[e];for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s))n[s]=r[s]}return n};return nu.apply(this,arguments)};function ru(t,n){var r={};for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&n.indexOf(e)<0)r[e]=t[e];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,e=Object.getOwnPropertySymbols(t);i<e.length;i++){if(n.indexOf(e[i])<0&&Object.prototype.propertyIsEnumerable.call(t,e[i]))r[e[i]]=t[e[i]]}return r}function eu(t,n,r,e){var i=arguments.length,s=i<3?n:e===null?e=Object.getOwnPropertyDescriptor(n,r):e,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")s=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)if(o=t[a])s=(i<3?o(s):i>3?o(n,r,s):o(n,r))||s;return i>3&&s&&Object.defineProperty(n,r,s),s}function iu(t,n){return function(r,e){n(r,e,t)}}function su(t,n){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(t,n)}function ou(t,n,r,e){function i(t){return t instanceof r?t:new r((function(n){n(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{u(e.next(t))}catch(t){s(t)}}function a(t){try{u(e["throw"](t))}catch(t){s(t)}}function u(t){t.done?r(t.value):i(t.value).then(o,a)}u((e=e.apply(t,n||[])).next())}))}function au(t,n){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},e,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(n){return u([t,n])}}function u(o){if(e)throw new TypeError("Generator is already executing.");while(r)try{if(e=1,i&&(s=o[0]&2?i["return"]:o[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,o[1])).done)return s;if(i=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;i=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=n.call(t,r)}catch(t){o=[6,t];i=0}finally{e=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}}function uu(t,n,r,e){if(e===undefined)e=r;t[e]=n[r]}function cu(t,n){for(var r in t)if(r!=="default"&&!n.hasOwnProperty(r))n[r]=t[r]}function hu(t){var n=typeof Symbol==="function"&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&e>=t.length)t=void 0;return{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function fu(t,n){var r=typeof Symbol==="function"&&t[Symbol.iterator];if(!r)return t;var e=r.call(t),i,s=[],o;try{while((n===void 0||n-- >0)&&!(i=e.next()).done)s.push(i.value)}catch(t){o={error:t}}finally{try{if(i&&!i.done&&(r=e["return"]))r.call(e)}finally{if(o)throw o.error}}return s}function lu(){for(var t=[],n=0;n<arguments.length;n++)t=t.concat(fu(arguments[n]));return t}function du(){for(var t=0,n=0,r=arguments.length;n<r;n++)t+=arguments[n].length;for(var e=Array(t),i=0,n=0;n<r;n++)for(var s=arguments[n],o=0,a=s.length;o<a;o++,i++)e[i]=s[o];return e}function pu(t){return this instanceof pu?(this.v=t,this):new pu(t)}function vu(t,n,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r.apply(t,n||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(t){if(e[t])i[t]=function(n){return new Promise((function(r,e){s.push([t,n,r,e])>1||a(t,n)}))}}function a(t,n){try{u(e[t](n))}catch(t){f(s[0][3],t)}}function u(t){t.value instanceof pu?Promise.resolve(t.value.v).then(c,h):f(s[0][2],t)}function c(t){a("next",t)}function h(t){a("throw",t)}function f(t,n){if(t(n),s.shift(),s.length)a(s[0][0],s[0][1])}}function wu(t){var n,r;return n={},e("next"),e("throw",(function(t){throw t})),e("return"),n[Symbol.iterator]=function(){return this},n;function e(e,i){n[e]=t[e]?function(n){return(r=!r)?{value:pu(t[e](n)),done:e==="return"}:i?i(n):n}:i}}function yu(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t[Symbol.asyncIterator],r;return n?n.call(t):(t=typeof hu==="function"?hu(t):t[Symbol.iterator](),r={},e("next"),e("throw"),e("return"),r[Symbol.asyncIterator]=function(){return this},r);function e(n){r[n]=t[n]&&function(r){return new Promise((function(e,s){r=t[n](r),i(e,s,r.done,r.value)}))}}function i(t,n,r,e){Promise.resolve(e).then((function(n){t({value:n,done:r})}),n)}}function bu(t,n){if(Object.defineProperty){Object.defineProperty(t,"raw",{value:n})}else{t.raw=n}return t}function mu(t){if(t&&t.__esModule)return t;var n={};if(t!=null)for(var r in t)if(Object.hasOwnProperty.call(t,r))n[r]=t[r];n.default=t;return n}function gu(t){return t&&t.__esModule?t:{default:t}}function _u(t,n){if(!n.has(t)){throw new TypeError("attempted to get private field on non-instance")}return n.get(t)}function Eu(t,n,r){if(!n.has(t)){throw new TypeError("attempted to set private field on non-instance")}n.set(t,r);return r}const Ou=Object.freeze({__proto__:null,__extends:tu,get __assign(){return nu},__rest:ru,__decorate:eu,__param:iu,__metadata:su,__awaiter:ou,__generator:au,__createBinding:uu,__exportStar:cu,__values:hu,__read:fu,__spread:lu,__spreadArrays:du,__await:pu,__asyncGenerator:vu,__asyncDelegator:wu,__asyncValues:yu,__makeTemplateObject:bu,__importStar:mu,__importDefault:gu,__classPrivateFieldGet:_u,__classPrivateFieldSet:Eu});var Su=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.isBrowserCryptoAvailable=n.getSubtleCrypto=n.getBrowerCrypto=void 0;function r(){return(a===null||a===void 0?void 0:a.crypto)||(a===null||a===void 0?void 0:a.msCrypto)||{}}n.getBrowerCrypto=r;function e(){const t=r();return t.subtle||t.webkitSubtle}n.getSubtleCrypto=e;function i(){return!!r()&&!!e()}n.isBrowserCryptoAvailable=i}));var Iu=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});n.isBrowser=n.isNode=n.isReactNative=void 0;function r(){return typeof document==="undefined"&&typeof navigator!=="undefined"&&navigator.product==="ReactNative"}n.isReactNative=r;function e(){return typeof i!=="undefined"&&typeof i.versions!=="undefined"&&typeof i.versions.node!=="undefined"}n.isNode=e;function s(){return!r()&&!e()}n.isBrowser=s}));const ju=s(Ou);var Au=n((function(t,n){Object.defineProperty(n,"__esModule",{value:true});ju.__exportStar(Su,n);ju.__exportStar(Iu,n)}));function Nu(t=3){const n=Date.now()*Math.pow(10,t);const r=Math.floor(Math.random()*Math.pow(10,t));return n+r}function Pu(t=6){return BigInt(Nu(t))}function xu(t,n,r){return{id:r||Nu(),jsonrpc:"2.0",method:t,params:n}}function $u(t,n){return{id:t,jsonrpc:"2.0",result:n}}function Tu(t,n,r){return{id:t,jsonrpc:"2.0",error:Mu(n,r)}}function Mu(t,n){if(typeof t==="undefined"){return Za(Ha)}if(typeof t==="string"){t=Object.assign(Object.assign({},Za(za)),{message:t})}if(typeof n!=="undefined"){t.data=n}if(Ja(t.code)){t=Qa(t.code)}return t}class Cu{}class Ru extends Cu{constructor(){super()}}class Uu extends Ru{constructor(t){super()}}const Du="^https?:";const ku="^wss?:";function Lu(t){const n=t.match(new RegExp(/^\w+:/,"gi"));if(!n||!n.length)return;return n[0]}function qu(t,n){const r=Lu(t);if(typeof r==="undefined")return false;return new RegExp(n).test(r)}function Vu(t){return qu(t,Du)}function Fu(t){return qu(t,ku)}function Gu(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Hu(t){return typeof t==="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function zu(t){return Hu(t)&&"method"in t}function Wu(t){return Hu(t)&&(Bu(t)||Ku(t))}function Bu(t){return"result"in t}function Ku(t){return"error"in t}class Ju extends Uu{constructor(n){super(n);this.events=new t.EventEmitter;this.hasRegisteredEventListeners=false;this.connection=this.setConnection(n);if(this.connection.connected){this.registerEventListeners()}}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async request(t,n){return this.requestStrict(xu(t.method,t.params||[],t.id||Pu().toString()),n)}async requestStrict(t,n){return new Promise((async(r,e)=>{if(!this.connection.connected){try{await this.open()}catch(t){e(t)}}this.events.on(`${t.id}`,(t=>{if(Ku(t)){e(t.error)}else{r(t.result)}}));try{await this.connection.send(t,n)}catch(t){e(t)}}))}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t);if(Wu(t)){this.events.emit(`${t.id}`,t)}else{this.events.emit("message",{type:t.method,data:t.params})}}onClose(t){if(t&&t.code===3e3){this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`))}this.events.emit("disconnect")}async open(t=this.connection){if(this.connection===t&&this.connection.connected)return;if(this.connection.connected)this.close();if(typeof t==="string"){await this.connection.open(t);t=this.connection}this.connection=this.setConnection(t);await this.connection.open();this.registerEventListeners();this.events.emit("connect")}async close(){await this.connection.close()}registerEventListeners(){if(this.hasRegisteredEventListeners)return;this.connection.on("payload",(t=>this.onPayload(t)));this.connection.on("close",(t=>this.onClose(t)));this.connection.on("error",(t=>this.events.emit("error",t)));this.connection.on("register_error",(t=>this.onClose()));this.hasRegisteredEventListeners=true}}const Zu=t=>JSON.stringify(t,((t,n)=>typeof n==="bigint"?n.toString()+"n":n));const Qu=t=>{const n=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g;const r=t.replace(n,'$1"$2n"$3');return JSON.parse(r,((t,n)=>{const r=typeof n==="string"&&n.match(/^\d+n$/);if(r)return BigInt(n.substring(0,n.length-1));return n}))};function Xu(t){if(typeof t!=="string"){throw new Error(`Cannot safe json parse value of type ${typeof t}`)}try{return Qu(t)}catch(n){return t}}function Yu(t){return typeof t==="string"?t:Zu(t)||""}const tc=()=>{if(typeof WebSocket!=="undefined"){return WebSocket}else if(typeof o!=="undefined"&&typeof o.WebSocket!=="undefined"){return o.WebSocket}else if(typeof window!=="undefined"&&typeof window.WebSocket!=="undefined"){return window.WebSocket}else if(typeof self!=="undefined"&&typeof self.WebSocket!=="undefined"){return self.WebSocket}return require("ws")};const nc=()=>typeof WebSocket!=="undefined"||typeof o!=="undefined"&&typeof o.WebSocket!=="undefined"||typeof window!=="undefined"&&typeof window.WebSocket!=="undefined"||typeof self!=="undefined"&&typeof self.WebSocket!=="undefined";const rc=t=>t.split("?")[0];const ec=10;const ic=tc();class sc{constructor(n){this.url=n;this.events=new t.EventEmitter;this.registering=false;if(!Fu(n)){throw new Error(`Provided URL is not compatible with WebSocket connection: ${n}`)}this.url=n}get connected(){return typeof this.socket!=="undefined"}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){return new Promise(((t,n)=>{if(typeof this.socket==="undefined"){n(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n);t()};this.socket.close()}))}async send(t,n){if(typeof this.socket==="undefined"){this.socket=await this.register()}try{this.socket.send(Yu(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!Fu(t)){throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`)}if(this.registering){const t=this.events.getMaxListeners();if(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t){this.events.setMaxListeners(t+1)}return new Promise(((t,n)=>{this.events.once("register_error",(t=>{this.resetMaxListeners();n(t)}));this.events.once("open",(()=>{this.resetMaxListeners();if(typeof this.socket==="undefined"){return n(new Error("WebSocket connection is missing or invalid"))}t(this.socket)}))}))}this.url=t;this.registering=true;return new Promise(((n,r)=>{const e=!Au.isReactNative()?{rejectUnauthorized:!Gu(t)}:undefined;const i=new ic(t,[],e);if(nc()){i.onerror=t=>{const n=t;r(this.emitError(n.error))}}else{i.on("error",(t=>{r(this.emitError(t))}))}i.onopen=()=>{this.onOpen(i);n(i)}}))}onOpen(t){t.onmessage=t=>this.onPayload(t);t.onclose=t=>this.onClose(t);this.socket=t;this.registering=false;this.events.emit("open")}onClose(t){this.socket=undefined;this.registering=false;this.events.emit("close",t)}onPayload(t){if(typeof t.data==="undefined")return;const n=typeof t.data==="string"?Xu(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n);const e=r.message||r.toString();const i=Tu(t,e);this.events.emit("payload",i)}parseError(t,n=this.url){return Xa(t,rc(n),"WS")}resetMaxListeners(){if(this.events.getMaxListeners()>ec){this.events.setMaxListeners(ec)}}emitError(t){const n=this.parseError(new Error((t===null||t===void 0?void 0:t.message)||`WebSocket connection failed for host: ${rc(this.url)}`));this.events.emit("register_error",n);return n}}var oc=n((function(t,n){var r=200;var e="__lodash_hash_undefined__";var i=1,s=2;var o=9007199254740991;var u="[object Arguments]",c="[object Array]",h="[object AsyncFunction]",f="[object Boolean]",l="[object Date]",d="[object Error]",p="[object Function]",v="[object GeneratorFunction]",w="[object Map]",y="[object Number]",b="[object Null]",m="[object Object]",g="[object Promise]",_="[object Proxy]",E="[object RegExp]",O="[object Set]",S="[object String]",I="[object Symbol]",j="[object Undefined]",A="[object WeakMap]";var N="[object ArrayBuffer]",P="[object DataView]",x="[object Float32Array]",$="[object Float64Array]",T="[object Int8Array]",M="[object Int16Array]",C="[object Int32Array]",R="[object Uint8Array]",U="[object Uint8ClampedArray]",D="[object Uint16Array]",k="[object Uint32Array]";var L=/[\\^$.*+?()[\]{}|]/g;var q=/^\[object .+?Constructor\]$/;var V=/^(?:0|[1-9]\d*)$/;var F={};F[x]=F[$]=F[T]=F[M]=F[C]=F[R]=F[U]=F[D]=F[k]=true;F[u]=F[c]=F[N]=F[f]=F[P]=F[l]=F[d]=F[p]=F[w]=F[y]=F[m]=F[E]=F[O]=F[S]=F[A]=false;var G=typeof a=="object"&&a&&a.Object===Object&&a;var H=typeof self=="object"&&self&&self.Object===Object&&self;var z=G||H||Function("return this")();var W=n&&!n.nodeType&&n;var B=W&&"object"=="object"&&t&&!t.nodeType&&t;var K=B&&B.exports===W;var J=K&&G.process;var Z=function(){try{return J&&J.binding&&J.binding("util")}catch(t){}}();var Q=Z&&Z.isTypedArray;function X(t,n){var r=-1,e=t==null?0:t.length,i=0,s=[];while(++r<e){var o=t[r];if(n(o,r,t)){s[i++]=o}}return s}function Y(t,n){var r=-1,e=n.length,i=t.length;while(++r<e){t[i+r]=n[r]}return t}function tt(t,n){var r=-1,e=t==null?0:t.length;while(++r<e){if(n(t[r],r,t)){return true}}return false}function nt(t,n){var r=-1,e=Array(t);while(++r<t){e[r]=n(r)}return e}function rt(t){return function(n){return t(n)}}function et(t,n){return t.has(n)}function it(t,n){return t==null?undefined:t[n]}function st(t){var n=-1,r=Array(t.size);t.forEach((function(t,e){r[++n]=[e,t]}));return r}function ot(t,n){return function(r){return t(n(r))}}function at(t){var n=-1,r=Array(t.size);t.forEach((function(t){r[++n]=t}));return r}var ut=Array.prototype,ct=Function.prototype,ht=Object.prototype;var ft=z["__core-js_shared__"];var lt=ct.toString;var dt=ht.hasOwnProperty;var pt=function(){var t=/[^.]+$/.exec(ft&&ft.keys&&ft.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();var vt=ht.toString;var wt=RegExp("^"+lt.call(dt).replace(L,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var yt=K?z.Buffer:undefined,bt=z.Symbol,mt=z.Uint8Array,gt=ht.propertyIsEnumerable,_t=ut.splice,Et=bt?bt.toStringTag:undefined;var Ot=Object.getOwnPropertySymbols,St=yt?yt.isBuffer:undefined,It=ot(Object.keys,Object);var jt=Nn(z,"DataView"),At=Nn(z,"Map"),Nt=Nn(z,"Promise"),Pt=Nn(z,"Set"),xt=Nn(z,"WeakMap"),$t=Nn(Object,"create");var Tt=Dn(jt),Mt=Dn(At),Ct=Dn(Nt),Rt=Dn(Pt),Ut=Dn(xt);var Dt=bt?bt.prototype:undefined,kt=Dt?Dt.valueOf:undefined;function Lt(t){var n=-1,r=t==null?0:t.length;this.clear();while(++n<r){var e=t[n];this.set(e[0],e[1])}}function qt(){this.__data__=$t?$t(null):{};this.size=0}function Vt(t){var n=this.has(t)&&delete this.__data__[t];this.size-=n?1:0;return n}function Ft(t){var n=this.__data__;if($t){var r=n[t];return r===e?undefined:r}return dt.call(n,t)?n[t]:undefined}function Gt(t){var n=this.__data__;return $t?n[t]!==undefined:dt.call(n,t)}function Ht(t,n){var r=this.__data__;this.size+=this.has(t)?0:1;r[t]=$t&&n===undefined?e:n;return this}Lt.prototype.clear=qt;Lt.prototype["delete"]=Vt;Lt.prototype.get=Ft;Lt.prototype.has=Gt;Lt.prototype.set=Ht;function zt(t){var n=-1,r=t==null?0:t.length;this.clear();while(++n<r){var e=t[n];this.set(e[0],e[1])}}function Wt(){this.__data__=[];this.size=0}function Bt(t){var n=this.__data__,r=pn(n,t);if(r<0){return false}var e=n.length-1;if(r==e){n.pop()}else{_t.call(n,r,1)}--this.size;return true}function Kt(t){var n=this.__data__,r=pn(n,t);return r<0?undefined:n[r][1]}function Jt(t){return pn(this.__data__,t)>-1}function Zt(t,n){var r=this.__data__,e=pn(r,t);if(e<0){++this.size;r.push([t,n])}else{r[e][1]=n}return this}zt.prototype.clear=Wt;zt.prototype["delete"]=Bt;zt.prototype.get=Kt;zt.prototype.has=Jt;zt.prototype.set=Zt;function Qt(t){var n=-1,r=t==null?0:t.length;this.clear();while(++n<r){var e=t[n];this.set(e[0],e[1])}}function Xt(){this.size=0;this.__data__={hash:new Lt,map:new(At||zt),string:new Lt}}function Yt(t){var n=An(this,t)["delete"](t);this.size-=n?1:0;return n}function tn(t){return An(this,t).get(t)}function nn(t){return An(this,t).has(t)}function rn(t,n){var r=An(this,t),e=r.size;r.set(t,n);this.size+=r.size==e?0:1;return this}Qt.prototype.clear=Xt;Qt.prototype["delete"]=Yt;Qt.prototype.get=tn;Qt.prototype.has=nn;Qt.prototype.set=rn;function en(t){var n=-1,r=t==null?0:t.length;this.__data__=new Qt;while(++n<r){this.add(t[n])}}function sn(t){this.__data__.set(t,e);return this}function on(t){return this.__data__.has(t)}en.prototype.add=en.prototype.push=sn;en.prototype.has=on;function an(t){var n=this.__data__=new zt(t);this.size=n.size}function un(){this.__data__=new zt;this.size=0}function cn(t){var n=this.__data__,r=n["delete"](t);this.size=n.size;return r}function hn(t){return this.__data__.get(t)}function fn(t){return this.__data__.has(t)}function ln(t,n){var e=this.__data__;if(e instanceof zt){var i=e.__data__;if(!At||i.length<r-1){i.push([t,n]);this.size=++e.size;return this}e=this.__data__=new Qt(i)}e.set(t,n);this.size=e.size;return this}an.prototype.clear=un;an.prototype["delete"]=cn;an.prototype.get=hn;an.prototype.has=fn;an.prototype.set=ln;function dn(t,n){var r=qn(t),e=!r&&Ln(t),i=!r&&!e&&Fn(t),s=!r&&!e&&!i&&Kn(t),o=r||e||i||s,a=o?nt(t.length,String):[],u=a.length;for(var c in t){if((n||dt.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Tn(c,u)))){a.push(c)}}return a}function pn(t,n){var r=t.length;while(r--){if(kn(t[r][0],n)){return r}}return-1}function vn(t,n,r){var e=n(t);return qn(t)?e:Y(e,r(t))}function wn(t){if(t==null){return t===undefined?j:b}return Et&&Et in Object(t)?Pn(t):Un(t)}function yn(t){return Bn(t)&&wn(t)==u}function bn(t,n,r,e,i){if(t===n){return true}if(t==null||n==null||!Bn(t)&&!Bn(n)){return t!==t&&n!==n}return mn(t,n,r,e,bn,i)}function mn(t,n,r,e,s,o){var a=qn(t),h=qn(n),f=a?c:$n(t),l=h?c:$n(n);f=f==u?m:f;l=l==u?m:l;var d=f==m,p=l==m,v=f==l;if(v&&Fn(t)){if(!Fn(n)){return false}a=true;d=false}if(v&&!d){o||(o=new an);return a||Kn(t)?On(t,n,r,e,s,o):Sn(t,n,f,r,e,s,o)}if(!(r&i)){var w=d&&dt.call(t,"__wrapped__"),y=p&&dt.call(n,"__wrapped__");if(w||y){var b=w?t.value():t,g=y?n.value():n;o||(o=new an);return s(b,g,r,e,o)}}if(!v){return false}o||(o=new an);return In(t,n,r,e,s,o)}function gn(t){if(!Wn(t)||Cn(t)){return false}var n=Hn(t)?wt:q;return n.test(Dn(t))}function _n(t){return Bn(t)&&zn(t.length)&&!!F[wn(t)]}function En(t){if(!Rn(t)){return It(t)}var n=[];for(var r in Object(t)){if(dt.call(t,r)&&r!="constructor"){n.push(r)}}return n}function On(t,n,r,e,o,a){var u=r&i,c=t.length,h=n.length;if(c!=h&&!(u&&h>c)){return false}var f=a.get(t);if(f&&a.get(n)){return f==n}var l=-1,d=true,p=r&s?new en:undefined;a.set(t,n);a.set(n,t);while(++l<c){var v=t[l],w=n[l];if(e){var y=u?e(w,v,l,n,t,a):e(v,w,l,t,n,a)}if(y!==undefined){if(y){continue}d=false;break}if(p){if(!tt(n,(function(t,n){if(!et(p,n)&&(v===t||o(v,t,r,e,a))){return p.push(n)}}))){d=false;break}}else if(!(v===w||o(v,w,r,e,a))){d=false;break}}a["delete"](t);a["delete"](n);return d}function Sn(t,n,r,e,o,a,u){switch(r){case P:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset){return false}t=t.buffer;n=n.buffer;case N:if(t.byteLength!=n.byteLength||!a(new mt(t),new mt(n))){return false}return true;case f:case l:case y:return kn(+t,+n);case d:return t.name==n.name&&t.message==n.message;case E:case S:return t==n+"";case w:var c=st;case O:var h=e&i;c||(c=at);if(t.size!=n.size&&!h){return false}var p=u.get(t);if(p){return p==n}e|=s;u.set(t,n);var v=On(c(t),c(n),e,o,a,u);u["delete"](t);return v;case I:if(kt){return kt.call(t)==kt.call(n)}}return false}function In(t,n,r,e,s,o){var a=r&i,u=jn(t),c=u.length,h=jn(n),f=h.length;if(c!=f&&!a){return false}var l=c;while(l--){var d=u[l];if(!(a?d in n:dt.call(n,d))){return false}}var p=o.get(t);if(p&&o.get(n)){return p==n}var v=true;o.set(t,n);o.set(n,t);var w=a;while(++l<c){d=u[l];var y=t[d],b=n[d];if(e){var m=a?e(b,y,d,n,t,o):e(y,b,d,t,n,o)}if(!(m===undefined?y===b||s(y,b,r,e,o):m)){v=false;break}w||(w=d=="constructor")}if(v&&!w){var g=t.constructor,_=n.constructor;if(g!=_&&("constructor"in t&&"constructor"in n)&&!(typeof g=="function"&&g instanceof g&&typeof _=="function"&&_ instanceof _)){v=false}}o["delete"](t);o["delete"](n);return v}function jn(t){return vn(t,Jn,xn)}function An(t,n){var r=t.__data__;return Mn(n)?r[typeof n=="string"?"string":"hash"]:r.map}function Nn(t,n){var r=it(t,n);return gn(r)?r:undefined}function Pn(t){var n=dt.call(t,Et),r=t[Et];try{t[Et]=undefined;var e=true}catch(t){}var i=vt.call(t);if(e){if(n){t[Et]=r}else{delete t[Et]}}return i}var xn=!Ot?Zn:function(t){if(t==null){return[]}t=Object(t);return X(Ot(t),(function(n){return gt.call(t,n)}))};var $n=wn;if(jt&&$n(new jt(new ArrayBuffer(1)))!=P||At&&$n(new At)!=w||Nt&&$n(Nt.resolve())!=g||Pt&&$n(new Pt)!=O||xt&&$n(new xt)!=A){$n=function(t){var n=wn(t),r=n==m?t.constructor:undefined,e=r?Dn(r):"";if(e){switch(e){case Tt:return P;case Mt:return w;case Ct:return g;case Rt:return O;case Ut:return A}}return n}}function Tn(t,n){n=n==null?o:n;return!!n&&(typeof t=="number"||V.test(t))&&(t>-1&&t%1==0&&t<n)}function Mn(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function Cn(t){return!!pt&&pt in t}function Rn(t){var n=t&&t.constructor,r=typeof n=="function"&&n.prototype||ht;return t===r}function Un(t){return vt.call(t)}function Dn(t){if(t!=null){try{return lt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function kn(t,n){return t===n||t!==t&&n!==n}var Ln=yn(function(){return arguments}())?yn:function(t){return Bn(t)&&dt.call(t,"callee")&&!gt.call(t,"callee")};var qn=Array.isArray;function Vn(t){return t!=null&&zn(t.length)&&!Hn(t)}var Fn=St||Qn;function Gn(t,n){return bn(t,n)}function Hn(t){if(!Wn(t)){return false}var n=wn(t);return n==p||n==v||n==h||n==_}function zn(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=o}function Wn(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function Bn(t){return t!=null&&typeof t=="object"}var Kn=Q?rt(Q):_n;function Jn(t){return Vn(t)?dn(t):En(t)}function Zn(){return[]}function Qn(){return false}t.exports=Gn}));function ac(t,n){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),e=0;e<r.length;e++)r[e]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,u=t.charAt(0),c=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function f(n){if(n instanceof Uint8Array||(ArrayBuffer.isView(n)?n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength):Array.isArray(n)&&(n=Uint8Array.from(n))),!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(n.length===0)return"";for(var r=0,e=0,i=0,s=n.length;i!==s&&n[i]===0;)i++,r++;for(var o=(s-i)*h+1>>>0,c=new Uint8Array(o);i!==s;){for(var f=n[i],l=0,d=o-1;(f!==0||l<e)&&d!==-1;d--,l++)f+=256*c[d]>>>0,c[d]=f%a>>>0,f=f/a>>>0;if(f!==0)throw new Error("Non-zero carry");e=l,i++}for(var p=o-e;p!==o&&c[p]===0;)p++;for(var v=u.repeat(r);p<o;++p)v+=t.charAt(c[p]);return v}function l(t){if(typeof t!="string")throw new TypeError("Expected String");if(t.length===0)return new Uint8Array;var n=0;if(t[n]!==" "){for(var e=0,i=0;t[n]===u;)e++,n++;for(var s=(t.length-n)*c+1>>>0,o=new Uint8Array(s);t[n];){var h=r[t.charCodeAt(n)];if(h===255)return;for(var f=0,l=s-1;(h!==0||f<i)&&l!==-1;l--,f++)h+=a*o[l]>>>0,o[l]=h%256>>>0,h=h/256>>>0;if(h!==0)throw new Error("Non-zero carry");i=f,n++}if(t[n]!==" "){for(var d=s-i;d!==s&&o[d]===0;)d++;for(var p=new Uint8Array(e+(s-d)),v=e;d!==s;)p[v++]=o[d++];return p}}}function d(t){var r=l(t);if(r)return r;throw new Error(`Non-${n} character`)}return{encode:f,decodeUnsafe:l,decode:d}}var uc=ac,cc=uc;const hc=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},fc=t=>(new TextEncoder).encode(t),lc=t=>(new TextDecoder).decode(t);class dc{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class pc{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return wc(this,t)}}class vc{constructor(t){this.decoders=t}or(t){return wc(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wc=(t,n)=>new vc({...t.decoders||{[t.prefix]:t},...n.decoders||{[n.prefix]:n}});class yc{constructor(t,n,r,e){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=e,this.encoder=new dc(t,n,r),this.decoder=new pc(t,n,e)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const bc=({name:t,prefix:n,encode:r,decode:e})=>new yc(t,n,r,e),mc=({prefix:t,name:n,alphabet:r})=>{const{encode:e,decode:i}=cc(r,n);return bc({prefix:t,name:n,encode:e,decode:t=>hc(i(t))})},gc=(t,n,r,e)=>{const i={};for(let t=0;t<n.length;++t)i[n[t]]=t;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,u=0,c=0;for(let n=0;n<s;++n){const s=i[t[n]];if(s===void 0)throw new SyntaxError(`Non-${e} character`);u=u<<r|s,a+=r,a>=8&&(a-=8,o[c++]=255&u>>a)}if(a>=r||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return o},_c=(t,n,r)=>{const e=n[n.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let e=0;e<t.length;++e)for(a=a<<8|t[e],o+=8;o>r;)o-=r,s+=n[i&a>>o];if(o&&(s+=n[i&a<<r-o]),e)for(;s.length*r&7;)s+="=";return s},Ec=({name:t,prefix:n,bitsPerChar:r,alphabet:e})=>bc({prefix:n,name:t,encode(t){return _c(t,e,r)},decode(n){return gc(n,e,r,t)}}),Oc=bc({prefix:"\0",name:"identity",encode:t=>lc(t),decode:t=>fc(t)});var Sc=Object.freeze({__proto__:null,identity:Oc});const Ic=Ec({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var jc=Object.freeze({__proto__:null,base2:Ic});const Ac=Ec({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Nc=Object.freeze({__proto__:null,base8:Ac});const Pc=mc({prefix:"9",name:"base10",alphabet:"0123456789"});var xc=Object.freeze({__proto__:null,base10:Pc});const $c=Ec({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Tc=Ec({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Mc=Object.freeze({__proto__:null,base16:$c,base16upper:Tc});const Cc=Ec({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rc=Ec({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Uc=Ec({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Dc=Ec({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kc=Ec({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Lc=Ec({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qc=Ec({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vc=Ec({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fc=Ec({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Gc=Object.freeze({__proto__:null,base32:Cc,base32upper:Rc,base32pad:Uc,base32padupper:Dc,base32hex:kc,base32hexupper:Lc,base32hexpad:qc,base32hexpadupper:Vc,base32z:Fc});const Hc=mc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zc=mc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Wc=Object.freeze({__proto__:null,base36:Hc,base36upper:zc});const Bc=mc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Kc=mc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Jc=Object.freeze({__proto__:null,base58btc:Bc,base58flickr:Kc});const Zc=Ec({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Qc=Ec({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xc=Ec({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Yc=Ec({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var th=Object.freeze({__proto__:null,base64:Zc,base64pad:Qc,base64url:Xc,base64urlpad:Yc});const nh=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),rh=nh.reduce(((t,n,r)=>(t[r]=n,t)),[]),eh=nh.reduce(((t,n,r)=>(t[n.codePointAt(0)]=r,t)),[]);function ih(t){return t.reduce(((t,n)=>(t+=rh[n],t)),"")}function sh(t){const n=[];for(const r of t){const t=eh[r.codePointAt(0)];if(t===void 0)throw new Error(`Non-base256emoji character: ${r}`);n.push(t)}return new Uint8Array(n)}const oh=bc({prefix:"🚀",name:"base256emoji",encode:ih,decode:sh});var ah=Object.freeze({__proto__:null,base256emoji:oh}),uh=dh,ch=128,hh=127,fh=~hh,lh=Math.pow(2,31);function dh(t,n,r){n=n||[],r=r||0;for(var e=r;t>=lh;)n[r++]=t&255|ch,t/=128;for(;t&fh;)n[r++]=t&255|ch,t>>>=7;return n[r]=t|0,dh.bytes=r-e+1,n}var ph=yh,vh=128,wh=127;function yh(t,n){var r=0,n=n||0,e=0,i=n,s,o=t.length;do{if(i>=o)throw yh.bytes=0,new RangeError("Could not decode varint");s=t[i++],r+=e<28?(s&wh)<<e:(s&wh)*Math.pow(2,e),e+=7}while(s>=vh);return yh.bytes=i-n,r}var bh=Math.pow(2,7),mh=Math.pow(2,14),gh=Math.pow(2,21),_h=Math.pow(2,28),Eh=Math.pow(2,35),Oh=Math.pow(2,42),Sh=Math.pow(2,49),Ih=Math.pow(2,56),jh=Math.pow(2,63),Ah=function(t){return t<bh?1:t<mh?2:t<gh?3:t<_h?4:t<Eh?5:t<Oh?6:t<Sh?7:t<Ih?8:t<jh?9:10},Nh={encode:uh,decode:ph,encodingLength:Ah},Ph=Nh;const xh=(t,n,r=0)=>(Ph.encode(t,n,r),n),$h=t=>Ph.encodingLength(t),Th=(t,n)=>{const r=n.byteLength,e=$h(t),i=e+$h(r),s=new Uint8Array(i+r);return xh(t,s,0),xh(r,s,e),s.set(n,i),new Mh(t,r,n,s)};class Mh{constructor(t,n,r,e){this.code=t,this.size=n,this.digest=r,this.bytes=e}}const Ch=({name:t,code:n,encode:r})=>new Rh(t,n,r);class Rh{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?Th(this.code,n):n.then((t=>Th(this.code,t)))}else throw Error("Unknown type, must be binary type")}}const Uh=t=>async n=>new Uint8Array(await crypto.subtle.digest(t,n)),Dh=Ch({name:"sha2-256",code:18,encode:Uh("SHA-256")}),kh=Ch({name:"sha2-512",code:19,encode:Uh("SHA-512")});Object.freeze({__proto__:null,sha256:Dh,sha512:kh});const Lh=0,qh="identity",Vh=hc,Fh=t=>Th(Lh,Vh(t)),Gh={code:Lh,name:qh,encode:Vh,digest:Fh};Object.freeze({__proto__:null,identity:Gh});new TextEncoder,new TextDecoder;const Hh={...Sc,...jc,...Nc,...xc,...Mc,...Gc,...Wc,...Jc,...th,...ah};function zh(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Wh(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?zh(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Bh(t,n,r,e){return{name:t,prefix:n,encoder:{name:t,prefix:n,encode:r},decoder:{decode:e}}}const Kh=Bh("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Jh=Bh("ascii","a",(t=>{let n="a";for(let r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return n}),(t=>{t=t.substring(1);const n=Wh(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n})),Zh={utf8:Kh,"utf-8":Kh,hex:Hh.base16,latin1:Jh,ascii:Jh,binary:Jh,...Hh};function Qh(t,n="utf8"){const r=Zh[n];if(!r)throw new Error(`Unsupported encoding "${n}"`);return(n==="utf8"||n==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?zh(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}const Xh="wc",Yh=2,tf="core",nf=`${Xh}@2:${tf}:`,rf={name:tf,logger:"error"},ef={database:":memory:"},sf="crypto",of="client_ed25519_seed",af=Mn.ONE_DAY,uf="keychain",cf="0.3",hf="messages",ff="0.3",lf=Mn.SIX_HOURS,df="publisher",pf="irn",vf="error",wf="wss://relay.walletconnect.com",yf="wss://relay.walletconnect.org",bf="relayer",mf={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},gf="_subscription",_f={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ef=Mn.ONE_SECOND,Of="2.10.2",Sf=1e4,If="0.3",jf="WALLETCONNECT_CLIENT_ID",Af={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Nf="subscription",Pf="0.3",xf=Mn.FIVE_SECONDS*1e3,$f="pairing",Tf="0.3",Mf={wc_pairingDelete:{req:{ttl:Mn.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Mn.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Mn.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Mn.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Mn.ONE_DAY,prompt:!1,tag:0},res:{ttl:Mn.ONE_DAY,prompt:!1,tag:0}}},Cf={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Rf={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Uf="history",Df="0.3",kf="expirer",Lf={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},qf="0.3",Vf="verify-api",Ff="https://verify.walletconnect.com",Gf="https://verify.walletconnect.org";class Hf{constructor(t,n){this.core=t,this.logger=n,this.keychain=new Map,this.name=uf,this.version=cf,this.initialized=!1,this.storagePrefix=nf,this.init=async()=>{if(!this.initialized){const t=await this.getKeyChain();typeof t<"u"&&(this.keychain=t),this.initialized=!0}},this.has=t=>(this.isInitialized(),this.keychain.has(t)),this.set=async(t,n)=>{this.isInitialized(),this.keychain.set(t,n),await this.persist()},this.get=t=>{this.isInitialized();const n=this.keychain.get(t);if(typeof n>"u"){const{message:n}=Se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return n},this.del=async t=>{this.isInitialized(),this.keychain.delete(t),await this.persist()},this.core=t,this.logger=To.generateChildLogger(n,this.name)}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Fr(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Gr(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class zf{constructor(t,n,r){this.core=t,this.logger=n,this.name=sf,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=t=>(this.isInitialized(),this.keychain.has(t)),this.getClientId=async()=>{this.isInitialized();const t=await this.getClientSeed(),n=Sa(t);return ga(n.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const t=ur();return this.setPrivateKey(t.publicKey,t.privateKey)},this.signJWT=async t=>{this.isInitialized();const n=await this.getClientSeed(),r=Sa(n),e=cr(),i=af;return await Ia(e,t,i,r)},this.generateSharedKey=(t,n,r)=>{this.isInitialized();const e=this.getPrivateKey(t),i=hr(e,n);return this.setSymKey(i,r)},this.setSymKey=async(t,n)=>{this.isInitialized();const r=n||fr(t);return await this.keychain.set(r,t),r},this.deleteKeyPair=async t=>{this.isInitialized(),await this.keychain.del(t)},this.deleteSymKey=async t=>{this.isInitialized(),await this.keychain.del(t)},this.encode=async(t,n,r)=>{this.isInitialized();const e=gr(r),i=zo(n);if(_r(e)){const n=e.senderPublicKey,r=e.receiverPublicKey;t=await this.generateSharedKey(n,r)}const s=this.getSymKey(t),{type:o,senderPublicKey:a}=e;return vr({type:o,symKey:s,message:i,senderPublicKey:a})},this.decode=async(t,n,r)=>{this.isInitialized();const e=mr(n,r);if(_r(e)){const n=e.receiverPublicKey,r=e.senderPublicKey;t=await this.generateSharedKey(n,r)}try{const r=this.getSymKey(t),e=wr({symKey:r,encoded:n});return Ho(e)}catch(n){this.logger.error(`Failed to decode message from topic: '${t}', clientId: '${await this.getClientId()}'`),this.logger.error(n)}},this.getPayloadType=t=>{const n=br(t);return pr(n.type)},this.getPayloadSenderPublicKey=t=>{const n=br(t);return n.senderPublicKey?La.toString(n.senderPublicKey,Yn):void 0},this.core=t,this.logger=To.generateChildLogger(n,this.name),this.keychain=r||new Hf(this.core,this.logger)}get context(){return To.getLoggerContext(this.logger)}async setPrivateKey(t,n){return await this.keychain.set(t,n),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(of)}catch{t=cr(),await this.keychain.set(of,t)}return Qh(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Wf extends Ro{constructor(t,n){super(t,n),this.logger=t,this.core=n,this.messages=new Map,this.name=hf,this.version=ff,this.initialized=!1,this.storagePrefix=nf,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const t=await this.getRelayerMessages();typeof t<"u"&&(this.messages=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}finally{this.initialized=!0}}},this.set=async(t,n)=>{this.isInitialized();const r=lr(n);let e=this.messages.get(t);return typeof e>"u"&&(e={}),typeof e[r]<"u"||(e[r]=n,this.messages.set(t,e),await this.persist()),r},this.get=t=>{this.isInitialized();let n=this.messages.get(t);return typeof n>"u"&&(n={}),n},this.has=(t,n)=>{this.isInitialized();const r=this.get(t),e=lr(n);return typeof r[e]<"u"},this.del=async t=>{this.isInitialized(),this.messages.delete(t),await this.persist()},this.logger=To.generateChildLogger(t,this.name),this.core=n}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Fr(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Gr(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Bf extends Uo{constructor(n,r){super(n,r),this.relayer=n,this.logger=r,this.events=new t.EventEmitter,this.name=df,this.queue=new Map,this.publishTimeout=Mn.toMiliseconds(Mn.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(t,n,r)=>{var e;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:n,opts:r}});try{const i=r?.ttl||lf,s=re(r),o=r?.prompt||!1,a=r?.tag||0,u=r?.id||Pu().toString(),c={topic:t,message:n,opts:{ttl:i,relay:s,prompt:o,tag:a,id:u}},h=setTimeout((()=>this.queue.set(u,c)),this.publishTimeout);try{await await zr(this.rpcPublish(t,n,i,s,o,a,u),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(u),this.relayer.events.emit(mf.publish,c)}catch(t){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(e=r?.internal)!=null&&e.throwOnFailedPublish)throw this.removeRequestFromQueue(u),t;return}finally{clearTimeout(h)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:n,opts:r}})}catch(t){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(t),t}},this.on=(t,n)=>{this.events.on(t,n)},this.once=(t,n)=>{this.events.once(t,n)},this.off=(t,n)=>{this.events.off(t,n)},this.removeListener=(t,n)=>{this.events.removeListener(t,n)},this.relayer=n,this.logger=To.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return To.getLoggerContext(this.logger)}rpcPublish(t,n,r,e,i,s,o){var a,u,c,h;const f={method:ee(e.protocol).publish,params:{topic:t,message:n,ttl:r,prompt:i,tag:s},id:o};return Ne((a=f.params)==null?void 0:a.prompt)&&((u=f.params)==null||delete u.prompt),Ne((c=f.params)==null?void 0:c.tag)&&((h=f.params)==null||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f}),this.relayer.request(f)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach((async t=>{const{topic:n,message:r,opts:e}=t;await this.publish(n,r,e)}))}registerEventListeners(){this.relayer.core.heartbeat.on($s.HEARTBEAT_EVENTS.pulse,(()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mf.connection_stalled);return}this.checkQueue()})),this.relayer.on(mf.message_ack,(t=>{this.removeRequestFromQueue(t.id.toString())}))}}class Kf{constructor(){this.map=new Map,this.set=(t,n)=>{const r=this.get(t);this.exists(t,n)||this.map.set(t,[...r,n])},this.get=t=>this.map.get(t)||[],this.exists=(t,n)=>this.get(t).includes(n),this.delete=(t,n)=>{if(typeof n>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,n))return;const e=r.filter((t=>t!==n));if(!e.length){this.map.delete(t);return}this.map.set(t,e)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Jf=Object.defineProperty,Zf=Object.defineProperties,Qf=Object.getOwnPropertyDescriptors,Xf=Object.getOwnPropertySymbols,Yf=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,nl=(t,n,r)=>n in t?Jf(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,rl=(t,n)=>{for(var r in n||(n={}))Yf.call(n,r)&&nl(t,r,n[r]);if(Xf)for(var r of Xf(n))tl.call(n,r)&&nl(t,r,n[r]);return t},el=(t,n)=>Zf(t,Qf(n));class il extends Lo{constructor(n,r){super(n,r),this.relayer=n,this.logger=r,this.subscriptions=new Map,this.topicMap=new Kf,this.events=new t.EventEmitter,this.name=Nf,this.version=Pf,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=nf,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(t,n)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:n}});try{const r=re(n),e={topic:t,relay:r};this.pending.set(t,e);const i=await this.rpcSubscribe(t,r);return this.onSubscribe(i,e),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:n}}),i}catch(t){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(t),t}},this.unsubscribe=async(t,n)=>{await this.restartToComplete(),this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(t,n.id,n):await this.unsubscribeByTopic(t,n)},this.isSubscribed=async t=>this.topics.includes(t)?!0:await new Promise(((n,r)=>{const e=new Mn.Watch;e.start(this.pendingSubscriptionWatchLabel);const i=setInterval((()=>{!this.pending.has(t)&&this.topics.includes(t)&&(clearInterval(i),e.stop(this.pendingSubscriptionWatchLabel),n(!0)),e.elapsed(this.pendingSubscriptionWatchLabel)>=xf&&(clearInterval(i),e.stop(this.pendingSubscriptionWatchLabel),r(new Error("Subscription resolution timeout")))}),this.pollingInterval)})).catch((()=>!1)),this.on=(t,n)=>{this.events.on(t,n)},this.once=(t,n)=>{this.events.once(t,n)},this.off=(t,n)=>{this.events.off(t,n)},this.removeListener=(t,n)=>{this.events.removeListener(t,n)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=n,this.logger=To.generateChildLogger(r,this.name),this.clientId=""}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,n){let r=!1;try{r=this.getSubscription(t).topic===n}catch{}return r}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,n){const r=this.topicMap.get(t);await Promise.all(r.map((async r=>await this.unsubscribeById(t,r,n))))}async unsubscribeById(t,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}});try{const e=re(r);await this.rpcUnsubscribe(t,n,e);const i=Ie("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}})}catch(t){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(t),t}}async rpcSubscribe(t,n){const r={method:ee(n.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await zr(this.relayer.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mf.connection_stalled)}return lr(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const n=t[0].relay,r={method:ee(n.protocol).batchSubscribe,params:{topics:t.map((t=>t.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{return await await zr(this.relayer.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(mf.connection_stalled)}}rpcUnsubscribe(t,n,r){const e={method:ee(r.protocol).unsubscribe,params:{topic:t,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:e}),this.relayer.request(e)}onSubscribe(t,n){this.setSubscription(t,el(rl({},n),{id:t})),this.pending.delete(n.topic)}onBatchSubscribe(t){t.length&&t.forEach((t=>{this.setSubscription(t.id,rl({},t)),this.pending.delete(t.topic)}))}async onUnsubscribe(t,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,n){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:n}),this.addSubscription(t,n))}addSubscription(t,n){this.subscriptions.set(t,rl({},n)),this.topicMap.set(n.topic,t),this.events.emit(Af.created,n)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const n=this.subscriptions.get(t);if(!n){const{message:n}=Se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return n}deleteSubscription(t,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:n});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(Af.deleted,el(rl({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Af.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<t;n++){const t=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(Af.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:t}=Se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const n=await this.rpcBatchSubscribe(t);je(n)&&this.onBatchSubscribe(n.map(((n,r)=>el(rl({},t[r]),{id:n}))))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach((n=>{t.push(n)})),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on($s.HEARTBEAT_EVENTS.pulse,(async()=>{await this.checkPending()})),this.relayer.on(mf.connect,(async()=>{await this.onConnect()})),this.relayer.on(mf.disconnect,(()=>{this.onDisconnect()})),this.events.on(Af.created,(async t=>{const n=Af.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),await this.persist()})),this.events.on(Af.deleted,(async t=>{const n=Af.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),await this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise((t=>{const n=setInterval((()=>{this.restartInProgress||(clearInterval(n),t())}),this.pollingInterval)}))}}var sl=Object.defineProperty,ol=Object.getOwnPropertySymbols,al=Object.prototype.hasOwnProperty,ul=Object.prototype.propertyIsEnumerable,cl=(t,n,r)=>n in t?sl(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,hl=(t,n)=>{for(var r in n||(n={}))al.call(n,r)&&cl(t,r,n[r]);if(ol)for(var r of ol(n))ul.call(n,r)&&cl(t,r,n[r]);return t};class fl extends Do{constructor(n){super(n),this.protocol="wc",this.version=2,this.events=new t.EventEmitter,this.name=bf,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(t){throw this.logger.debug("Failed to Publish Request"),this.logger.error(t),t}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(mf.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(mf.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(_f.payload,this.onPayloadHandler),this.provider.on(_f.connect,this.onConnectHandler),this.provider.on(_f.disconnect,this.onDisconnectHandler),this.provider.on(_f.error,this.onProviderErrorHandler)},this.core=n.core,this.logger=typeof n.logger<"u"&&typeof n.logger!="string"?To.generateChildLogger(n.logger,this.name):To.pino(To.getDefaultLoggerOptions({level:n.logger||vf})),this.messages=new Wf(this.logger,n.core),this.subscriber=new il(this,this.logger),this.publisher=new Bf(this,this.logger),this.relayUrl=n?.relayUrl||wf,this.projectId=n.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${yf}...`),await this.restartTransport(yf)}this.initialized=!0,setTimeout((async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)}),Sf)}get context(){return To.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,n,r){this.isInitialized(),await this.publisher.publish(t,n,r),await this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now()})}async subscribe(t,n){var r;this.isInitialized();let e=((r=this.subscriber.topicMap.get(t))==null?void 0:r[0])||"";if(e)return e;let i;const s=n=>{n.topic===t&&(this.subscriber.off(Af.created,s),i())};return await Promise.all([new Promise((t=>{i=t,this.subscriber.on(Af.created,s)})),new Promise((async r=>{e=await this.subscriber.subscribe(t,n),r()}))]),e}async unsubscribe(t,n){this.isInitialized(),await this.subscriber.unsubscribe(t,n)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await zr(this.provider.disconnect(),1e3,"provider.disconnect()").catch((()=>this.onProviderDisconnect())):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise((t=>{if(!this.initialized)return t();this.subscriber.once(Af.resubscribed,(()=>{t()}))})),new Promise((async(t,n)=>{try{await zr(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(t){n(t);return}t()}))])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.provider.events.emit(_f.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await ci())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some((n=>t.includes(n)))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ju(new sc(qr({sdkVersion:Of,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:n,message:r}=t;await this.messages.set(n,r)}async shouldIgnoreMessageEvent(t){const{topic:n,message:r}=t;if(!r||r.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isSubscribed(n))return this.logger.debug(`Ignoring message for non-subscribed topic ${n}`),!0;const e=this.messages.has(n,r);return e&&this.logger.debug(`Ignoring duplicate message: ${r}`),e}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),zu(t)){if(!t.method.endsWith(gf))return;const n=t.params,{topic:r,message:e,publishedAt:i}=n.data,s={topic:r,message:e,publishedAt:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hl({type:"event",event:n.id},s)),this.events.emit(n.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}else Wu(t)&&this.events.emit(mf.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(mf.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const n=$u(t.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(_f.payload,this.onPayloadHandler),this.provider.off(_f.connect,this.onConnectHandler),this.provider.off(_f.disconnect,this.onDisconnectHandler),this.provider.off(_f.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(mf.connection_stalled,(()=>{this.restartTransport().catch((t=>this.logger.error(t)))}));let t=await ci();di((async n=>{this.initialized&&t!==n&&(t=n,n?await this.restartTransport().catch((t=>this.logger.error(t))):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch((t=>this.logger.error(t)))))}))}onProviderDisconnect(){this.events.emit(mf.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout((async()=>{await this.restartTransport().catch((t=>this.logger.error(t)))}),Mn.toMiliseconds(Ef)))}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise((t=>{const n=setInterval((()=>{this.connected&&(clearInterval(n),t())}),this.connectionStatusPollingInterval)}));await this.restartTransport()}}}var ll=Object.defineProperty,dl=Object.getOwnPropertySymbols,pl=Object.prototype.hasOwnProperty,vl=Object.prototype.propertyIsEnumerable,wl=(t,n,r)=>n in t?ll(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,yl=(t,n)=>{for(var r in n||(n={}))pl.call(n,r)&&wl(t,r,n[r]);if(dl)for(var r of dl(n))vl.call(n,r)&&wl(t,r,n[r]);return t};class bl extends ko{constructor(t,n,r,e=nf,i=void 0){super(t,n,r,e),this.core=t,this.logger=n,this.name=r,this.map=new Map,this.version=If,this.cached=[],this.initialized=!1,this.storagePrefix=nf,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>{this.getKey&&t!==null&&!Ne(t)?this.map.set(this.getKey(t),t):Re(t)?this.map.set(t.id,t):Ue(t)&&this.map.set(t.topic,t)})),this.cached=[],this.initialized=!0)},this.set=async(t,n)=>{this.isInitialized(),this.map.has(t)?await this.update(t,n):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:t,value:n}),this.map.set(t,n),await this.persist())},this.get=t=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:t}),this.getData(t)),this.getAll=t=>(this.isInitialized(),t?this.values.filter((n=>Object.keys(t).every((r=>oc(n[r],t[r]))))):this.values),this.update=async(t,n)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:t,update:n});const r=yl(yl({},this.getData(t)),n);this.map.set(t,r),await this.persist()},this.delete=async(t,n)=>{this.isInitialized(),this.map.has(t)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:t,reason:n}),this.map.delete(t),await this.persist())},this.logger=To.generateChildLogger(n,this.name),this.storagePrefix=e,this.getKey=i}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const n=this.map.get(t);if(!n){const{message:n}=Se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:t}=Se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ml{constructor(n,r){this.core=n,this.logger=r,this.name=$f,this.version=Tf,this.events=new t,this.initialized=!1,this.storagePrefix=nf,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:t})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...t])]},this.create=async()=>{this.isInitialized();const t=cr(),n=await this.core.crypto.setSymKey(t),r=Zr(Mn.FIVE_MINUTES),e={protocol:pf},i={topic:n,expiry:r,relay:e,active:!1},s=pe({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:t,relay:e});return await this.pairings.set(n,i),await this.core.relayer.subscribe(n),this.core.expirer.set(n,r),{topic:n,uri:s}},this.pair=async t=>{this.isInitialized(),this.isValidPair(t);const{topic:n,symKey:r,relay:e}=fe(t.uri);let i;if(this.pairings.keys.includes(n)&&(i=this.pairings.get(n),i.active))throw new Error(`Pairing already exists: ${n}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(n)||(await this.core.crypto.setSymKey(r,n),await this.core.relayer.subscribe(n,{relay:e}));const s=Zr(Mn.FIVE_MINUTES),o={topic:n,relay:e,expiry:s,active:!1};return await this.pairings.set(n,o),this.core.expirer.set(n,s),t.activatePairing&&await this.activate({topic:n}),this.events.emit(Cf.create,o),o},this.activate=async({topic:t})=>{this.isInitialized();const n=Zr(Mn.THIRTY_DAYS);await this.pairings.update(t,{active:!0,expiry:n}),this.core.expirer.set(t,n)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.pairings.keys.includes(n)){const t=await this.sendRequest(n,"wc_pairingPing",{}),{done:r,resolve:e,reject:i}=Hr();this.events.once(Xr("pairing_ping",t),(({error:t})=>{t?i(t):e()})),await r()}},this.updateExpiry=async({topic:t,expiry:n})=>{this.isInitialized(),await this.pairings.update(t,{expiry:n})},this.updateMetadata=async({topic:t,metadata:n})=>{this.isInitialized(),await this.pairings.update(t,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",Ie("USER_DISCONNECTED")),await this.deletePairing(n))},this.sendRequest=async(t,n,r)=>{const e=xu(n,r),i=await this.core.crypto.encode(t,e),s=Mf[n].req;return this.core.history.set(t,e),this.core.relayer.publish(t,i,s),e.id},this.sendResult=async(t,n,r)=>{const e=$u(t,r),i=await this.core.crypto.encode(n,e),s=await this.core.history.get(n,t),o=Mf[s.request.method].res;await this.core.relayer.publish(n,i,o),await this.core.history.resolve(e)},this.sendError=async(t,n,r)=>{const e=Tu(t,r),i=await this.core.crypto.encode(n,e),s=await this.core.history.get(n,t),o=Mf[s.request.method]?Mf[s.request.method].res:Mf.unregistered_method.res;await this.core.relayer.publish(n,i,o),await this.core.history.resolve(e)},this.deletePairing=async(t,n)=>{await this.core.relayer.unsubscribe(t),await Promise.all([this.pairings.delete(t,Ie("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(t),n?Promise.resolve():this.core.expirer.del(t)])},this.cleanup=async()=>{const t=this.pairings.getAll().filter((t=>Qr(t.expiry)));await Promise.all(t.map((t=>this.deletePairing(t.topic))))},this.onRelayEventRequest=t=>{const{topic:n,payload:r}=t;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(n,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,r);default:return this.onUnknownRpcMethodRequest(n,r)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:r}=t,e=(await this.core.history.get(n,r.id)).request.method;switch(e){case"wc_pairingPing":return this.onPairingPingResponse(n,r);default:return this.onUnknownRpcMethodResponse(e)}},this.onPairingPingRequest=async(t,n)=>{const{id:r}=n;try{this.isValidPing({topic:t}),await this.sendResult(r,t,!0),this.events.emit(Cf.ping,{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.logger.error(n)}},this.onPairingPingResponse=(t,n)=>{const{id:r}=n;setTimeout((()=>{Bu(n)?this.events.emit(Xr("pairing_ping",r),{}):Ku(n)&&this.events.emit(Xr("pairing_ping",r),{error:n.error})}),500)},this.onPairingDeleteRequest=async(t,n)=>{const{id:r}=n;try{this.isValidDisconnect({topic:t}),await this.deletePairing(t),this.events.emit(Cf.delete,{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.logger.error(n)}},this.onUnknownRpcMethodRequest=async(t,n)=>{const{id:r,method:e}=n;try{if(this.registeredMethods.includes(e))return;const n=Ie("WC_METHOD_UNSUPPORTED",e);await this.sendError(r,t,n),this.logger.error(n)}catch(n){await this.sendError(r,t,n),this.logger.error(n)}},this.onUnknownRpcMethodResponse=t=>{this.registeredMethods.includes(t)||this.logger.error(Ie("WC_METHOD_UNSUPPORTED",t))},this.isValidPair=t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`pair() params: ${t}`);throw new Error(n)}if(!Ce(t.uri)){const{message:n}=Se("MISSING_OR_INVALID",`pair() uri: ${t.uri}`);throw new Error(n)}},this.isValidPing=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:n}=t;await this.isValidPairingTopic(n)},this.isValidDisconnect=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:n}=t;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async t=>{if(!Pe(t,!1)){const{message:n}=Se("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(n)}if(!this.pairings.keys.includes(t)){const{message:n}=Se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(n)}if(Qr(this.pairings.get(t).expiry)){await this.deletePairing(t);const{message:n}=Se("EXPIRED",`pairing topic: ${t}`);throw new Error(n)}},this.core=n,this.logger=To.generateChildLogger(r,this.name),this.pairings=new bl(this.core,this.logger,this.name,this.storagePrefix)}get context(){return To.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(mf.message,(async t=>{const{topic:n,message:r}=t;if(!this.pairings.keys.includes(n)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;const e=await this.core.crypto.decode(n,r);try{zu(e)?(this.core.history.set(n,e),this.onRelayEventRequest({topic:n,payload:e})):Wu(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:n,payload:e}),this.core.history.delete(n,e.id))}catch(t){this.logger.error(t)}}))}registerExpirerEvents(){this.core.expirer.on(Lf.expired,(async t=>{const{topic:n}=Jr(t.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Cf.expire,{topic:n}))}))}}class gl extends Co{constructor(n,r){super(n,r),this.core=n,this.logger=r,this.records=new Map,this.events=new t.EventEmitter,this.name=Uf,this.version=Df,this.cached=[],this.initialized=!1,this.storagePrefix=nf,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.records.set(t.id,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(t,n,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:t,request:n,chainId:r}),this.records.has(n.id))return;const e={id:n.id,topic:t,request:{method:n.method,params:n.params||null},chainId:r,expiry:Zr(Mn.THIRTY_DAYS)};this.records.set(e.id,e),this.events.emit(Rf.created,e)},this.resolve=async t=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:t}),!this.records.has(t.id))return;const n=await this.getRecord(t.id);typeof n.response>"u"&&(n.response=Ku(t)?{error:t.error}:{result:t.result},this.records.set(n.id,n),this.events.emit(Rf.updated,n))},this.get=async(t,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:t,id:n}),await this.getRecord(n)),this.delete=(t,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach((r=>{if(r.topic===t){if(typeof n<"u"&&r.id!==n)return;this.records.delete(r.id),this.events.emit(Rf.deleted,r)}}))},this.exists=async(t,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===t:!1),this.on=(t,n)=>{this.events.on(t,n)},this.once=(t,n)=>{this.events.once(t,n)},this.off=(t,n)=>{this.events.off(t,n)},this.removeListener=(t,n)=>{this.events.removeListener(t,n)},this.logger=To.generateChildLogger(r,this.name)}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach((n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:xu(n.request.method,n.request.params,n.id),chainId:n.chainId};return t.push(r)})),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const n=this.records.get(t);if(!n){const{message:n}=Se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Rf.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:t}=Se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Rf.created,(t=>{const n=Rf.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t}),this.persist()})),this.events.on(Rf.updated,(t=>{const n=Rf.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t}),this.persist()})),this.events.on(Rf.deleted,(t=>{const n=Rf.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t}),this.persist()})),this.core.heartbeat.on($s.HEARTBEAT_EVENTS.pulse,(()=>{this.cleanup()}))}cleanup(){try{this.records.forEach((t=>{Mn.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))}))}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class _l extends qo{constructor(n,r){super(n,r),this.core=n,this.logger=r,this.expirations=new Map,this.events=new t.EventEmitter,this.name=kf,this.version=qf,this.cached=[],this.initialized=!1,this.storagePrefix=nf,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.expirations.set(t.target,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=t=>{try{const n=this.formatTarget(t);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(t,n)=>{this.isInitialized();const r=this.formatTarget(t),e={target:r,expiry:n};this.expirations.set(r,e),this.checkExpiry(r,e),this.events.emit(Lf.created,{target:r,expiration:e})},this.get=t=>{this.isInitialized();const n=this.formatTarget(t);return this.getExpiration(n)},this.del=t=>{if(this.isInitialized(),this.has(t)){const n=this.formatTarget(t),r=this.getExpiration(n);this.expirations.delete(n),this.events.emit(Lf.deleted,{target:n,expiration:r})}},this.on=(t,n)=>{this.events.on(t,n)},this.once=(t,n)=>{this.events.once(t,n)},this.off=(t,n)=>{this.events.off(t,n)},this.removeListener=(t,n)=>{this.events.removeListener(t,n)},this.logger=To.generateChildLogger(r,this.name)}get context(){return To.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Br(t);if(typeof t=="number")return Kr(t);const{message:n}=Se("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(n)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lf.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:t}=Se("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const n=this.expirations.get(t);if(!n){const{message:n}=Se("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return n}checkExpiry(t,n){const{expiry:r}=n;Mn.toMiliseconds(r)-Date.now()<=0&&this.expire(t,n)}expire(t,n){this.expirations.delete(t),this.events.emit(Lf.expired,{target:t,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((t,n)=>this.checkExpiry(n,t)))}registerEventListeners(){this.core.heartbeat.on($s.HEARTBEAT_EVENTS.pulse,(()=>this.checkExpirations())),this.events.on(Lf.created,(t=>{const n=Lf.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})),this.events.on(Lf.expired,(t=>{const n=Lf.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})),this.events.on(Lf.deleted,(t=>{const n=Lf.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}}}class El extends Vo{constructor(t,n){super(t,n),this.projectId=t,this.logger=n,this.name=Vf,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||Tr()||!Mr())return;const t=Ff;this.verifyUrl!==t&&this.removeIframe(),this.verifyUrl=t;try{await this.createIframe()}catch(t){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(t)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Gf;try{await this.createIframe()}catch(t){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(t),this.verifyDisabled=!0}}},this.register=async t=>{this.initialized?this.sendPost(t.attestationId):(this.addToQueue(t.attestationId),await this.init())},this.resolve=async t=>{if(this.isDevEnv)return"";const n=t?.verifyUrl||Ff;let r;try{r=await this.fetchAttestation(t.attestationId,n)}catch(e){this.logger.info(`failed to resolve attestation: ${t.attestationId} from url: ${n}`),this.logger.info(e),r=await this.fetchAttestation(t.attestationId,Gf)}return r},this.fetchAttestation=async(t,n)=>{this.logger.info(`resolving attestation: ${t} from url: ${n}`);const r=this.startAbortTimer(Mn.ONE_SECOND*2),e=await fetch(`${n}/attestation/${t}`,{signal:this.abortController.signal});return clearTimeout(r),e.status===200?await e.json():void 0},this.addToQueue=t=>{this.queue.push(t)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach((t=>this.sendPost(t))),this.queue=[])},this.sendPost=t=>{var n;try{if(!this.iframe)return;(n=this.iframe.contentWindow)==null||n.postMessage(t,"*"),this.logger.info(`postMessage sent: ${t} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let t;const n=r=>{r.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",n),t())};await Promise.race([new Promise((r=>{if(document.getElementById(Vf))return r();window.addEventListener("message",n);const e=document.createElement("iframe");e.id=Vf,e.src=`${this.verifyUrl}/${this.projectId}`,e.style.display="none",document.body.append(e),this.iframe=e,t=r})),new Promise(((t,r)=>setTimeout((()=>{window.removeEventListener("message",n),r("verify iframe load timeout")}),Mn.toMiliseconds(Mn.FIVE_SECONDS))))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=To.generateChildLogger(n,this.name),this.verifyUrl=Ff,this.abortController=new AbortController,this.isDevEnv=$r()&&i.env.IS_VITEST}get context(){return To.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout((()=>this.abortController.abort()),Mn.toMiliseconds(t))}}var Ol=Object.defineProperty,Sl=Object.getOwnPropertySymbols,Il=Object.prototype.hasOwnProperty,jl=Object.prototype.propertyIsEnumerable,Al=(t,n,r)=>n in t?Ol(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,Nl=(t,n)=>{for(var r in n||(n={}))Il.call(n,r)&&Al(t,r,n[r]);if(Sl)for(var r of Sl(n))jl.call(n,r)&&Al(t,r,n[r]);return t};class Pl extends Mo{constructor(n){super(n),this.protocol=Xh,this.version=Yh,this.name=tf,this.events=new t.EventEmitter,this.initialized=!1,this.on=(t,n)=>this.events.on(t,n),this.once=(t,n)=>this.events.once(t,n),this.off=(t,n)=>this.events.off(t,n),this.removeListener=(t,n)=>this.events.removeListener(t,n),this.projectId=n?.projectId,this.relayUrl=n?.relayUrl||wf,this.customStoragePrefix=n!=null&&n.customStoragePrefix?`:${n.customStoragePrefix}`:"";const r=typeof n?.logger<"u"&&typeof n?.logger!="string"?n.logger:To.pino(To.getDefaultLoggerOptions({level:n?.logger||rf.logger}));this.logger=To.generateChildLogger(r,this.name),this.heartbeat=new $s.HeartBeat,this.crypto=new zf(this,this.logger,n?.keychain),this.history=new gl(this,this.logger),this.expirer=new _l(this,this.logger),this.storage=n!=null&&n.storage?n.storage:new Zi(Nl(Nl({},ef),n?.storageOptions)),this.relayer=new fl({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new ml(this,this.logger),this.verify=new El(this.projectId||"",this.logger)}static async init(t){const n=new Pl(t);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(jf,r),n}get context(){return To.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const xl=Pl;class $l{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class Tl{constructor(t){this.client=t}}const Ml="wc",Cl=2,Rl="client",Ul=`${Ml}@${Cl}:${Rl}:`,Dl={name:Rl,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},kl="WALLETCONNECT_DEEPLINK_CHOICE",Ll="proposal",ql="Proposal expired",Vl="session",Fl=Mn.SEVEN_DAYS,Gl="engine",Hl={wc_sessionPropose:{req:{ttl:Mn.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Mn.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Mn.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Mn.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Mn.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Mn.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Mn.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Mn.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Mn.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Mn.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Mn.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Mn.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Mn.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Mn.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Mn.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Mn.THIRTY_SECONDS,prompt:!1,tag:1115}}},zl={min:Mn.FIVE_MINUTES,max:Mn.SEVEN_DAYS},Wl={idle:"IDLE",active:"ACTIVE"},Bl="request",Kl=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Jl=Object.defineProperty,Zl=Object.defineProperties,Ql=Object.getOwnPropertyDescriptors,Xl=Object.getOwnPropertySymbols,Yl=Object.prototype.hasOwnProperty,td=Object.prototype.propertyIsEnumerable,nd=(t,n,r)=>n in t?Jl(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,rd=(t,n)=>{for(var r in n||(n={}))Yl.call(n,r)&&nd(t,r,n[r]);if(Xl)for(var r of Xl(n))td.call(n,r)&&nd(t,r,n[r]);return t},ed=(t,n)=>Zl(t,Ql(n));class id extends Tl{constructor(n){super(n),this.name=Gl,this.events=new t,this.initialized=!1,this.ignoredPayloadTypes=[er],this.requestQueue={state:Wl.idle,queue:[]},this.sessionRequestQueue={state:Wl.idle,queue:[]},this.requestQueueDelay=Mn.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Hl)}),this.initialized=!0,setTimeout((()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()}),Mn.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const n=ed(rd({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:r,requiredNamespaces:e,optionalNamespaces:i,sessionProperties:s,relays:o}=n;let a=r,u,c=!1;if(a&&(c=this.client.core.pairing.pairings.get(a).active),!a||!c){const{topic:t,uri:n}=await this.client.core.pairing.create();a=t,u=n}const h=await this.client.core.crypto.generateKeyPair(),f=rd({requiredNamespaces:e,optionalNamespaces:i,relays:o??[{protocol:pf}],proposer:{publicKey:h,metadata:this.client.metadata}},s&&{sessionProperties:s}),{reject:l,resolve:d,done:p}=Hr(Mn.FIVE_MINUTES,ql);if(this.events.once(Xr("session_connect"),(async({error:t,session:n})=>{if(t)l(t);else if(n){n.self.publicKey=h;const t=ed(rd({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces});await this.client.session.set(n.topic,t),await this.setExpiry(n.topic,n.expiry),a&&await this.client.core.pairing.updateMetadata({topic:a,metadata:n.peer.metadata}),d(t)}})),!a){const{message:t}=Se("NO_MATCHING_KEY",`connect() pairing topic: ${a}`);throw new Error(t)}const v=await this.sendRequest({topic:a,method:"wc_sessionPropose",params:f}),w=Zr(Mn.FIVE_MINUTES);return await this.setProposal(v,rd({id:v,expiry:w},f)),{uri:u,approval:p}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:r,namespaces:e,sessionProperties:i}=t,s=this.client.proposal.get(n);let{pairingTopic:o,proposer:a,requiredNamespaces:u,optionalNamespaces:c}=s;o=o||"",Ae(u)||(u=me(e,"approve()"));const h=await this.client.core.crypto.generateKeyPair(),f=a.publicKey,l=await this.client.core.crypto.generateSharedKey(h,f);o&&n&&(await this.client.core.pairing.updateMetadata({topic:o,metadata:a.metadata}),await this.sendResult({id:n,topic:o,result:{relay:{protocol:r??"irn"},responderPublicKey:h}}),await this.client.proposal.delete(n,Ie("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:o}));const d=rd({relay:{protocol:r??"irn"},namespaces:e,requiredNamespaces:u,optionalNamespaces:c,pairingTopic:o,controller:{publicKey:h,metadata:this.client.metadata},expiry:Zr(Fl)},i&&{sessionProperties:i});await this.client.core.relayer.subscribe(l),await this.sendRequest({topic:l,method:"wc_sessionSettle",params:d,throwOnFailedPublish:!0});const p=ed(rd({},d),{topic:l,pairingTopic:o,acknowledged:!1,self:d.controller,peer:{publicKey:a.publicKey,metadata:a.metadata},controller:h});return await this.client.session.set(l,p),await this.setExpiry(l,Zr(Fl)),{topic:l,acknowledged:()=>new Promise((t=>setTimeout((()=>t(this.client.session.get(l))),500)))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:n,reason:r}=t,{pairingTopic:e}=this.client.proposal.get(n);e&&(await this.sendError(n,e,r),await this.client.proposal.delete(n,Ie("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:r}=t,e=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:r}}),{done:i,resolve:s,reject:o}=Hr();return this.events.once(Xr("session_update",e),(({error:t})=>{t?o(t):s()})),await this.client.session.update(n,{namespaces:r}),{acknowledged:i}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,r=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:e,resolve:i,reject:s}=Hr();return this.events.once(Xr("session_extend",r),(({error:t})=>{t?s(t):i()})),await this.setExpiry(n,Zr(Fl)),{acknowledged:e}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:r,topic:e,expiry:i}=t,s=Nu(),{done:o,resolve:a,reject:u}=Hr(i,"Request expired. Please try again.");return this.events.once(Xr("session_request",s),(({error:t,result:n})=>{t?u(t):a(n)})),await Promise.all([new Promise((async t=>{await this.sendRequest({clientRpcId:s,topic:e,method:"wc_sessionRequest",params:{request:r,chainId:n},expiry:i,throwOnFailedPublish:!0}).catch((t=>u(t))),this.client.events.emit("session_request_sent",{topic:e,request:r,chainId:n,id:s}),t()})),new Promise((async t=>{const n=await this.client.core.storage.getItem(kl);te({id:s,topic:e,wcDeepLink:n}),t()})),o()]).then((t=>t[2]))},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:r}=t,{id:e}=r;Bu(r)?await this.sendResult({id:e,topic:n,result:r.result,throwOnFailedPublish:!0}):Ku(r)&&await this.sendError(e,n,r.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const t=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:r,resolve:e,reject:i}=Hr();this.events.once(Xr("session_ping",t),(({error:t})=>{t?i(t):e()})),await r()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:r,chainId:e}=t;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:r,chainId:e}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Ie("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter((n=>$e(n,t)))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter((r=>{var e,i;return((e=r.peerMetadata)==null?void 0:e.url)&&((i=r.peerMetadata)==null?void 0:i.url)===t.peer.metadata.url&&r.topic&&r.topic!==n.topic}));if(r.length===0)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map((t=>this.client.core.pairing.disconnect({topic:t.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(t){this.client.logger.error(t)}},this.deleteSession=async(t,n)=>{const{self:r}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,Ie("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(r.publicKey)&&await this.client.core.crypto.deleteKeyPair(r.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t),this.client.core.storage.removeItem(kl).catch((t=>this.client.logger.warn(t)))},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,Ie("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),r?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter((n=>n.id!==t)),r&&(this.sessionRequestQueue.state=Wl.idle)},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=Hl.wc_sessionRequest.req.ttl,{id:r,topic:e,params:i,verifyContext:s}=t;await this.client.pendingRequest.set(r,{id:r,topic:e,params:i,verifyContext:s}),n&&this.client.core.expirer.set(r,Zr(n))},this.sendRequest=async t=>{const{topic:n,method:r,params:e,expiry:i,relayRpcId:s,clientRpcId:o,throwOnFailedPublish:a}=t,u=xu(r,e,o);if(Mr()&&Kl.includes(r)){const t=lr(JSON.stringify(u));this.client.core.verify.register({attestationId:t})}const c=await this.client.core.crypto.encode(n,u),h=Hl[r].req;return i&&(h.ttl=i),s&&(h.id=s),this.client.core.history.set(n,u),a?(h.internal=ed(rd({},h.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,c,h)):this.client.core.relayer.publish(n,c,h).catch((t=>this.client.logger.error(t))),u.id},this.sendResult=async t=>{const{id:n,topic:r,result:e,throwOnFailedPublish:i}=t,s=$u(n,e),o=await this.client.core.crypto.encode(r,s),a=await this.client.core.history.get(r,n),u=Hl[a.request.method].res;i?(u.internal=ed(rd({},u.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,o,u)):this.client.core.relayer.publish(r,o,u).catch((t=>this.client.logger.error(t))),await this.client.core.history.resolve(s)},this.sendError=async(t,n,r)=>{const e=Tu(t,r),i=await this.client.core.crypto.encode(n,e),s=await this.client.core.history.get(n,t),o=Hl[s.request.method].res;this.client.core.relayer.publish(n,i,o),await this.client.core.history.resolve(e)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach((n=>{Qr(n.expiry)&&t.push(n.topic)})),this.client.proposal.getAll().forEach((t=>{Qr(t.expiry)&&n.push(t.id)})),await Promise.all([...t.map((t=>this.deleteSession(t))),...n.map((t=>this.deleteProposal(t)))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Wl.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Wl.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise((t=>setTimeout(t,300)))}catch(t){this.client.logger.warn(t)}}this.requestQueue.state=Wl.idle},this.processRequest=t=>{const{topic:n,payload:r}=t,e=r.method;switch(e){case"wc_sessionPropose":return this.onSessionProposeRequest(n,r);case"wc_sessionSettle":return this.onSessionSettleRequest(n,r);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,r);case"wc_sessionExtend":return this.onSessionExtendRequest(n,r);case"wc_sessionPing":return this.onSessionPingRequest(n,r);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,r);case"wc_sessionRequest":return this.onSessionRequest(n,r);case"wc_sessionEvent":return this.onSessionEventRequest(n,r);default:return this.client.logger.info(`Unsupported request method ${e}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:r}=t,e=(await this.client.core.history.get(n,r.id)).request.method;switch(e){case"wc_sessionPropose":return this.onSessionProposeResponse(n,r);case"wc_sessionSettle":return this.onSessionSettleResponse(n,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,r);case"wc_sessionExtend":return this.onSessionExtendResponse(n,r);case"wc_sessionPing":return this.onSessionPingResponse(n,r);case"wc_sessionRequest":return this.onSessionRequestResponse(n,r);default:return this.client.logger.info(`Unsupported response method ${e}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:r}=Se("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)},this.onSessionProposeRequest=async(t,n)=>{const{params:r,id:e}=n;try{this.isValidConnect(rd({},n.params));const i=Zr(Mn.FIVE_MINUTES),s=rd({id:e,pairingTopic:t,expiry:i},r);await this.setProposal(e,s);const o=lr(JSON.stringify(n)),a=await this.getVerifyContext(o,s.proposer.metadata);this.client.events.emit("session_proposal",{id:e,params:s,verifyContext:a})}catch(n){await this.sendError(e,t,n),this.client.logger.error(n)}},this.onSessionProposeResponse=async(t,n)=>{const{id:r}=n;if(Bu(n)){const{result:e}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:e});const i=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:i});const s=i.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const o=e.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});const a=await this.client.core.crypto.generateSharedKey(s,o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:a});const u=await this.client.core.relayer.subscribe(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:u}),await this.client.core.pairing.activate({topic:t})}else Ku(n)&&(await this.client.proposal.delete(r,Ie("USER_DISCONNECTED")),this.events.emit(Xr("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:r,params:e}=n;try{this.isValidSessionSettleRequest(e);const{relay:r,controller:i,expiry:s,namespaces:o,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:c,pairingTopic:h}=n.params,f=rd({topic:t,relay:r,expiry:s,namespaces:o,acknowledged:!0,pairingTopic:h,requiredNamespaces:a,optionalNamespaces:u,controller:i.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},c&&{sessionProperties:c});await this.sendResult({id:n.id,topic:t,result:!0}),this.events.emit(Xr("session_connect"),{session:f}),this.cleanupDuplicatePairings(f)}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionSettleResponse=async(t,n)=>{const{id:r}=n;Bu(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Xr("session_approve",r),{})):Ku(n)&&(await this.client.session.delete(t,Ie("USER_DISCONNECTED")),this.events.emit(Xr("session_approve",r),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:r,id:e}=n;try{const n=`${t}_session_update`,i=yi.get(n);if(i&&this.isRequestOutOfSync(i,e)){this.client.logger.info(`Discarding out of sync request - ${e}`);return}this.isValidUpdate(rd({topic:t},r)),await this.client.session.update(t,{namespaces:r.namespaces}),await this.sendResult({id:e,topic:t,result:!0}),this.client.events.emit("session_update",{id:e,topic:t,params:r}),yi.set(n,e)}catch(n){await this.sendError(e,t,n),this.client.logger.error(n)}},this.isRequestOutOfSync=(t,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,n)=>{const{id:r}=n;Bu(n)?this.events.emit(Xr("session_update",r),{}):Ku(n)&&this.events.emit(Xr("session_update",r),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:r}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Zr(Fl)),await this.sendResult({id:r,topic:t,result:!0}),this.client.events.emit("session_extend",{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionExtendResponse=(t,n)=>{const{id:r}=n;Bu(n)?this.events.emit(Xr("session_extend",r),{}):Ku(n)&&this.events.emit(Xr("session_extend",r),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:r}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:r,topic:t,result:!0}),this.client.events.emit("session_ping",{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionPingResponse=(t,n)=>{const{id:r}=n;setTimeout((()=>{Bu(n)?this.events.emit(Xr("session_ping",r),{}):Ku(n)&&this.events.emit(Xr("session_ping",r),{error:n.error})}),500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:r}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise((n=>{this.client.core.relayer.once(mf.publish,(async()=>{n(await this.deleteSession(t))}))})),this.sendResult({id:r,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:r,topic:t})}catch(t){this.client.logger.error(t)}},this.onSessionRequest=async(t,n)=>{const{id:r,params:e}=n;try{this.isValidRequest(rd({topic:t},e));const n=lr(JSON.stringify(xu("wc_sessionRequest",e,r))),i=this.client.session.get(t),s=await this.getVerifyContext(n,i.peer.metadata),o={id:r,topic:t,params:e,verifyContext:s};await this.setPendingSessionRequest(o),this.addSessionRequestToSessionRequestQueue(o),this.processSessionRequestQueue()}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionRequestResponse=(t,n)=>{const{id:r}=n;Bu(n)?this.events.emit(Xr("session_request",r),{result:n.result}):Ku(n)&&this.events.emit(Xr("session_request",r),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:r,params:e}=n;try{const n=`${t}_session_event_${e.event.name}`,i=yi.get(n);if(i&&this.isRequestOutOfSync(i,r)){this.client.logger.info(`Discarding out of sync request - ${r}`);return}this.isValidEmit(rd({topic:t},e)),this.client.events.emit("session_event",{id:r,topic:t,params:e}),yi.set(n,r)}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.sessionRequestQueue.state=Wl.idle,this.processSessionRequestQueue()}),Mn.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Wl.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Wl.active,this.client.events.emit("session_request",t)}catch(t){this.client.logger.error(t)}},this.onPairingCreated=t=>{if(t.active)return;const n=this.client.proposal.getAll().find((n=>n.pairingTopic===t.topic));n&&this.onSessionProposeRequest(t.topic,xu("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(n)}const{pairingTopic:n,requiredNamespaces:r,optionalNamespaces:e,sessionProperties:i,relays:s}=t;if(Ne(n)||await this.isValidPairingTopic(n),!Ke(s,!0)){const{message:t}=Se("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(t)}!Ne(r)&&Ae(r)!==0&&this.validateNamespaces(r,"requiredNamespaces"),!Ne(e)&&Ae(e)!==0&&this.validateNamespaces(e,"optionalNamespaces"),Ne(i)||this.validateSessionProps(i,"sessionProperties")},this.validateNamespaces=(t,n)=>{const r=ze(t,"connect()",n);if(r)throw new Error(r.message)},this.isValidApprove=async t=>{if(!Ze(t))throw new Error(Se("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:r,relayProtocol:e,sessionProperties:i}=t;await this.isValidProposalId(n);const s=this.client.proposal.get(n),o=We(r,"approve()");if(o)throw new Error(o.message);const a=ii(s.requiredNamespaces,r,"approve()");if(a)throw new Error(a.message);if(!Pe(e,!0)){const{message:t}=Se("MISSING_OR_INVALID",`approve() relayProtocol: ${e}`);throw new Error(t)}Ne(i)||this.validateSessionProps(i,"sessionProperties")},this.isValidReject=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(n)}const{id:n,reason:r}=t;if(await this.isValidProposalId(n),!Qe(r)){const{message:t}=Se("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidSessionSettleRequest=t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(n)}const{relay:n,controller:r,namespaces:e,expiry:i}=t;if(!Be(n)){const{message:t}=Se("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(t)}const s=De(r,"onSessionSettleRequest()");if(s)throw new Error(s.message);const o=We(e,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(Qr(i)){const{message:t}=Se("EXPIRED","onSessionSettleRequest()");throw new Error(t)}},this.isValidUpdate=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(n)}const{topic:n,namespaces:r}=t;await this.isValidSessionTopic(n);const e=this.client.session.get(n),i=We(r,"update()");if(i)throw new Error(i.message);const s=ii(e.requiredNamespaces,r,"update()");if(s)throw new Error(s.message)},this.isValidExtend=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(n)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(n)}const{topic:n,request:r,chainId:e,expiry:i}=t;await this.isValidSessionTopic(n);const{namespaces:s}=this.client.session.get(n);if(!ni(s,e)){const{message:t}=Se("MISSING_OR_INVALID",`request() chainId: ${e}`);throw new Error(t)}if(!Xe(r)){const{message:t}=Se("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(t)}if(!ri(s,e,r.method)){const{message:t}=Se("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(t)}if(i&&!ui(i,zl)){const{message:t}=Se("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${zl.min} and ${zl.max}`);throw new Error(t)}},this.isValidRespond=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(n)}const{topic:n,response:r}=t;if(await this.isValidSessionTopic(n),!Ye(r)){const{message:t}=Se("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidPing=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(n)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(n)}const{topic:n,event:r,chainId:e}=t;await this.isValidSessionTopic(n);const{namespaces:i}=this.client.session.get(n);if(!ni(i,e)){const{message:t}=Se("MISSING_OR_INVALID",`emit() chainId: ${e}`);throw new Error(t)}if(!ti(r)){const{message:t}=Se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}if(!ei(i,e,r.name)){const{message:t}=Se("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidDisconnect=async t=>{if(!Ze(t)){const{message:n}=Se("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(n)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const r={verified:{verifyUrl:n.verifyUrl||Ff,validation:"UNKNOWN",origin:n.url||""}};try{const e=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});e&&(r.verified.origin=e.origin,r.verified.isScam=e.isScam,r.verified.validation=e.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(t){this.client.logger.info(t)}return this.client.logger.info(`Verify context: ${JSON.stringify(r)}`),r},this.validateSessionProps=(t,n)=>{Object.values(t).forEach((t=>{if(!Pe(t,!1)){const{message:r}=Se("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(t)}`);throw new Error(r)}}))}}async isInitialized(){if(!this.initialized){const{message:t}=Se("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(mf.message,(async t=>{const{topic:n,message:r}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(r)))return;const e=await this.client.core.crypto.decode(n,r);try{zu(e)?(this.client.core.history.set(n,e),this.onRelayEventRequest({topic:n,payload:e})):Wu(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:n,payload:e}),this.client.core.history.delete(n,e.id)):this.onRelayEventUnknownPayload({topic:n,payload:e})}catch(t){this.client.logger.error(t)}}))}registerExpirerEvents(){this.client.core.expirer.on(Lf.expired,(async t=>{const{topic:n,id:r}=Jr(t.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Se("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession(n,!0),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))}))}registerPairingEvents(){this.client.core.pairing.events.on(Cf.create,(t=>this.onPairingCreated(t)))}isValidPairingTopic(t){if(!Pe(t,!1)){const{message:n}=Se("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:n}=Se("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(n)}if(Qr(this.client.core.pairing.pairings.get(t).expiry)){const{message:n}=Se("EXPIRED",`pairing topic: ${t}`);throw new Error(n)}}async isValidSessionTopic(t){if(!Pe(t,!1)){const{message:n}=Se("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(n)}if(!this.client.session.keys.includes(t)){const{message:n}=Se("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(n)}if(Qr(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:n}=Se("EXPIRED",`session topic: ${t}`);throw new Error(n)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Pe(t,!1)){const{message:n}=Se("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(n)}else{const{message:n}=Se("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(n)}}async isValidProposalId(t){if(!Je(t)){const{message:n}=Se("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(n)}if(!this.client.proposal.keys.includes(t)){const{message:n}=Se("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(n)}if(Qr(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:n}=Se("EXPIRED",`proposal id: ${t}`);throw new Error(n)}}}class sd extends bl{constructor(t,n){super(t,n,Ll,Ul),this.core=t,this.logger=n}}class od extends bl{constructor(t,n){super(t,n,Vl,Ul),this.core=t,this.logger=n}}class ad extends bl{constructor(t,n){super(t,n,Bl,Ul,(t=>t.id)),this.core=t,this.logger=n}}class ud extends $l{constructor(n){super(n),this.protocol=Ml,this.version=Cl,this.name=Dl.name,this.events=new t.EventEmitter,this.on=(t,n)=>this.events.on(t,n),this.once=(t,n)=>this.events.once(t,n),this.off=(t,n)=>this.events.off(t,n),this.removeListener=(t,n)=>this.events.removeListener(t,n),this.removeAllListeners=t=>this.events.removeAllListeners(t),this.connect=async t=>{try{return await this.engine.connect(t)}catch(t){throw this.logger.error(t.message),t}},this.pair=async t=>{try{return await this.engine.pair(t)}catch(t){throw this.logger.error(t.message),t}},this.approve=async t=>{try{return await this.engine.approve(t)}catch(t){throw this.logger.error(t.message),t}},this.reject=async t=>{try{return await this.engine.reject(t)}catch(t){throw this.logger.error(t.message),t}},this.update=async t=>{try{return await this.engine.update(t)}catch(t){throw this.logger.error(t.message),t}},this.extend=async t=>{try{return await this.engine.extend(t)}catch(t){throw this.logger.error(t.message),t}},this.request=async t=>{try{return await this.engine.request(t)}catch(t){throw this.logger.error(t.message),t}},this.respond=async t=>{try{return await this.engine.respond(t)}catch(t){throw this.logger.error(t.message),t}},this.ping=async t=>{try{return await this.engine.ping(t)}catch(t){throw this.logger.error(t.message),t}},this.emit=async t=>{try{return await this.engine.emit(t)}catch(t){throw this.logger.error(t.message),t}},this.disconnect=async t=>{try{return await this.engine.disconnect(t)}catch(t){throw this.logger.error(t.message),t}},this.find=t=>{try{return this.engine.find(t)}catch(t){throw this.logger.error(t.message),t}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(t){throw this.logger.error(t.message),t}},this.name=n?.name||Dl.name,this.metadata=n?.metadata||Ur();const r=typeof n?.logger<"u"&&typeof n?.logger!="string"?n.logger:To.pino(To.getDefaultLoggerOptions({level:n?.logger||Dl.logger}));this.core=n?.core||new xl(n),this.logger=To.generateChildLogger(r,this.name),this.session=new od(this.core,this.logger),this.proposal=new sd(this.core,this.logger),this.pendingRequest=new ad(this.core,this.logger),this.engine=new id(this)}static async init(t){const n=new ud(t);return await n.initialize(),n}get context(){return To.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}var cd=n((function(t,n){var r=typeof self!=="undefined"?self:a;var e=function(){function t(){this.fetch=false;this.DOMException=r.DOMException}t.prototype=r;return new t}();(function(t){(function(n){var r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{new Blob;return true}catch(t){return false}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function e(t){return t&&DataView.prototype.isPrototypeOf(t)}if(r.arrayBuffer){var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"];var s=ArrayBuffer.isView||function(t){return t&&i.indexOf(Object.prototype.toString.call(t))>-1}}function o(t){if(typeof t!=="string"){t=String(t)}if(/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t)){throw new TypeError("Invalid character in header field name")}return t.toLowerCase()}function a(t){if(typeof t!=="string"){t=String(t)}return t}function u(t){var n={next:function(){var n=t.shift();return{done:n===undefined,value:n}}};if(r.iterable){n[Symbol.iterator]=function(){return n}}return n}function c(t){this.map={};if(t instanceof c){t.forEach((function(t,n){this.append(n,t)}),this)}else if(Array.isArray(t)){t.forEach((function(t){this.append(t[0],t[1])}),this)}else if(t){Object.getOwnPropertyNames(t).forEach((function(n){this.append(n,t[n])}),this)}}c.prototype.append=function(t,n){t=o(t);n=a(n);var r=this.map[t];this.map[t]=r?r+", "+n:n};c.prototype["delete"]=function(t){delete this.map[o(t)]};c.prototype.get=function(t){t=o(t);return this.has(t)?this.map[t]:null};c.prototype.has=function(t){return this.map.hasOwnProperty(o(t))};c.prototype.set=function(t,n){this.map[o(t)]=a(n)};c.prototype.forEach=function(t,n){for(var r in this.map){if(this.map.hasOwnProperty(r)){t.call(n,this.map[r],r,this)}}};c.prototype.keys=function(){var t=[];this.forEach((function(n,r){t.push(r)}));return u(t)};c.prototype.values=function(){var t=[];this.forEach((function(n){t.push(n)}));return u(t)};c.prototype.entries=function(){var t=[];this.forEach((function(n,r){t.push([r,n])}));return u(t)};if(r.iterable){c.prototype[Symbol.iterator]=c.prototype.entries}function h(t){if(t.bodyUsed){return Promise.reject(new TypeError("Already read"))}t.bodyUsed=true}function f(t){return new Promise((function(n,r){t.onload=function(){n(t.result)};t.onerror=function(){r(t.error)}}))}function l(t){var n=new FileReader;var r=f(n);n.readAsArrayBuffer(t);return r}function d(t){var n=new FileReader;var r=f(n);n.readAsText(t);return r}function p(t){var n=new Uint8Array(t);var r=new Array(n.length);for(var e=0;e<n.length;e++){r[e]=String.fromCharCode(n[e])}return r.join("")}function v(t){if(t.slice){return t.slice(0)}else{var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(t));return n.buffer}}function w(){this.bodyUsed=false;this._initBody=function(t){this._bodyInit=t;if(!t){this._bodyText=""}else if(typeof t==="string"){this._bodyText=t}else if(r.blob&&Blob.prototype.isPrototypeOf(t)){this._bodyBlob=t}else if(r.formData&&FormData.prototype.isPrototypeOf(t)){this._bodyFormData=t}else if(r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)){this._bodyText=t.toString()}else if(r.arrayBuffer&&r.blob&&e(t)){this._bodyArrayBuffer=v(t.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else if(r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))){this._bodyArrayBuffer=v(t)}else{this._bodyText=t=Object.prototype.toString.call(t)}if(!this.headers.get("content-type")){if(typeof t==="string"){this.headers.set("content-type","text/plain;charset=UTF-8")}else if(this._bodyBlob&&this._bodyBlob.type){this.headers.set("content-type",this._bodyBlob.type)}else if(r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)){this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8")}}};if(r.blob){this.blob=function(){var t=h(this);if(t){return t}if(this._bodyBlob){return Promise.resolve(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(new Blob([this._bodyArrayBuffer]))}else if(this._bodyFormData){throw new Error("could not read FormData body as blob")}else{return Promise.resolve(new Blob([this._bodyText]))}};this.arrayBuffer=function(){if(this._bodyArrayBuffer){return h(this)||Promise.resolve(this._bodyArrayBuffer)}else{return this.blob().then(l)}}}this.text=function(){var t=h(this);if(t){return t}if(this._bodyBlob){return d(this._bodyBlob)}else if(this._bodyArrayBuffer){return Promise.resolve(p(this._bodyArrayBuffer))}else if(this._bodyFormData){throw new Error("could not read FormData body as text")}else{return Promise.resolve(this._bodyText)}};if(r.formData){this.formData=function(){return this.text().then(g)}}this.json=function(){return this.text().then(JSON.parse)};return this}var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t){var n=t.toUpperCase();return y.indexOf(n)>-1?n:t}function m(t,n){n=n||{};var r=n.body;if(t instanceof m){if(t.bodyUsed){throw new TypeError("Already read")}this.url=t.url;this.credentials=t.credentials;if(!n.headers){this.headers=new c(t.headers)}this.method=t.method;this.mode=t.mode;this.signal=t.signal;if(!r&&t._bodyInit!=null){r=t._bodyInit;t.bodyUsed=true}}else{this.url=String(t)}this.credentials=n.credentials||this.credentials||"same-origin";if(n.headers||!this.headers){this.headers=new c(n.headers)}this.method=b(n.method||this.method||"GET");this.mode=n.mode||this.mode||null;this.signal=n.signal||this.signal;this.referrer=null;if((this.method==="GET"||this.method==="HEAD")&&r){throw new TypeError("Body not allowed for GET or HEAD requests")}this._initBody(r)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function g(t){var n=new FormData;t.trim().split("&").forEach((function(t){if(t){var r=t.split("=");var e=r.shift().replace(/\+/g," ");var i=r.join("=").replace(/\+/g," ");n.append(decodeURIComponent(e),decodeURIComponent(i))}}));return n}function _(t){var n=new c;var r=t.replace(/\r?\n[\t ]+/g," ");r.split(/\r?\n/).forEach((function(t){var r=t.split(":");var e=r.shift().trim();if(e){var i=r.join(":").trim();n.append(e,i)}}));return n}w.call(m.prototype);function E(t,n){if(!n){n={}}this.type="default";this.status=n.status===undefined?200:n.status;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in n?n.statusText:"OK";this.headers=new c(n.headers);this.url=n.url||"";this._initBody(t)}w.call(E.prototype);E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})};E.error=function(){var t=new E(null,{status:0,statusText:""});t.type="error";return t};var O=[301,302,303,307,308];E.redirect=function(t,n){if(O.indexOf(n)===-1){throw new RangeError("Invalid status code")}return new E(null,{status:n,headers:{location:t}})};n.DOMException=t.DOMException;try{new n.DOMException}catch(t){n.DOMException=function(t,n){this.message=t;this.name=n;var r=Error(t);this.stack=r.stack};n.DOMException.prototype=Object.create(Error.prototype);n.DOMException.prototype.constructor=n.DOMException}function S(t,e){return new Promise((function(i,s){var o=new m(t,e);if(o.signal&&o.signal.aborted){return s(new n.DOMException("Aborted","AbortError"))}var a=new XMLHttpRequest;function u(){a.abort()}a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:_(a.getAllResponseHeaders()||"")};t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL");var n="response"in a?a.response:a.responseText;i(new E(n,t))};a.onerror=function(){s(new TypeError("Network request failed"))};a.ontimeout=function(){s(new TypeError("Network request failed"))};a.onabort=function(){s(new n.DOMException("Aborted","AbortError"))};a.open(o.method,o.url,true);if(o.credentials==="include"){a.withCredentials=true}else if(o.credentials==="omit"){a.withCredentials=false}if("responseType"in a&&r.blob){a.responseType="blob"}o.headers.forEach((function(t,n){a.setRequestHeader(n,t)}));if(o.signal){o.signal.addEventListener("abort",u);a.onreadystatechange=function(){if(a.readyState===4){o.signal.removeEventListener("abort",u)}}}a.send(typeof o._bodyInit==="undefined"?null:o._bodyInit)}))}S.polyfill=true;if(!t.fetch){t.fetch=S;t.Headers=c;t.Request=m;t.Response=E}n.Headers=c;n.Request=m;n.Response=E;n.fetch=S;Object.defineProperty(n,"__esModule",{value:true});return n})({})})(e);e.fetch.ponyfill=true;delete e.fetch.polyfill;var i=e;n=i.fetch;n.default=i.fetch;n.fetch=i.fetch;n.Headers=i.Headers;n.Request=i.Request;n.Response=i.Response;t.exports=n}));const hd=u(cd);const fd=t=>JSON.stringify(t,((t,n)=>typeof n==="bigint"?n.toString()+"n":n));const ld=t=>{const n=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g;const r=t.replace(n,'$1"$2n"$3');return JSON.parse(r,((t,n)=>{const r=typeof n==="string"&&n.match(/^\d+n$/);if(r)return BigInt(n.substring(0,n.length-1));return n}))};function dd(t){if(typeof t!=="string"){throw new Error(`Cannot safe json parse value of type ${typeof t}`)}try{return ld(t)}catch(n){return t}}function pd(t){return typeof t==="string"?t:fd(t)||""}const vd={Accept:"application/json","Content-Type":"application/json"};const wd="POST";const yd={headers:vd,method:wd};const bd=10;class md{constructor(n,r=false){this.url=n;this.disableProviderPing=r;this.events=new t.EventEmitter;this.isAvailable=false;this.registering=false;if(!Vu(n)){throw new Error(`Provided URL is not compatible with HTTP connection: ${n}`)}this.url=n;this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable){throw new Error("Connection already closed")}this.onClose()}async send(t,n){if(!this.isAvailable){await this.register()}try{const n=pd(t);const r=await hd(this.url,Object.assign(Object.assign({},yd),{body:n}));const e=await r.json();this.onPayload({data:e})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!Vu(t)){throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`)}if(this.registering){const t=this.events.getMaxListeners();if(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t){this.events.setMaxListeners(t+1)}return new Promise(((t,n)=>{this.events.once("register_error",(t=>{this.resetMaxListeners();n(t)}));this.events.once("open",(()=>{this.resetMaxListeners();if(typeof this.isAvailable==="undefined"){return n(new Error("HTTP connection is missing or invalid"))}t()}))}))}this.url=t;this.registering=true;try{if(!this.disableProviderPing){const n=pd({id:1,jsonrpc:"2.0",method:"test",params:[]});await hd(t,Object.assign(Object.assign({},yd),{body:n}))}this.onOpen()}catch(t){const n=this.parseError(t);this.events.emit("register_error",n);this.onClose();throw n}}onOpen(){this.isAvailable=true;this.registering=false;this.events.emit("open")}onClose(){this.isAvailable=false;this.registering=false;this.events.emit("close")}onPayload(t){if(typeof t.data==="undefined")return;const n=typeof t.data==="string"?dd(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n);const e=r.message||r.toString();const i=Tu(t,e);this.events.emit("payload",i)}parseError(t,n=this.url){return Xa(t,n,"HTTP")}resetMaxListeners(){if(this.events.getMaxListeners()>bd){this.events.setMaxListeners(bd)}}}const gd="info",_d="wss://relay.walletconnect.com",Ed="wc",Od="universal_provider",Sd=`${Ed}@2:${Od}:`,Id="https://rpc.walletconnect.com/v1/",jd={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Ad=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof o<"u"?o:typeof self<"u"?self:{},Nd={exports:{}};
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(t,n){(function(){var r,e="4.17.21",i=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",c=500,h="__lodash_placeholder__",f=1,l=2,d=4,p=1,v=2,w=1,y=2,b=4,m=8,g=16,_=32,E=64,O=128,S=256,I=512,j=30,A="...",N=800,P=16,x=1,$=2,T=3,M=1/0,C=9007199254740991,R=17976931348623157e292,U=0/0,D=4294967295,k=D-1,L=D>>>1,q=[["ary",O],["bind",w],["bindKey",y],["curry",m],["curryRight",g],["flip",I],["partial",_],["partialRight",E],["rearg",S]],V="[object Arguments]",F="[object Array]",G="[object AsyncFunction]",H="[object Boolean]",z="[object Date]",W="[object DOMException]",B="[object Error]",K="[object Function]",J="[object GeneratorFunction]",Z="[object Map]",Q="[object Number]",X="[object Null]",Y="[object Object]",tt="[object Promise]",nt="[object Proxy]",rt="[object RegExp]",et="[object Set]",it="[object String]",st="[object Symbol]",ot="[object Undefined]",at="[object WeakMap]",ut="[object WeakSet]",ct="[object ArrayBuffer]",ht="[object DataView]",ft="[object Float32Array]",lt="[object Float64Array]",dt="[object Int8Array]",pt="[object Int16Array]",vt="[object Int32Array]",wt="[object Uint8Array]",yt="[object Uint8ClampedArray]",bt="[object Uint16Array]",mt="[object Uint32Array]",gt=/\b__p \+= '';/g,_t=/\b(__p \+=) '' \+/g,Et=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ot=/&(?:amp|lt|gt|quot|#39);/g,St=/[&<>"']/g,It=RegExp(Ot.source),jt=RegExp(St.source),At=/<%-([\s\S]+?)%>/g,Nt=/<%([\s\S]+?)%>/g,Pt=/<%=([\s\S]+?)%>/g,xt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,$t=/^\w*$/,Tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mt=/[\\^$.*+?()[\]{}|]/g,Ct=RegExp(Mt.source),Rt=/^\s+/,Ut=/\s/,Dt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,kt=/\{\n\/\* \[wrapped with (.+)\] \*/,Lt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Vt=/[()=,{}\[\]\/\s]/,Ft=/\\(\\)?/g,Gt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ht=/\w*$/,zt=/^[-+]0x[0-9a-f]+$/i,Wt=/^0b[01]+$/i,Bt=/^\[object .+?Constructor\]$/,Kt=/^0o[0-7]+$/i,Jt=/^(?:0|[1-9]\d*)$/,Zt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Qt=/($^)/,Xt=/['\n\r\u2028\u2029\\]/g,Yt="\\ud800-\\udfff",tn="\\u0300-\\u036f",nn="\\ufe20-\\ufe2f",rn="\\u20d0-\\u20ff",en=tn+nn+rn,sn="\\u2700-\\u27bf",on="a-z\\xdf-\\xf6\\xf8-\\xff",an="\\xac\\xb1\\xd7\\xf7",un="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cn="\\u2000-\\u206f",hn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",fn="A-Z\\xc0-\\xd6\\xd8-\\xde",ln="\\ufe0e\\ufe0f",dn=an+un+cn+hn,pn="['’]",vn="["+Yt+"]",wn="["+dn+"]",yn="["+en+"]",bn="\\d+",mn="["+sn+"]",gn="["+on+"]",_n="[^"+Yt+dn+bn+sn+on+fn+"]",En="\\ud83c[\\udffb-\\udfff]",On="(?:"+yn+"|"+En+")",Sn="[^"+Yt+"]",In="(?:\\ud83c[\\udde6-\\uddff]){2}",jn="[\\ud800-\\udbff][\\udc00-\\udfff]",An="["+fn+"]",Nn="\\u200d",Pn="(?:"+gn+"|"+_n+")",xn="(?:"+An+"|"+_n+")",$n="(?:"+pn+"(?:d|ll|m|re|s|t|ve))?",Tn="(?:"+pn+"(?:D|LL|M|RE|S|T|VE))?",Mn=On+"?",Cn="["+ln+"]?",Rn="(?:"+Nn+"(?:"+[Sn,In,jn].join("|")+")"+Cn+Mn+")*",Un="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Dn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",kn=Cn+Mn+Rn,Ln="(?:"+[mn,In,jn].join("|")+")"+kn,qn="(?:"+[Sn+yn+"?",yn,In,jn,vn].join("|")+")",Vn=RegExp(pn,"g"),Fn=RegExp(yn,"g"),Gn=RegExp(En+"(?="+En+")|"+qn+kn,"g"),Hn=RegExp([An+"?"+gn+"+"+$n+"(?="+[wn,An,"$"].join("|")+")",xn+"+"+Tn+"(?="+[wn,An+Pn,"$"].join("|")+")",An+"?"+Pn+"+"+$n,An+"+"+Tn,Dn,Un,bn,Ln].join("|"),"g"),zn=RegExp("["+Nn+Yt+en+ln+"]"),Wn=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Bn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Kn=-1,Jn={};Jn[ft]=Jn[lt]=Jn[dt]=Jn[pt]=Jn[vt]=Jn[wt]=Jn[yt]=Jn[bt]=Jn[mt]=!0,Jn[V]=Jn[F]=Jn[ct]=Jn[H]=Jn[ht]=Jn[z]=Jn[B]=Jn[K]=Jn[Z]=Jn[Q]=Jn[Y]=Jn[rt]=Jn[et]=Jn[it]=Jn[at]=!1;var Zn={};Zn[V]=Zn[F]=Zn[ct]=Zn[ht]=Zn[H]=Zn[z]=Zn[ft]=Zn[lt]=Zn[dt]=Zn[pt]=Zn[vt]=Zn[Z]=Zn[Q]=Zn[Y]=Zn[rt]=Zn[et]=Zn[it]=Zn[st]=Zn[wt]=Zn[yt]=Zn[bt]=Zn[mt]=!0,Zn[B]=Zn[K]=Zn[at]=!1;var Qn={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Xn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Yn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},nr=parseFloat,rr=parseInt,er=typeof Ad=="object"&&Ad&&Ad.Object===Object&&Ad,ir=typeof self=="object"&&self&&self.Object===Object&&self,sr=er||ir||Function("return this")(),or=n&&!n.nodeType&&n,ar=or&&!0&&t&&!t.nodeType&&t,ur=ar&&ar.exports===or,cr=ur&&er.process,hr=function(){try{var t=ar&&ar.require&&ar.require("util").types;return t||cr&&cr.binding&&cr.binding("util")}catch{}}(),fr=hr&&hr.isArrayBuffer,lr=hr&&hr.isDate,dr=hr&&hr.isMap,pr=hr&&hr.isRegExp,vr=hr&&hr.isSet,wr=hr&&hr.isTypedArray;function yr(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}function br(t,n,r,e){for(var i=-1,s=t==null?0:t.length;++i<s;){var o=t[i];n(e,o,r(o),t)}return e}function mr(t,n){for(var r=-1,e=t==null?0:t.length;++r<e&&n(t[r],r,t)!==!1;);return t}function gr(t,n){for(var r=t==null?0:t.length;r--&&n(t[r],r,t)!==!1;);return t}function _r(t,n){for(var r=-1,e=t==null?0:t.length;++r<e;)if(!n(t[r],r,t))return!1;return!0}function Er(t,n){for(var r=-1,e=t==null?0:t.length,i=0,s=[];++r<e;){var o=t[r];n(o,r,t)&&(s[i++]=o)}return s}function Or(t,n){var r=t==null?0:t.length;return!!r&&Rr(t,n,0)>-1}function Sr(t,n,r){for(var e=-1,i=t==null?0:t.length;++e<i;)if(r(n,t[e]))return!0;return!1}function Ir(t,n){for(var r=-1,e=t==null?0:t.length,i=Array(e);++r<e;)i[r]=n(t[r],r,t);return i}function jr(t,n){for(var r=-1,e=n.length,i=t.length;++r<e;)t[i+r]=n[r];return t}function Ar(t,n,r,e){var i=-1,s=t==null?0:t.length;for(e&&s&&(r=t[++i]);++i<s;)r=n(r,t[i],i,t);return r}function Nr(t,n,r,e){var i=t==null?0:t.length;for(e&&i&&(r=t[--i]);i--;)r=n(r,t[i],i,t);return r}function Pr(t,n){for(var r=-1,e=t==null?0:t.length;++r<e;)if(n(t[r],r,t))return!0;return!1}var xr=Lr("length");function $r(t){return t.split("")}function Tr(t){return t.match(qt)||[]}function Mr(t,n,r){var e;return r(t,(function(t,r,i){if(n(t,r,i))return e=r,!1})),e}function Cr(t,n,r,e){for(var i=t.length,s=r+(e?1:-1);e?s--:++s<i;)if(n(t[s],s,t))return s;return-1}function Rr(t,n,r){return n===n?fe(t,n,r):Cr(t,Dr,r)}function Ur(t,n,r,e){for(var i=r-1,s=t.length;++i<s;)if(e(t[i],n))return i;return-1}function Dr(t){return t!==t}function kr(t,n){var r=t==null?0:t.length;return r?Gr(t,n)/r:U}function Lr(t){return function(n){return n==null?r:n[t]}}function qr(t){return function(n){return t==null?r:t[n]}}function Vr(t,n,r,e,i){return i(t,(function(t,i,s){r=e?(e=!1,t):n(r,t,i,s)})),r}function Fr(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}function Gr(t,n){for(var e,i=-1,s=t.length;++i<s;){var o=n(t[i]);o!==r&&(e=e===r?o:e+o)}return e}function Hr(t,n){for(var r=-1,e=Array(t);++r<t;)e[r]=n(r);return e}function zr(t,n){return Ir(n,(function(n){return[n,t[n]]}))}function Wr(t){return t&&t.slice(0,ve(t)+1).replace(Rt,"")}function Br(t){return function(n){return t(n)}}function Kr(t,n){return Ir(n,(function(n){return t[n]}))}function Jr(t,n){return t.has(n)}function Zr(t,n){for(var r=-1,e=t.length;++r<e&&Rr(n,t[r],0)>-1;);return r}function Qr(t,n){for(var r=t.length;r--&&Rr(n,t[r],0)>-1;);return r}function Xr(t,n){for(var r=t.length,e=0;r--;)t[r]===n&&++e;return e}var Yr=qr(Qn),te=qr(Xn);function ne(t){return"\\"+tr[t]}function re(t,n){return t==null?r:t[n]}function ee(t){return zn.test(t)}function ie(t){return Wn.test(t)}function se(t){for(var n,r=[];!(n=t.next()).done;)r.push(n.value);return r}function oe(t){var n=-1,r=Array(t.size);return t.forEach((function(t,e){r[++n]=[e,t]})),r}function ae(t,n){return function(r){return t(n(r))}}function ue(t,n){for(var r=-1,e=t.length,i=0,s=[];++r<e;){var o=t[r];(o===n||o===h)&&(t[r]=h,s[i++]=r)}return s}function ce(t){var n=-1,r=Array(t.size);return t.forEach((function(t){r[++n]=t})),r}function he(t){var n=-1,r=Array(t.size);return t.forEach((function(t){r[++n]=[t,t]})),r}function fe(t,n,r){for(var e=r-1,i=t.length;++e<i;)if(t[e]===n)return e;return-1}function le(t,n,r){for(var e=r+1;e--;)if(t[e]===n)return e;return e}function de(t){return ee(t)?ye(t):xr(t)}function pe(t){return ee(t)?be(t):$r(t)}function ve(t){for(var n=t.length;n--&&Ut.test(t.charAt(n)););return n}var we=qr(Yn);function ye(t){for(var n=Gn.lastIndex=0;Gn.test(t);)++n;return n}function be(t){return t.match(Gn)||[]}function me(t){return t.match(Hn)||[]}var ge=function t(n){n=n==null?sr:_e.defaults(sr.Object(),n,_e.pick(sr,Bn));var Ut=n.Array,qt=n.Date,Yt=n.Error,tn=n.Function,nn=n.Math,rn=n.Object,en=n.RegExp,sn=n.String,on=n.TypeError,an=Ut.prototype,un=tn.prototype,cn=rn.prototype,hn=n["__core-js_shared__"],fn=un.toString,ln=cn.hasOwnProperty,dn=0,pn=function(){var t=/[^.]+$/.exec(hn&&hn.keys&&hn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),vn=cn.toString,wn=fn.call(rn),yn=sr._,bn=en("^"+fn.call(ln).replace(Mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mn=ur?n.Buffer:r,gn=n.Symbol,_n=n.Uint8Array,En=mn?mn.allocUnsafe:r,On=ae(rn.getPrototypeOf,rn),Sn=rn.create,In=cn.propertyIsEnumerable,jn=an.splice,An=gn?gn.isConcatSpreadable:r,Nn=gn?gn.iterator:r,Pn=gn?gn.toStringTag:r,xn=function(){try{var t=Bo(rn,"defineProperty");return t({},"",{}),t}catch{}}(),$n=n.clearTimeout!==sr.clearTimeout&&n.clearTimeout,Tn=qt&&qt.now!==sr.Date.now&&qt.now,Mn=n.setTimeout!==sr.setTimeout&&n.setTimeout,Cn=nn.ceil,Rn=nn.floor,Un=rn.getOwnPropertySymbols,Dn=mn?mn.isBuffer:r,kn=n.isFinite,Ln=an.join,qn=ae(rn.keys,rn),Gn=nn.max,Hn=nn.min,zn=qt.now,Wn=n.parseInt,Qn=nn.random,Xn=an.reverse,Yn=Bo(n,"DataView"),tr=Bo(n,"Map"),er=Bo(n,"Promise"),ir=Bo(n,"Set"),or=Bo(n,"WeakMap"),ar=Bo(rn,"create"),cr=or&&new or,hr={},xr=Ta(Yn),$r=Ta(tr),qr=Ta(er),fe=Ta(ir),ye=Ta(or),be=gn?gn.prototype:r,ge=be?be.valueOf:r,Ee=be?be.toString:r;function Oe(t){if(Ih(t)&&!uh(t)&&!(t instanceof Ae)){if(t instanceof je)return t;if(ln.call(t,"__wrapped__"))return Ca(t)}return new je(t)}var Se=function(){function t(){}return function(n){if(!Sh(n))return{};if(Sn)return Sn(n);t.prototype=n;var e=new t;return t.prototype=r,e}}();function Ie(){}function je(t,n){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=r}Oe.templateSettings={escape:At,evaluate:Nt,interpolate:Pt,variable:"",imports:{_:Oe}},Oe.prototype=Ie.prototype,Oe.prototype.constructor=Oe,je.prototype=Se(Ie.prototype),je.prototype.constructor=je;function Ae(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function Ne(){var t=new Ae(this.__wrapped__);return t.__actions__=eo(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=eo(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=eo(this.__views__),t}function Pe(){if(this.__filtered__){var t=new Ae(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function xe(){var t=this.__wrapped__.value(),n=this.__dir__,r=uh(t),e=n<0,i=r?t.length:0,s=Xo(0,i,this.__views__),o=s.start,a=s.end,u=a-o,c=e?a:o-1,h=this.__iteratees__,f=h.length,l=0,d=Hn(u,this.__takeCount__);if(!r||!e&&i==u&&d==u)return ks(t,this.__actions__);var p=[];t:for(;u--&&l<d;){c+=n;for(var v=-1,w=t[c];++v<f;){var y=h[v],b=y.iteratee,m=y.type,g=b(w);if(m==$)w=g;else if(!g){if(m==x)continue t;break t}}p[l++]=w}return p}Ae.prototype=Se(Ie.prototype),Ae.prototype.constructor=Ae;function $e(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function Te(){this.__data__=ar?ar(null):{},this.size=0}function Me(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}function Ce(t){var n=this.__data__;if(ar){var e=n[t];return e===u?r:e}return ln.call(n,t)?n[t]:r}function Re(t){var n=this.__data__;return ar?n[t]!==r:ln.call(n,t)}function Ue(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=ar&&n===r?u:n,this}$e.prototype.clear=Te,$e.prototype.delete=Me,$e.prototype.get=Ce,$e.prototype.has=Re,$e.prototype.set=Ue;function De(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function ke(){this.__data__=[],this.size=0}function Le(t){var n=this.__data__,r=hi(n,t);if(r<0)return!1;var e=n.length-1;return r==e?n.pop():jn.call(n,r,1),--this.size,!0}function qe(t){var n=this.__data__,e=hi(n,t);return e<0?r:n[e][1]}function Ve(t){return hi(this.__data__,t)>-1}function Fe(t,n){var r=this.__data__,e=hi(r,t);return e<0?(++this.size,r.push([t,n])):r[e][1]=n,this}De.prototype.clear=ke,De.prototype.delete=Le,De.prototype.get=qe,De.prototype.has=Ve,De.prototype.set=Fe;function Ge(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var e=t[n];this.set(e[0],e[1])}}function He(){this.size=0,this.__data__={hash:new $e,map:new(tr||De),string:new $e}}function ze(t){var n=zo(this,t).delete(t);return this.size-=n?1:0,n}function We(t){return zo(this,t).get(t)}function Be(t){return zo(this,t).has(t)}function Ke(t,n){var r=zo(this,t),e=r.size;return r.set(t,n),this.size+=r.size==e?0:1,this}Ge.prototype.clear=He,Ge.prototype.delete=ze,Ge.prototype.get=We,Ge.prototype.has=Be,Ge.prototype.set=Ke;function Je(t){var n=-1,r=t==null?0:t.length;for(this.__data__=new Ge;++n<r;)this.add(t[n])}function Ze(t){return this.__data__.set(t,u),this}function Qe(t){return this.__data__.has(t)}Je.prototype.add=Je.prototype.push=Ze,Je.prototype.has=Qe;function Xe(t){var n=this.__data__=new De(t);this.size=n.size}function Ye(){this.__data__=new De,this.size=0}function ti(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}function ni(t){return this.__data__.get(t)}function ri(t){return this.__data__.has(t)}function ei(t,n){var r=this.__data__;if(r instanceof De){var e=r.__data__;if(!tr||e.length<i-1)return e.push([t,n]),this.size=++r.size,this;r=this.__data__=new Ge(e)}return r.set(t,n),this.size=r.size,this}Xe.prototype.clear=Ye,Xe.prototype.delete=ti,Xe.prototype.get=ni,Xe.prototype.has=ri,Xe.prototype.set=ei;function ii(t,n){var r=uh(t),e=!r&&ah(t),i=!r&&!e&&dh(t),s=!r&&!e&&!i&&qh(t),o=r||e||i||s,a=o?Hr(t.length,sn):[],u=a.length;for(var c in t)(n||ln.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||oa(c,u)))&&a.push(c);return a}function si(t){var n=t.length;return n?t[ys(0,n-1)]:r}function oi(t,n){return Pa(eo(t),wi(n,0,t.length))}function ai(t){return Pa(eo(t))}function ui(t,n,e){(e!==r&&!ih(t[n],e)||e===r&&!(n in t))&&pi(t,n,e)}function ci(t,n,e){var i=t[n];(!(ln.call(t,n)&&ih(i,e))||e===r&&!(n in t))&&pi(t,n,e)}function hi(t,n){for(var r=t.length;r--;)if(ih(t[r][0],n))return r;return-1}function fi(t,n,r,e){return Ei(t,(function(t,i,s){n(e,t,r(t),s)})),e}function li(t,n){return t&&io(n,Of(n),t)}function di(t,n){return t&&io(n,Sf(n),t)}function pi(t,n,r){n=="__proto__"&&xn?xn(t,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[n]=r}function vi(t,n){for(var e=-1,i=n.length,s=Ut(i),o=t==null;++e<i;)s[e]=o?r:yf(t,n[e]);return s}function wi(t,n,e){return t===t&&(e!==r&&(t=t<=e?t:e),n!==r&&(t=t>=n?t:n)),t}function yi(t,n,e,i,s,o){var a,u=n&f,c=n&l,h=n&d;if(e&&(a=s?e(t,i,s,o):e(t)),a!==r)return a;if(!Sh(t))return t;var p=uh(t);if(p){if(a=na(t),!u)return eo(t,a)}else{var v=Qo(t),w=v==K||v==J;if(dh(t))return Bs(t,u);if(v==Y||v==V||w&&!s){if(a=c||w?{}:ra(t),!u)return c?oo(t,di(a,t)):so(t,li(a,t))}else{if(!Zn[v])return s?t:{};a=ea(t,v,u)}}o||(o=new Xe);var y=o.get(t);if(y)return y;o.set(t,a),Dh(t)?t.forEach((function(r){a.add(yi(r,n,e,r,t,o))})):jh(t)&&t.forEach((function(r,i){a.set(i,yi(r,n,e,i,t,o))}));var b=h?c?qo:Lo:c?Sf:Of,m=p?r:b(t);return mr(m||t,(function(r,i){m&&(i=r,r=t[i]),ci(a,i,yi(r,n,e,i,t,o))})),a}function bi(t){var n=Of(t);return function(r){return mi(r,t,n)}}function mi(t,n,e){var i=e.length;if(t==null)return!i;for(t=rn(t);i--;){var s=e[i],o=n[s],a=t[s];if(a===r&&!(s in t)||!o(a))return!1}return!0}function gi(t,n,e){if(typeof t!="function")throw new on(o);return Ia((function(){t.apply(r,e)}),n)}function _i(t,n,r,e){var s=-1,o=Or,a=!0,u=t.length,c=[],h=n.length;if(!u)return c;r&&(n=Ir(n,Br(r))),e?(o=Sr,a=!1):n.length>=i&&(o=Jr,a=!1,n=new Je(n));t:for(;++s<u;){var f=t[s],l=r==null?f:r(f);if(f=e||f!==0?f:0,a&&l===l){for(var d=h;d--;)if(n[d]===l)continue t;c.push(f)}else o(n,l,e)||c.push(f)}return c}var Ei=co($i),Oi=co(Ti,!0);function Si(t,n){var r=!0;return Ei(t,(function(t,e,i){return r=!!n(t,e,i),r})),r}function Ii(t,n,e){for(var i=-1,s=t.length;++i<s;){var o=t[i],a=n(o);if(a!=null&&(u===r?a===a&&!Lh(a):e(a,u)))var u=a,c=o}return c}function ji(t,n,e,i){var s=t.length;for(e=Kh(e),e<0&&(e=-e>s?0:s+e),i=i===r||i>s?s:Kh(i),i<0&&(i+=s),i=e>i?0:Jh(i);e<i;)t[e++]=n;return t}function Ai(t,n){var r=[];return Ei(t,(function(t,e,i){n(t,e,i)&&r.push(t)})),r}function Ni(t,n,r,e,i){var s=-1,o=t.length;for(r||(r=sa),i||(i=[]);++s<o;){var a=t[s];n>0&&r(a)?n>1?Ni(a,n-1,r,e,i):jr(i,a):e||(i[i.length]=a)}return i}var Pi=ho(),xi=ho(!0);function $i(t,n){return t&&Pi(t,n,Of)}function Ti(t,n){return t&&xi(t,n,Of)}function Mi(t,n){return Er(n,(function(n){return _h(t[n])}))}function Ci(t,n){n=Gs(n,t);for(var e=0,i=n.length;t!=null&&e<i;)t=t[$a(n[e++])];return e&&e==i?t:r}function Ri(t,n,r){var e=n(t);return uh(t)?e:jr(e,r(t))}function Ui(t){return t==null?t===r?ot:X:Pn&&Pn in rn(t)?Ko(t):ma(t)}function Di(t,n){return t>n}function ki(t,n){return t!=null&&ln.call(t,n)}function Li(t,n){return t!=null&&n in rn(t)}function qi(t,n,r){return t>=Hn(n,r)&&t<Gn(n,r)}function Vi(t,n,e){for(var i=e?Sr:Or,s=t[0].length,o=t.length,a=o,u=Ut(o),c=1/0,h=[];a--;){var f=t[a];a&&n&&(f=Ir(f,Br(n))),c=Hn(f.length,c),u[a]=!e&&(n||s>=120&&f.length>=120)?new Je(a&&f):r}f=t[0];var l=-1,d=u[0];t:for(;++l<s&&h.length<c;){var p=f[l],v=n?n(p):p;if(p=e||p!==0?p:0,!(d?Jr(d,v):i(h,v,e))){for(a=o;--a;){var w=u[a];if(!(w?Jr(w,v):i(t[a],v,e)))continue t}d&&d.push(v),h.push(p)}}return h}function Fi(t,n,r,e){return $i(t,(function(t,i,s){n(e,r(t),i,s)})),e}function Gi(t,n,e){n=Gs(n,t),t=_a(t,n);var i=t==null?t:t[$a(su(n))];return i==null?r:yr(i,t,e)}function Hi(t){return Ih(t)&&Ui(t)==V}function zi(t){return Ih(t)&&Ui(t)==ct}function Wi(t){return Ih(t)&&Ui(t)==z}function Bi(t,n,r,e,i){return t===n?!0:t==null||n==null||!Ih(t)&&!Ih(n)?t!==t&&n!==n:Ki(t,n,r,e,Bi,i)}function Ki(t,n,r,e,i,s){var o=uh(t),a=uh(n),u=o?F:Qo(t),c=a?F:Qo(n);u=u==V?Y:u,c=c==V?Y:c;var h=u==Y,f=c==Y,l=u==c;if(l&&dh(t)){if(!dh(n))return!1;o=!0,h=!1}if(l&&!h)return s||(s=new Xe),o||qh(t)?Ro(t,n,r,e,i,s):Uo(t,n,u,r,e,i,s);if(!(r&p)){var d=h&&ln.call(t,"__wrapped__"),v=f&&ln.call(n,"__wrapped__");if(d||v){var w=d?t.value():t,y=v?n.value():n;return s||(s=new Xe),i(w,y,r,e,s)}}return l?(s||(s=new Xe),Do(t,n,r,e,i,s)):!1}function Ji(t){return Ih(t)&&Qo(t)==Z}function Zi(t,n,e,i){var s=e.length,o=s,a=!i;if(t==null)return!o;for(t=rn(t);s--;){var u=e[s];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++s<o;){u=e[s];var c=u[0],h=t[c],f=u[1];if(a&&u[2]){if(h===r&&!(c in t))return!1}else{var l=new Xe;if(i)var d=i(h,f,c,t,n,l);if(!(d===r?Bi(f,h,p|v,i,l):d))return!1}}return!0}function Qi(t){if(!Sh(t)||fa(t))return!1;var n=_h(t)?bn:Bt;return n.test(Ta(t))}function Xi(t){return Ih(t)&&Ui(t)==rt}function Yi(t){return Ih(t)&&Qo(t)==et}function ts(t){return Ih(t)&&Oh(t.length)&&!!Jn[Ui(t)]}function ns(t){return typeof t=="function"?t:t==null?$l:typeof t=="object"?uh(t)?as(t[0],t[1]):os(t):Hl(t)}function rs(t){if(!da(t))return qn(t);var n=[];for(var r in rn(t))ln.call(t,r)&&r!="constructor"&&n.push(r);return n}function es(t){if(!Sh(t))return ba(t);var n=da(t),r=[];for(var e in t)e=="constructor"&&(n||!ln.call(t,e))||r.push(e);return r}function is(t,n){return t<n}function ss(t,n){var r=-1,e=hh(t)?Ut(t.length):[];return Ei(t,(function(t,i,s){e[++r]=n(t,i,s)})),e}function os(t){var n=Wo(t);return n.length==1&&n[0][2]?va(n[0][0],n[0][1]):function(r){return r===t||Zi(r,t,n)}}function as(t,n){return ua(t)&&pa(n)?va($a(t),n):function(e){var i=yf(e,t);return i===r&&i===n?mf(e,t):Bi(n,i,p|v)}}function us(t,n,e,i,s){t!==n&&Pi(n,(function(o,a){if(s||(s=new Xe),Sh(o))cs(t,n,a,e,us,i,s);else{var u=i?i(Oa(t,a),o,a+"",t,n,s):r;u===r&&(u=o),ui(t,a,u)}}),Sf)}function cs(t,n,e,i,s,o,a){var u=Oa(t,e),c=Oa(n,e),h=a.get(c);if(h){ui(t,e,h);return}var f=o?o(u,c,e+"",t,n,a):r,l=f===r;if(l){var d=uh(c),p=!d&&dh(c),v=!d&&!p&&qh(c);f=c,d||p||v?uh(u)?f=u:fh(u)?f=eo(u):p?(l=!1,f=Bs(c,!0)):v?(l=!1,f=Xs(c,!0)):f=[]:Ch(c)||ah(c)?(f=u,ah(u)?f=Qh(u):(!Sh(u)||_h(u))&&(f=ra(c))):l=!1}l&&(a.set(c,f),s(f,c,i,o,a),a.delete(c)),ui(t,e,f)}function hs(t,n){var e=t.length;if(e)return n+=n<0?e:0,oa(n,e)?t[n]:r}function fs(t,n,r){n.length?n=Ir(n,(function(t){return uh(t)?function(n){return Ci(n,t.length===1?t[0]:t)}:t})):n=[$l];var e=-1;n=Ir(n,Br(Ho()));var i=ss(t,(function(t,r,i){var s=Ir(n,(function(n){return n(t)}));return{criteria:s,index:++e,value:t}}));return Fr(i,(function(t,n){return to(t,n,r)}))}function ls(t,n){return ds(t,n,(function(n,r){return mf(t,r)}))}function ds(t,n,r){for(var e=-1,i=n.length,s={};++e<i;){var o=n[e],a=Ci(t,o);r(a,o)&&Os(s,Gs(o,t),a)}return s}function ps(t){return function(n){return Ci(n,t)}}function vs(t,n,r,e){var i=e?Ur:Rr,s=-1,o=n.length,a=t;for(t===n&&(n=eo(n)),r&&(a=Ir(t,Br(r)));++s<o;)for(var u=0,c=n[s],h=r?r(c):c;(u=i(a,h,u,e))>-1;)a!==t&&jn.call(a,u,1),jn.call(t,u,1);return t}function ws(t,n){for(var r=t?n.length:0,e=r-1;r--;){var i=n[r];if(r==e||i!==s){var s=i;oa(i)?jn.call(t,i,1):Rs(t,i)}}return t}function ys(t,n){return t+Rn(Qn()*(n-t+1))}function bs(t,n,r,e){for(var i=-1,s=Gn(Cn((n-t)/(r||1)),0),o=Ut(s);s--;)o[e?s:++i]=t,t+=r;return o}function ms(t,n){var r="";if(!t||n<1||n>C)return r;do{n%2&&(r+=t),n=Rn(n/2),n&&(t+=t)}while(n);return r}function gs(t,n){return ja(ga(t,n,$l),t+"")}function _s(t){return si(Ff(t))}function Es(t,n){var r=Ff(t);return Pa(r,wi(n,0,r.length))}function Os(t,n,e,i){if(!Sh(t))return t;n=Gs(n,t);for(var s=-1,o=n.length,a=o-1,u=t;u!=null&&++s<o;){var c=$a(n[s]),h=e;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(s!=a){var f=u[c];h=i?i(f,c,u):r,h===r&&(h=Sh(f)?f:oa(n[s+1])?[]:{})}ci(u,c,h),u=u[c]}return t}var Ss=cr?function(t,n){return cr.set(t,n),t}:$l,Is=xn?function(t,n){return xn(t,"toString",{configurable:!0,enumerable:!1,value:Al(n),writable:!0})}:$l;function js(t){return Pa(Ff(t))}function As(t,n,r){var e=-1,i=t.length;n<0&&(n=-n>i?0:i+n),r=r>i?i:r,r<0&&(r+=i),i=n>r?0:r-n>>>0,n>>>=0;for(var s=Ut(i);++e<i;)s[e]=t[e+n];return s}function Ns(t,n){var r;return Ei(t,(function(t,e,i){return r=n(t,e,i),!r})),!!r}function Ps(t,n,r){var e=0,i=t==null?e:t.length;if(typeof n=="number"&&n===n&&i<=L){for(;e<i;){var s=e+i>>>1,o=t[s];o!==null&&!Lh(o)&&(r?o<=n:o<n)?e=s+1:i=s}return i}return xs(t,n,$l,r)}function xs(t,n,e,i){var s=0,o=t==null?0:t.length;if(o===0)return 0;n=e(n);for(var a=n!==n,u=n===null,c=Lh(n),h=n===r;s<o;){var f=Rn((s+o)/2),l=e(t[f]),d=l!==r,p=l===null,v=l===l,w=Lh(l);if(a)var y=i||v;else h?y=v&&(i||d):u?y=v&&d&&(i||!p):c?y=v&&d&&!p&&(i||!w):p||w?y=!1:y=i?l<=n:l<n;y?s=f+1:o=f}return Hn(o,k)}function $s(t,n){for(var r=-1,e=t.length,i=0,s=[];++r<e;){var o=t[r],a=n?n(o):o;if(!r||!ih(a,u)){var u=a;s[i++]=o===0?0:o}}return s}function Ts(t){return typeof t=="number"?t:Lh(t)?U:+t}function Ms(t){if(typeof t=="string")return t;if(uh(t))return Ir(t,Ms)+"";if(Lh(t))return Ee?Ee.call(t):"";var n=t+"";return n=="0"&&1/t==-M?"-0":n}function Cs(t,n,r){var e=-1,s=Or,o=t.length,a=!0,u=[],c=u;if(r)a=!1,s=Sr;else if(o>=i){var h=n?null:Po(t);if(h)return ce(h);a=!1,s=Jr,c=new Je}else c=n?[]:u;t:for(;++e<o;){var f=t[e],l=n?n(f):f;if(f=r||f!==0?f:0,a&&l===l){for(var d=c.length;d--;)if(c[d]===l)continue t;n&&c.push(l),u.push(f)}else s(c,l,r)||(c!==u&&c.push(l),u.push(f))}return u}function Rs(t,n){return n=Gs(n,t),t=_a(t,n),t==null||delete t[$a(su(n))]}function Us(t,n,r,e){return Os(t,n,r(Ci(t,n)),e)}function Ds(t,n,r,e){for(var i=t.length,s=e?i:-1;(e?s--:++s<i)&&n(t[s],s,t););return r?As(t,e?0:s,e?s+1:i):As(t,e?s+1:0,e?i:s)}function ks(t,n){var r=t;return r instanceof Ae&&(r=r.value()),Ar(n,(function(t,n){return n.func.apply(n.thisArg,jr([t],n.args))}),r)}function Ls(t,n,r){var e=t.length;if(e<2)return e?Cs(t[0]):[];for(var i=-1,s=Ut(e);++i<e;)for(var o=t[i],a=-1;++a<e;)a!=i&&(s[i]=_i(s[i]||o,t[a],n,r));return Cs(Ni(s,1),n,r)}function qs(t,n,e){for(var i=-1,s=t.length,o=n.length,a={};++i<s;){var u=i<o?n[i]:r;e(a,t[i],u)}return a}function Vs(t){return fh(t)?t:[]}function Fs(t){return typeof t=="function"?t:$l}function Gs(t,n){return uh(t)?t:ua(t,n)?[t]:xa(Yh(t))}var Hs=gs;function zs(t,n,e){var i=t.length;return e=e===r?i:e,!n&&e>=i?t:As(t,n,e)}var Ws=$n||function(t){return sr.clearTimeout(t)};function Bs(t,n){if(n)return t.slice();var r=t.length,e=En?En(r):new t.constructor(r);return t.copy(e),e}function Ks(t){var n=new t.constructor(t.byteLength);return new _n(n).set(new _n(t)),n}function Js(t,n){var r=n?Ks(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}function Zs(t){var n=new t.constructor(t.source,Ht.exec(t));return n.lastIndex=t.lastIndex,n}function Qs(t){return ge?rn(ge.call(t)):{}}function Xs(t,n){var r=n?Ks(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Ys(t,n){if(t!==n){var e=t!==r,i=t===null,s=t===t,o=Lh(t),a=n!==r,u=n===null,c=n===n,h=Lh(n);if(!u&&!h&&!o&&t>n||o&&a&&c&&!u&&!h||i&&a&&c||!e&&c||!s)return 1;if(!i&&!o&&!h&&t<n||h&&e&&s&&!i&&!o||u&&e&&s||!a&&s||!c)return-1}return 0}function to(t,n,r){for(var e=-1,i=t.criteria,s=n.criteria,o=i.length,a=r.length;++e<o;){var u=Ys(i[e],s[e]);if(u){if(e>=a)return u;var c=r[e];return u*(c=="desc"?-1:1)}}return t.index-n.index}function no(t,n,r,e){for(var i=-1,s=t.length,o=r.length,a=-1,u=n.length,c=Gn(s-o,0),h=Ut(u+c),f=!e;++a<u;)h[a]=n[a];for(;++i<o;)(f||i<s)&&(h[r[i]]=t[i]);for(;c--;)h[a++]=t[i++];return h}function ro(t,n,r,e){for(var i=-1,s=t.length,o=-1,a=r.length,u=-1,c=n.length,h=Gn(s-a,0),f=Ut(h+c),l=!e;++i<h;)f[i]=t[i];for(var d=i;++u<c;)f[d+u]=n[u];for(;++o<a;)(l||i<s)&&(f[d+r[o]]=t[i++]);return f}function eo(t,n){var r=-1,e=t.length;for(n||(n=Ut(e));++r<e;)n[r]=t[r];return n}function io(t,n,e,i){var s=!e;e||(e={});for(var o=-1,a=n.length;++o<a;){var u=n[o],c=i?i(e[u],t[u],u,e,t):r;c===r&&(c=t[u]),s?pi(e,u,c):ci(e,u,c)}return e}function so(t,n){return io(t,Jo(t),n)}function oo(t,n){return io(t,Zo(t),n)}function ao(t,n){return function(r,e){var i=uh(r)?br:fi,s=n?n():{};return i(r,t,Ho(e,2),s)}}function uo(t){return gs((function(n,e){var i=-1,s=e.length,o=s>1?e[s-1]:r,a=s>2?e[2]:r;for(o=t.length>3&&typeof o=="function"?(s--,o):r,a&&aa(e[0],e[1],a)&&(o=s<3?r:o,s=1),n=rn(n);++i<s;){var u=e[i];u&&t(n,u,i,o)}return n}))}function co(t,n){return function(r,e){if(r==null)return r;if(!hh(r))return t(r,e);for(var i=r.length,s=n?i:-1,o=rn(r);(n?s--:++s<i)&&e(o[s],s,o)!==!1;);return r}}function ho(t){return function(n,r,e){for(var i=-1,s=rn(n),o=e(n),a=o.length;a--;){var u=o[t?a:++i];if(r(s[u],u,s)===!1)break}return n}}function fo(t,n,r){var e=n&w,i=vo(t);function s(){var n=this&&this!==sr&&this instanceof s?i:t;return n.apply(e?r:this,arguments)}return s}function lo(t){return function(n){n=Yh(n);var e=ee(n)?pe(n):r,i=e?e[0]:n.charAt(0),s=e?zs(e,1).join(""):n.slice(1);return i[t]()+s}}function po(t){return function(n){return Ar(El(Jf(n).replace(Vn,"")),t,"")}}function vo(t){return function(){var n=arguments;switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3]);case 5:return new t(n[0],n[1],n[2],n[3],n[4]);case 6:return new t(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new t(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var r=Se(t.prototype),e=t.apply(r,n);return Sh(e)?e:r}}function wo(t,n,e){var i=vo(t);function s(){for(var o=arguments.length,a=Ut(o),u=o,c=Go(s);u--;)a[u]=arguments[u];var h=o<3&&a[0]!==c&&a[o-1]!==c?[]:ue(a,c);if(o-=h.length,o<e)return Ao(t,n,mo,s.placeholder,r,a,h,r,r,e-o);var f=this&&this!==sr&&this instanceof s?i:t;return yr(f,this,a)}return s}function yo(t){return function(n,e,i){var s=rn(n);if(!hh(n)){var o=Ho(e,3);n=Of(n),e=function(t){return o(s[t],t,s)}}var a=t(n,e,i);return a>-1?s[o?n[a]:a]:r}}function bo(t){return ko((function(n){var e=n.length,i=e,s=je.prototype.thru;for(t&&n.reverse();i--;){var a=n[i];if(typeof a!="function")throw new on(o);if(s&&!u&&Fo(a)=="wrapper")var u=new je([],!0)}for(i=u?i:e;++i<e;){a=n[i];var c=Fo(a),h=c=="wrapper"?Vo(a):r;h&&ha(h[0])&&h[1]==(O|m|_|S)&&!h[4].length&&h[9]==1?u=u[Fo(h[0])].apply(u,h[3]):u=a.length==1&&ha(a)?u[c]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&t.length==1&&uh(r))return u.plant(r).value();for(var i=0,s=e?n[i].apply(this,t):r;++i<e;)s=n[i].call(this,s);return s}}))}function mo(t,n,e,i,s,o,a,u,c,h){var f=n&O,l=n&w,d=n&y,p=n&(m|g),v=n&I,b=d?r:vo(t);function _(){for(var r=arguments.length,w=Ut(r),y=r;y--;)w[y]=arguments[y];if(p)var m=Go(_),g=Xr(w,m);if(i&&(w=no(w,i,s,p)),o&&(w=ro(w,o,a,p)),r-=g,p&&r<h){var E=ue(w,m);return Ao(t,n,mo,_.placeholder,e,w,E,u,c,h-r)}var O=l?e:this,S=d?O[t]:t;return r=w.length,u?w=Ea(w,u):v&&r>1&&w.reverse(),f&&c<r&&(w.length=c),this&&this!==sr&&this instanceof _&&(S=b||vo(S)),S.apply(O,w)}return _}function go(t,n){return function(r,e){return Fi(r,t,n(e),{})}}function _o(t,n){return function(e,i){var s;if(e===r&&i===r)return n;if(e!==r&&(s=e),i!==r){if(s===r)return i;typeof e=="string"||typeof i=="string"?(e=Ms(e),i=Ms(i)):(e=Ts(e),i=Ts(i)),s=t(e,i)}return s}}function Eo(t){return ko((function(n){return n=Ir(n,Br(Ho())),gs((function(r){var e=this;return t(n,(function(t){return yr(t,e,r)}))}))}))}function Oo(t,n){n=n===r?" ":Ms(n);var e=n.length;if(e<2)return e?ms(n,t):n;var i=ms(n,Cn(t/de(n)));return ee(n)?zs(pe(i),0,t).join(""):i.slice(0,t)}function So(t,n,r,e){var i=n&w,s=vo(t);function o(){for(var n=-1,a=arguments.length,u=-1,c=e.length,h=Ut(c+a),f=this&&this!==sr&&this instanceof o?s:t;++u<c;)h[u]=e[u];for(;a--;)h[u++]=arguments[++n];return yr(f,i?r:this,h)}return o}function Io(t){return function(n,e,i){return i&&typeof i!="number"&&aa(n,e,i)&&(e=i=r),n=Bh(n),e===r?(e=n,n=0):e=Bh(e),i=i===r?n<e?1:-1:Bh(i),bs(n,e,i,t)}}function jo(t){return function(n,r){return typeof n=="string"&&typeof r=="string"||(n=Zh(n),r=Zh(r)),t(n,r)}}function Ao(t,n,e,i,s,o,a,u,c,h){var f=n&m,l=f?a:r,d=f?r:a,p=f?o:r,v=f?r:o;n|=f?_:E,n&=~(f?E:_),n&b||(n&=~(w|y));var g=[t,n,s,p,l,v,d,u,c,h],O=e.apply(r,g);return ha(t)&&Sa(O,g),O.placeholder=i,Aa(O,t,n)}function No(t){var n=nn[t];return function(t,r){if(t=Zh(t),r=r==null?0:Hn(Kh(r),292),r&&kn(t)){var e=(Yh(t)+"e").split("e"),i=n(e[0]+"e"+(+e[1]+r));return e=(Yh(i)+"e").split("e"),+(e[0]+"e"+(+e[1]-r))}return n(t)}}var Po=ir&&1/ce(new ir([,-0]))[1]==M?function(t){return new ir(t)}:Ll;function xo(t){return function(n){var r=Qo(n);return r==Z?oe(n):r==et?he(n):zr(n,t(n))}}function $o(t,n,e,i,s,a,u,c){var h=n&y;if(!h&&typeof t!="function")throw new on(o);var f=i?i.length:0;if(f||(n&=~(_|E),i=s=r),u=u===r?u:Gn(Kh(u),0),c=c===r?c:Kh(c),f-=s?s.length:0,n&E){var l=i,d=s;i=s=r}var p=h?r:Vo(t),v=[t,n,e,i,s,l,d,a,u,c];if(p&&ya(v,p),t=v[0],n=v[1],e=v[2],i=v[3],s=v[4],c=v[9]=v[9]===r?h?0:t.length:Gn(v[9]-f,0),!c&&n&(m|g)&&(n&=~(m|g)),!n||n==w)var b=fo(t,n,e);else n==m||n==g?b=wo(t,n,c):(n==_||n==(w|_))&&!s.length?b=So(t,n,e,i):b=mo.apply(r,v);var O=p?Ss:Sa;return Aa(O(b,v),t,n)}function To(t,n,e,i){return t===r||ih(t,cn[e])&&!ln.call(i,e)?n:t}function Mo(t,n,e,i,s,o){return Sh(t)&&Sh(n)&&(o.set(n,t),us(t,n,r,Mo,o),o.delete(n)),t}function Co(t){return Ch(t)?r:t}function Ro(t,n,e,i,s,o){var a=e&p,u=t.length,c=n.length;if(u!=c&&!(a&&c>u))return!1;var h=o.get(t),f=o.get(n);if(h&&f)return h==n&&f==t;var l=-1,d=!0,w=e&v?new Je:r;for(o.set(t,n),o.set(n,t);++l<u;){var y=t[l],b=n[l];if(i)var m=a?i(b,y,l,n,t,o):i(y,b,l,t,n,o);if(m!==r){if(m)continue;d=!1;break}if(w){if(!Pr(n,(function(t,n){if(!Jr(w,n)&&(y===t||s(y,t,e,i,o)))return w.push(n)}))){d=!1;break}}else if(!(y===b||s(y,b,e,i,o))){d=!1;break}}return o.delete(t),o.delete(n),d}function Uo(t,n,r,e,i,s,o){switch(r){case ht:if(t.byteLength!=n.byteLength||t.byteOffset!=n.byteOffset)return!1;t=t.buffer,n=n.buffer;case ct:return!(t.byteLength!=n.byteLength||!s(new _n(t),new _n(n)));case H:case z:case Q:return ih(+t,+n);case B:return t.name==n.name&&t.message==n.message;case rt:case it:return t==n+"";case Z:var a=oe;case et:var u=e&p;if(a||(a=ce),t.size!=n.size&&!u)return!1;var c=o.get(t);if(c)return c==n;e|=v,o.set(t,n);var h=Ro(a(t),a(n),e,i,s,o);return o.delete(t),h;case st:if(ge)return ge.call(t)==ge.call(n)}return!1}function Do(t,n,e,i,s,o){var a=e&p,u=Lo(t),c=u.length,h=Lo(n),f=h.length;if(c!=f&&!a)return!1;for(var l=c;l--;){var d=u[l];if(!(a?d in n:ln.call(n,d)))return!1}var v=o.get(t),w=o.get(n);if(v&&w)return v==n&&w==t;var y=!0;o.set(t,n),o.set(n,t);for(var b=a;++l<c;){d=u[l];var m=t[d],g=n[d];if(i)var _=a?i(g,m,d,n,t,o):i(m,g,d,t,n,o);if(!(_===r?m===g||s(m,g,e,i,o):_)){y=!1;break}b||(b=d=="constructor")}if(y&&!b){var E=t.constructor,O=n.constructor;E!=O&&"constructor"in t&&"constructor"in n&&!(typeof E=="function"&&E instanceof E&&typeof O=="function"&&O instanceof O)&&(y=!1)}return o.delete(t),o.delete(n),y}function ko(t){return ja(ga(t,r,Ka),t+"")}function Lo(t){return Ri(t,Of,Jo)}function qo(t){return Ri(t,Sf,Zo)}var Vo=cr?function(t){return cr.get(t)}:Ll;function Fo(t){for(var n=t.name+"",r=hr[n],e=ln.call(hr,n)?r.length:0;e--;){var i=r[e],s=i.func;if(s==null||s==t)return i.name}return n}function Go(t){var n=ln.call(Oe,"placeholder")?Oe:t;return n.placeholder}function Ho(){var t=Oe.iteratee||Tl;return t=t===Tl?ns:t,arguments.length?t(arguments[0],arguments[1]):t}function zo(t,n){var r=t.__data__;return ca(n)?r[typeof n=="string"?"string":"hash"]:r.map}function Wo(t){for(var n=Of(t),r=n.length;r--;){var e=n[r],i=t[e];n[r]=[e,i,pa(i)]}return n}function Bo(t,n){var e=re(t,n);return Qi(e)?e:r}function Ko(t){var n=ln.call(t,Pn),e=t[Pn];try{t[Pn]=r;var i=!0}catch{}var s=vn.call(t);return i&&(n?t[Pn]=e:delete t[Pn]),s}var Jo=Un?function(t){return t==null?[]:(t=rn(t),Er(Un(t),(function(n){return In.call(t,n)})))}:Kl,Zo=Un?function(t){for(var n=[];t;)jr(n,Jo(t)),t=On(t);return n}:Kl,Qo=Ui;(Yn&&Qo(new Yn(new ArrayBuffer(1)))!=ht||tr&&Qo(new tr)!=Z||er&&Qo(er.resolve())!=tt||ir&&Qo(new ir)!=et||or&&Qo(new or)!=at)&&(Qo=function(t){var n=Ui(t),e=n==Y?t.constructor:r,i=e?Ta(e):"";if(i)switch(i){case xr:return ht;case $r:return Z;case qr:return tt;case fe:return et;case ye:return at}return n});function Xo(t,n,r){for(var e=-1,i=r.length;++e<i;){var s=r[e],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":n-=o;break;case"take":n=Hn(n,t+o);break;case"takeRight":t=Gn(t,n-o);break}}return{start:t,end:n}}function Yo(t){var n=t.match(kt);return n?n[1].split(Lt):[]}function ta(t,n,r){n=Gs(n,t);for(var e=-1,i=n.length,s=!1;++e<i;){var o=$a(n[e]);if(!(s=t!=null&&r(t,o)))break;t=t[o]}return s||++e!=i?s:(i=t==null?0:t.length,!!i&&Oh(i)&&oa(o,i)&&(uh(t)||ah(t)))}function na(t){var n=t.length,r=new t.constructor(n);return n&&typeof t[0]=="string"&&ln.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function ra(t){return typeof t.constructor=="function"&&!da(t)?Se(On(t)):{}}function ea(t,n,r){var e=t.constructor;switch(n){case ct:return Ks(t);case H:case z:return new e(+t);case ht:return Js(t,r);case ft:case lt:case dt:case pt:case vt:case wt:case yt:case bt:case mt:return Xs(t,r);case Z:return new e;case Q:case it:return new e(t);case rt:return Zs(t);case et:return new e;case st:return Qs(t)}}function ia(t,n){var r=n.length;if(!r)return t;var e=r-1;return n[e]=(r>1?"& ":"")+n[e],n=n.join(r>2?", ":" "),t.replace(Dt,`{\n/* [wrapped with `+n+`] */\n`)}function sa(t){return uh(t)||ah(t)||!!(An&&t&&t[An])}function oa(t,n){var r=typeof t;return n=n??C,!!n&&(r=="number"||r!="symbol"&&Jt.test(t))&&t>-1&&t%1==0&&t<n}function aa(t,n,r){if(!Sh(r))return!1;var e=typeof n;return(e=="number"?hh(r)&&oa(n,r.length):e=="string"&&n in r)?ih(r[n],t):!1}function ua(t,n){if(uh(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Lh(t)?!0:$t.test(t)||!xt.test(t)||n!=null&&t in rn(n)}function ca(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function ha(t){var n=Fo(t),r=Oe[n];if(typeof r!="function"||!(n in Ae.prototype))return!1;if(t===r)return!0;var e=Vo(r);return!!e&&t===e[0]}function fa(t){return!!pn&&pn in t}var la=hn?_h:Jl;function da(t){var n=t&&t.constructor,r=typeof n=="function"&&n.prototype||cn;return t===r}function pa(t){return t===t&&!Sh(t)}function va(t,n){return function(e){return e==null?!1:e[t]===n&&(n!==r||t in rn(e))}}function wa(t){var n=qc(t,(function(t){return r.size===c&&r.clear(),t})),r=n.cache;return n}function ya(t,n){var r=t[1],e=n[1],i=r|e,s=i<(w|y|O),o=e==O&&r==m||e==O&&r==S&&t[7].length<=n[8]||e==(O|S)&&n[7].length<=n[8]&&r==m;if(!(s||o))return t;e&w&&(t[2]=n[2],i|=r&w?0:b);var a=n[3];if(a){var u=t[3];t[3]=u?no(u,a,n[4]):a,t[4]=u?ue(t[3],h):n[4]}return a=n[5],a&&(u=t[5],t[5]=u?ro(u,a,n[6]):a,t[6]=u?ue(t[5],h):n[6]),a=n[7],a&&(t[7]=a),e&O&&(t[8]=t[8]==null?n[8]:Hn(t[8],n[8])),t[9]==null&&(t[9]=n[9]),t[0]=n[0],t[1]=i,t}function ba(t){var n=[];if(t!=null)for(var r in rn(t))n.push(r);return n}function ma(t){return vn.call(t)}function ga(t,n,e){return n=Gn(n===r?t.length-1:n,0),function(){for(var r=arguments,i=-1,s=Gn(r.length-n,0),o=Ut(s);++i<s;)o[i]=r[n+i];i=-1;for(var a=Ut(n+1);++i<n;)a[i]=r[i];return a[n]=e(o),yr(t,this,a)}}function _a(t,n){return n.length<2?t:Ci(t,As(n,0,-1))}function Ea(t,n){for(var e=t.length,i=Hn(n.length,e),s=eo(t);i--;){var o=n[i];t[i]=oa(o,e)?s[o]:r}return t}function Oa(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}var Sa=Na(Ss),Ia=Mn||function(t,n){return sr.setTimeout(t,n)},ja=Na(Is);function Aa(t,n,r){var e=n+"";return ja(t,ia(e,Ma(Yo(e),r)))}function Na(t){var n=0,e=0;return function(){var i=zn(),s=P-(i-e);if(e=i,s>0){if(++n>=N)return arguments[0]}else n=0;return t.apply(r,arguments)}}function Pa(t,n){var e=-1,i=t.length,s=i-1;for(n=n===r?i:n;++e<n;){var o=ys(e,s),a=t[o];t[o]=t[e],t[e]=a}return t.length=n,t}var xa=wa((function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(Tt,(function(t,r,e,i){n.push(e?i.replace(Ft,"$1"):r||t)})),n}));function $a(t){if(typeof t=="string"||Lh(t))return t;var n=t+"";return n=="0"&&1/t==-M?"-0":n}function Ta(t){if(t!=null){try{return fn.call(t)}catch{}try{return t+""}catch{}}return""}function Ma(t,n){return mr(q,(function(r){var e="_."+r[0];n&r[1]&&!Or(t,e)&&t.push(e)})),t.sort()}function Ca(t){if(t instanceof Ae)return t.clone();var n=new je(t.__wrapped__,t.__chain__);return n.__actions__=eo(t.__actions__),n.__index__=t.__index__,n.__values__=t.__values__,n}function Ra(t,n,e){(e?aa(t,n,e):n===r)?n=1:n=Gn(Kh(n),0);var i=t==null?0:t.length;if(!i||n<1)return[];for(var s=0,o=0,a=Ut(Cn(i/n));s<i;)a[o++]=As(t,s,s+=n);return a}function Ua(t){for(var n=-1,r=t==null?0:t.length,e=0,i=[];++n<r;){var s=t[n];s&&(i[e++]=s)}return i}function Da(){var t=arguments.length;if(!t)return[];for(var n=Ut(t-1),r=arguments[0],e=t;e--;)n[e-1]=arguments[e];return jr(uh(r)?eo(r):[r],Ni(n,1))}var ka=gs((function(t,n){return fh(t)?_i(t,Ni(n,1,fh,!0)):[]})),La=gs((function(t,n){var e=su(n);return fh(e)&&(e=r),fh(t)?_i(t,Ni(n,1,fh,!0),Ho(e,2)):[]})),qa=gs((function(t,n){var e=su(n);return fh(e)&&(e=r),fh(t)?_i(t,Ni(n,1,fh,!0),r,e):[]}));function Va(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:Kh(n),As(t,n<0?0:n,i)):[]}function Fa(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:Kh(n),n=i-n,As(t,0,n<0?0:n)):[]}function Ga(t,n){return t&&t.length?Ds(t,Ho(n,3),!0,!0):[]}function Ha(t,n){return t&&t.length?Ds(t,Ho(n,3),!0):[]}function za(t,n,r,e){var i=t==null?0:t.length;return i?(r&&typeof r!="number"&&aa(t,n,r)&&(r=0,e=i),ji(t,n,r,e)):[]}function Wa(t,n,r){var e=t==null?0:t.length;if(!e)return-1;var i=r==null?0:Kh(r);return i<0&&(i=Gn(e+i,0)),Cr(t,Ho(n,3),i)}function Ba(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var s=i-1;return e!==r&&(s=Kh(e),s=e<0?Gn(i+s,0):Hn(s,i-1)),Cr(t,Ho(n,3),s,!0)}function Ka(t){var n=t==null?0:t.length;return n?Ni(t,1):[]}function Ja(t){var n=t==null?0:t.length;return n?Ni(t,M):[]}function Za(t,n){var e=t==null?0:t.length;return e?(n=n===r?1:Kh(n),Ni(t,n)):[]}function Qa(t){for(var n=-1,r=t==null?0:t.length,e={};++n<r;){var i=t[n];e[i[0]]=i[1]}return e}function Xa(t){return t&&t.length?t[0]:r}function Ya(t,n,r){var e=t==null?0:t.length;if(!e)return-1;var i=r==null?0:Kh(r);return i<0&&(i=Gn(e+i,0)),Rr(t,n,i)}function tu(t){var n=t==null?0:t.length;return n?As(t,0,-1):[]}var nu=gs((function(t){var n=Ir(t,Vs);return n.length&&n[0]===t[0]?Vi(n):[]})),ru=gs((function(t){var n=su(t),e=Ir(t,Vs);return n===su(e)?n=r:e.pop(),e.length&&e[0]===t[0]?Vi(e,Ho(n,2)):[]})),eu=gs((function(t){var n=su(t),e=Ir(t,Vs);return n=typeof n=="function"?n:r,n&&e.pop(),e.length&&e[0]===t[0]?Vi(e,r,n):[]}));function iu(t,n){return t==null?"":Ln.call(t,n)}function su(t){var n=t==null?0:t.length;return n?t[n-1]:r}function ou(t,n,e){var i=t==null?0:t.length;if(!i)return-1;var s=i;return e!==r&&(s=Kh(e),s=s<0?Gn(i+s,0):Hn(s,i-1)),n===n?le(t,n,s):Cr(t,Dr,s,!0)}function au(t,n){return t&&t.length?hs(t,Kh(n)):r}var uu=gs(cu);function cu(t,n){return t&&t.length&&n&&n.length?vs(t,n):t}function hu(t,n,r){return t&&t.length&&n&&n.length?vs(t,n,Ho(r,2)):t}function fu(t,n,e){return t&&t.length&&n&&n.length?vs(t,n,r,e):t}var lu=ko((function(t,n){var r=t==null?0:t.length,e=vi(t,n);return ws(t,Ir(n,(function(t){return oa(t,r)?+t:t})).sort(Ys)),e}));function du(t,n){var r=[];if(!(t&&t.length))return r;var e=-1,i=[],s=t.length;for(n=Ho(n,3);++e<s;){var o=t[e];n(o,e,t)&&(r.push(o),i.push(e))}return ws(t,i),r}function pu(t){return t==null?t:Xn.call(t)}function vu(t,n,e){var i=t==null?0:t.length;return i?(e&&typeof e!="number"&&aa(t,n,e)?(n=0,e=i):(n=n==null?0:Kh(n),e=e===r?i:Kh(e)),As(t,n,e)):[]}function wu(t,n){return Ps(t,n)}function yu(t,n,r){return xs(t,n,Ho(r,2))}function bu(t,n){var r=t==null?0:t.length;if(r){var e=Ps(t,n);if(e<r&&ih(t[e],n))return e}return-1}function mu(t,n){return Ps(t,n,!0)}function gu(t,n,r){return xs(t,n,Ho(r,2),!0)}function _u(t,n){var r=t==null?0:t.length;if(r){var e=Ps(t,n,!0)-1;if(ih(t[e],n))return e}return-1}function Eu(t){return t&&t.length?$s(t):[]}function Ou(t,n){return t&&t.length?$s(t,Ho(n,2)):[]}function Su(t){var n=t==null?0:t.length;return n?As(t,1,n):[]}function Iu(t,n,e){return t&&t.length?(n=e||n===r?1:Kh(n),As(t,0,n<0?0:n)):[]}function ju(t,n,e){var i=t==null?0:t.length;return i?(n=e||n===r?1:Kh(n),n=i-n,As(t,n<0?0:n,i)):[]}function Au(t,n){return t&&t.length?Ds(t,Ho(n,3),!1,!0):[]}function Nu(t,n){return t&&t.length?Ds(t,Ho(n,3)):[]}var Pu=gs((function(t){return Cs(Ni(t,1,fh,!0))})),xu=gs((function(t){var n=su(t);return fh(n)&&(n=r),Cs(Ni(t,1,fh,!0),Ho(n,2))})),$u=gs((function(t){var n=su(t);return n=typeof n=="function"?n:r,Cs(Ni(t,1,fh,!0),r,n)}));function Tu(t){return t&&t.length?Cs(t):[]}function Mu(t,n){return t&&t.length?Cs(t,Ho(n,2)):[]}function Cu(t,n){return n=typeof n=="function"?n:r,t&&t.length?Cs(t,r,n):[]}function Ru(t){if(!(t&&t.length))return[];var n=0;return t=Er(t,(function(t){if(fh(t))return n=Gn(t.length,n),!0})),Hr(n,(function(n){return Ir(t,Lr(n))}))}function Uu(t,n){if(!(t&&t.length))return[];var e=Ru(t);return n==null?e:Ir(e,(function(t){return yr(n,r,t)}))}var Du=gs((function(t,n){return fh(t)?_i(t,n):[]})),ku=gs((function(t){return Ls(Er(t,fh))})),Lu=gs((function(t){var n=su(t);return fh(n)&&(n=r),Ls(Er(t,fh),Ho(n,2))})),qu=gs((function(t){var n=su(t);return n=typeof n=="function"?n:r,Ls(Er(t,fh),r,n)})),Vu=gs(Ru);function Fu(t,n){return qs(t||[],n||[],ci)}function Gu(t,n){return qs(t||[],n||[],Os)}var Hu=gs((function(t){var n=t.length,e=n>1?t[n-1]:r;return e=typeof e=="function"?(t.pop(),e):r,Uu(t,e)}));function zu(t){var n=Oe(t);return n.__chain__=!0,n}function Wu(t,n){return n(t),t}function Bu(t,n){return n(t)}var Ku=ko((function(t){var n=t.length,e=n?t[0]:0,i=this.__wrapped__,s=function(n){return vi(n,t)};return n>1||this.__actions__.length||!(i instanceof Ae)||!oa(e)?this.thru(s):(i=i.slice(e,+e+(n?1:0)),i.__actions__.push({func:Bu,args:[s],thisArg:r}),new je(i,this.__chain__).thru((function(t){return n&&!t.length&&t.push(r),t})))}));function Ju(){return zu(this)}function Zu(){return new je(this.value(),this.__chain__)}function Qu(){this.__values__===r&&(this.__values__=Wh(this.value()));var t=this.__index__>=this.__values__.length,n=t?r:this.__values__[this.__index__++];return{done:t,value:n}}function Xu(){return this}function Yu(t){for(var n,e=this;e instanceof Ie;){var i=Ca(e);i.__index__=0,i.__values__=r,n?s.__wrapped__=i:n=i;var s=i;e=e.__wrapped__}return s.__wrapped__=t,n}function tc(){var t=this.__wrapped__;if(t instanceof Ae){var n=t;return this.__actions__.length&&(n=new Ae(this)),n=n.reverse(),n.__actions__.push({func:Bu,args:[pu],thisArg:r}),new je(n,this.__chain__)}return this.thru(pu)}function nc(){return ks(this.__wrapped__,this.__actions__)}var rc=ao((function(t,n,r){ln.call(t,r)?++t[r]:pi(t,r,1)}));function ec(t,n,e){var i=uh(t)?_r:Si;return e&&aa(t,n,e)&&(n=r),i(t,Ho(n,3))}function ic(t,n){var r=uh(t)?Er:Ai;return r(t,Ho(n,3))}var sc=yo(Wa),oc=yo(Ba);function ac(t,n){return Ni(wc(t,n),1)}function uc(t,n){return Ni(wc(t,n),M)}function cc(t,n,e){return e=e===r?1:Kh(e),Ni(wc(t,n),e)}function hc(t,n){var r=uh(t)?mr:Ei;return r(t,Ho(n,3))}function fc(t,n){var r=uh(t)?gr:Oi;return r(t,Ho(n,3))}var lc=ao((function(t,n,r){ln.call(t,r)?t[r].push(n):pi(t,r,[n])}));function dc(t,n,r,e){t=hh(t)?t:Ff(t),r=r&&!e?Kh(r):0;var i=t.length;return r<0&&(r=Gn(i+r,0)),kh(t)?r<=i&&t.indexOf(n,r)>-1:!!i&&Rr(t,n,r)>-1}var pc=gs((function(t,n,r){var e=-1,i=typeof n=="function",s=hh(t)?Ut(t.length):[];return Ei(t,(function(t){s[++e]=i?yr(n,t,r):Gi(t,n,r)})),s})),vc=ao((function(t,n,r){pi(t,r,n)}));function wc(t,n){var r=uh(t)?Ir:ss;return r(t,Ho(n,3))}function yc(t,n,e,i){return t==null?[]:(uh(n)||(n=n==null?[]:[n]),e=i?r:e,uh(e)||(e=e==null?[]:[e]),fs(t,n,e))}var bc=ao((function(t,n,r){t[r?0:1].push(n)}),(function(){return[[],[]]}));function mc(t,n,r){var e=uh(t)?Ar:Vr,i=arguments.length<3;return e(t,Ho(n,4),r,i,Ei)}function gc(t,n,r){var e=uh(t)?Nr:Vr,i=arguments.length<3;return e(t,Ho(n,4),r,i,Oi)}function _c(t,n){var r=uh(t)?Er:Ai;return r(t,Vc(Ho(n,3)))}function Ec(t){var n=uh(t)?si:_s;return n(t)}function Oc(t,n,e){(e?aa(t,n,e):n===r)?n=1:n=Kh(n);var i=uh(t)?oi:Es;return i(t,n)}function Sc(t){var n=uh(t)?ai:js;return n(t)}function Ic(t){if(t==null)return 0;if(hh(t))return kh(t)?de(t):t.length;var n=Qo(t);return n==Z||n==et?t.size:rs(t).length}function jc(t,n,e){var i=uh(t)?Pr:Ns;return e&&aa(t,n,e)&&(n=r),i(t,Ho(n,3))}var Ac=gs((function(t,n){if(t==null)return[];var r=n.length;return r>1&&aa(t,n[0],n[1])?n=[]:r>2&&aa(n[0],n[1],n[2])&&(n=[n[0]]),fs(t,Ni(n,1),[])})),Nc=Tn||function(){return sr.Date.now()};function Pc(t,n){if(typeof n!="function")throw new on(o);return t=Kh(t),function(){if(--t<1)return n.apply(this,arguments)}}function xc(t,n,e){return n=e?r:n,n=t&&n==null?t.length:n,$o(t,O,r,r,r,r,n)}function $c(t,n){var e;if(typeof n!="function")throw new on(o);return t=Kh(t),function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=r),e}}var Tc=gs((function(t,n,r){var e=w;if(r.length){var i=ue(r,Go(Tc));e|=_}return $o(t,e,n,r,i)})),Mc=gs((function(t,n,r){var e=w|y;if(r.length){var i=ue(r,Go(Mc));e|=_}return $o(n,e,t,r,i)}));function Cc(t,n,e){n=e?r:n;var i=$o(t,m,r,r,r,r,r,n);return i.placeholder=Cc.placeholder,i}function Rc(t,n,e){n=e?r:n;var i=$o(t,g,r,r,r,r,r,n);return i.placeholder=Rc.placeholder,i}function Uc(t,n,e){var i,s,a,u,c,h,f=0,l=!1,d=!1,p=!0;if(typeof t!="function")throw new on(o);n=Zh(n)||0,Sh(e)&&(l=!!e.leading,d="maxWait"in e,a=d?Gn(Zh(e.maxWait)||0,n):a,p="trailing"in e?!!e.trailing:p);function v(n){var e=i,o=s;return i=s=r,f=n,u=t.apply(o,e),u}function w(t){return f=t,c=Ia(m,n),l?v(t):u}function y(t){var r=t-h,e=t-f,i=n-r;return d?Hn(i,a-e):i}function b(t){var e=t-h,i=t-f;return h===r||e>=n||e<0||d&&i>=a}function m(){var t=Nc();if(b(t))return g(t);c=Ia(m,y(t))}function g(t){return c=r,p&&i?v(t):(i=s=r,u)}function _(){c!==r&&Ws(c),f=0,i=h=s=c=r}function E(){return c===r?u:g(Nc())}function O(){var t=Nc(),e=b(t);if(i=arguments,s=this,h=t,e){if(c===r)return w(h);if(d)return Ws(c),c=Ia(m,n),v(h)}return c===r&&(c=Ia(m,n)),u}return O.cancel=_,O.flush=E,O}var Dc=gs((function(t,n){return gi(t,1,n)})),kc=gs((function(t,n,r){return gi(t,Zh(n)||0,r)}));function Lc(t){return $o(t,I)}function qc(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new on(o);var r=function(){var e=arguments,i=n?n.apply(this,e):e[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,e);return r.cache=s.set(i,o)||s,o};return r.cache=new(qc.Cache||Ge),r}qc.Cache=Ge;function Vc(t){if(typeof t!="function")throw new on(o);return function(){var n=arguments;switch(n.length){case 0:return!t.call(this);case 1:return!t.call(this,n[0]);case 2:return!t.call(this,n[0],n[1]);case 3:return!t.call(this,n[0],n[1],n[2])}return!t.apply(this,n)}}function Fc(t){return $c(2,t)}var Gc=Hs((function(t,n){n=n.length==1&&uh(n[0])?Ir(n[0],Br(Ho())):Ir(Ni(n,1),Br(Ho()));var r=n.length;return gs((function(e){for(var i=-1,s=Hn(e.length,r);++i<s;)e[i]=n[i].call(this,e[i]);return yr(t,this,e)}))})),Hc=gs((function(t,n){var e=ue(n,Go(Hc));return $o(t,_,r,n,e)})),zc=gs((function(t,n){var e=ue(n,Go(zc));return $o(t,E,r,n,e)})),Wc=ko((function(t,n){return $o(t,S,r,r,r,n)}));function Bc(t,n){if(typeof t!="function")throw new on(o);return n=n===r?n:Kh(n),gs(t,n)}function Kc(t,n){if(typeof t!="function")throw new on(o);return n=n==null?0:Gn(Kh(n),0),gs((function(r){var e=r[n],i=zs(r,0,n);return e&&jr(i,e),yr(t,this,i)}))}function Jc(t,n,r){var e=!0,i=!0;if(typeof t!="function")throw new on(o);return Sh(r)&&(e="leading"in r?!!r.leading:e,i="trailing"in r?!!r.trailing:i),Uc(t,n,{leading:e,maxWait:n,trailing:i})}function Zc(t){return xc(t,1)}function Qc(t,n){return Hc(Fs(n),t)}function Xc(){if(!arguments.length)return[];var t=arguments[0];return uh(t)?t:[t]}function Yc(t){return yi(t,d)}function th(t,n){return n=typeof n=="function"?n:r,yi(t,d,n)}function nh(t){return yi(t,f|d)}function rh(t,n){return n=typeof n=="function"?n:r,yi(t,f|d,n)}function eh(t,n){return n==null||mi(t,n,Of(n))}function ih(t,n){return t===n||t!==t&&n!==n}var sh=jo(Di),oh=jo((function(t,n){return t>=n})),ah=Hi(function(){return arguments}())?Hi:function(t){return Ih(t)&&ln.call(t,"callee")&&!In.call(t,"callee")},uh=Ut.isArray,ch=fr?Br(fr):zi;function hh(t){return t!=null&&Oh(t.length)&&!_h(t)}function fh(t){return Ih(t)&&hh(t)}function lh(t){return t===!0||t===!1||Ih(t)&&Ui(t)==H}var dh=Dn||Jl,ph=lr?Br(lr):Wi;function vh(t){return Ih(t)&&t.nodeType===1&&!Ch(t)}function wh(t){if(t==null)return!0;if(hh(t)&&(uh(t)||typeof t=="string"||typeof t.splice=="function"||dh(t)||qh(t)||ah(t)))return!t.length;var n=Qo(t);if(n==Z||n==et)return!t.size;if(da(t))return!rs(t).length;for(var r in t)if(ln.call(t,r))return!1;return!0}function yh(t,n){return Bi(t,n)}function bh(t,n,e){e=typeof e=="function"?e:r;var i=e?e(t,n):r;return i===r?Bi(t,n,r,e):!!i}function mh(t){if(!Ih(t))return!1;var n=Ui(t);return n==B||n==W||typeof t.message=="string"&&typeof t.name=="string"&&!Ch(t)}function gh(t){return typeof t=="number"&&kn(t)}function _h(t){if(!Sh(t))return!1;var n=Ui(t);return n==K||n==J||n==G||n==nt}function Eh(t){return typeof t=="number"&&t==Kh(t)}function Oh(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=C}function Sh(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function Ih(t){return t!=null&&typeof t=="object"}var jh=dr?Br(dr):Ji;function Ah(t,n){return t===n||Zi(t,n,Wo(n))}function Nh(t,n,e){return e=typeof e=="function"?e:r,Zi(t,n,Wo(n),e)}function Ph(t){return Mh(t)&&t!=+t}function xh(t){if(la(t))throw new Yt(s);return Qi(t)}function $h(t){return t===null}function Th(t){return t==null}function Mh(t){return typeof t=="number"||Ih(t)&&Ui(t)==Q}function Ch(t){if(!Ih(t)||Ui(t)!=Y)return!1;var n=On(t);if(n===null)return!0;var r=ln.call(n,"constructor")&&n.constructor;return typeof r=="function"&&r instanceof r&&fn.call(r)==wn}var Rh=pr?Br(pr):Xi;function Uh(t){return Eh(t)&&t>=-C&&t<=C}var Dh=vr?Br(vr):Yi;function kh(t){return typeof t=="string"||!uh(t)&&Ih(t)&&Ui(t)==it}function Lh(t){return typeof t=="symbol"||Ih(t)&&Ui(t)==st}var qh=wr?Br(wr):ts;function Vh(t){return t===r}function Fh(t){return Ih(t)&&Qo(t)==at}function Gh(t){return Ih(t)&&Ui(t)==ut}var Hh=jo(is),zh=jo((function(t,n){return t<=n}));function Wh(t){if(!t)return[];if(hh(t))return kh(t)?pe(t):eo(t);if(Nn&&t[Nn])return se(t[Nn]());var n=Qo(t),r=n==Z?oe:n==et?ce:Ff;return r(t)}function Bh(t){if(!t)return t===0?t:0;if(t=Zh(t),t===M||t===-M){var n=t<0?-1:1;return n*R}return t===t?t:0}function Kh(t){var n=Bh(t),r=n%1;return n===n?r?n-r:n:0}function Jh(t){return t?wi(Kh(t),0,D):0}function Zh(t){if(typeof t=="number")return t;if(Lh(t))return U;if(Sh(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=Sh(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=Wr(t);var r=Wt.test(t);return r||Kt.test(t)?rr(t.slice(2),r?2:8):zt.test(t)?U:+t}function Qh(t){return io(t,Sf(t))}function Xh(t){return t?wi(Kh(t),-C,C):t===0?t:0}function Yh(t){return t==null?"":Ms(t)}var tf=uo((function(t,n){if(da(n)||hh(n)){io(n,Of(n),t);return}for(var r in n)ln.call(n,r)&&ci(t,r,n[r])})),nf=uo((function(t,n){io(n,Sf(n),t)})),rf=uo((function(t,n,r,e){io(n,Sf(n),t,e)})),ef=uo((function(t,n,r,e){io(n,Of(n),t,e)})),sf=ko(vi);function of(t,n){var r=Se(t);return n==null?r:li(r,n)}var af=gs((function(t,n){t=rn(t);var e=-1,i=n.length,s=i>2?n[2]:r;for(s&&aa(n[0],n[1],s)&&(i=1);++e<i;)for(var o=n[e],a=Sf(o),u=-1,c=a.length;++u<c;){var h=a[u],f=t[h];(f===r||ih(f,cn[h])&&!ln.call(t,h))&&(t[h]=o[h])}return t})),uf=gs((function(t){return t.push(r,Mo),yr(Nf,r,t)}));function cf(t,n){return Mr(t,Ho(n,3),$i)}function hf(t,n){return Mr(t,Ho(n,3),Ti)}function ff(t,n){return t==null?t:Pi(t,Ho(n,3),Sf)}function lf(t,n){return t==null?t:xi(t,Ho(n,3),Sf)}function df(t,n){return t&&$i(t,Ho(n,3))}function pf(t,n){return t&&Ti(t,Ho(n,3))}function vf(t){return t==null?[]:Mi(t,Of(t))}function wf(t){return t==null?[]:Mi(t,Sf(t))}function yf(t,n,e){var i=t==null?r:Ci(t,n);return i===r?e:i}function bf(t,n){return t!=null&&ta(t,n,ki)}function mf(t,n){return t!=null&&ta(t,n,Li)}var gf=go((function(t,n,r){n!=null&&typeof n.toString!="function"&&(n=vn.call(n)),t[n]=r}),Al($l)),_f=go((function(t,n,r){n!=null&&typeof n.toString!="function"&&(n=vn.call(n)),ln.call(t,n)?t[n].push(r):t[n]=[r]}),Ho),Ef=gs(Gi);function Of(t){return hh(t)?ii(t):rs(t)}function Sf(t){return hh(t)?ii(t,!0):es(t)}function If(t,n){var r={};return n=Ho(n,3),$i(t,(function(t,e,i){pi(r,n(t,e,i),t)})),r}function jf(t,n){var r={};return n=Ho(n,3),$i(t,(function(t,e,i){pi(r,e,n(t,e,i))})),r}var Af=uo((function(t,n,r){us(t,n,r)})),Nf=uo((function(t,n,r,e){us(t,n,r,e)})),Pf=ko((function(t,n){var r={};if(t==null)return r;var e=!1;n=Ir(n,(function(n){return n=Gs(n,t),e||(e=n.length>1),n})),io(t,qo(t),r),e&&(r=yi(r,f|l|d,Co));for(var i=n.length;i--;)Rs(r,n[i]);return r}));function xf(t,n){return Tf(t,Vc(Ho(n)))}var $f=ko((function(t,n){return t==null?{}:ls(t,n)}));function Tf(t,n){if(t==null)return{};var r=Ir(qo(t),(function(t){return[t]}));return n=Ho(n),ds(t,r,(function(t,r){return n(t,r[0])}))}function Mf(t,n,e){n=Gs(n,t);var i=-1,s=n.length;for(s||(s=1,t=r);++i<s;){var o=t==null?r:t[$a(n[i])];o===r&&(i=s,o=e),t=_h(o)?o.call(t):o}return t}function Cf(t,n,r){return t==null?t:Os(t,n,r)}function Rf(t,n,e,i){return i=typeof i=="function"?i:r,t==null?t:Os(t,n,e,i)}var Uf=xo(Of),Df=xo(Sf);function kf(t,n,r){var e=uh(t),i=e||dh(t)||qh(t);if(n=Ho(n,4),r==null){var s=t&&t.constructor;i?r=e?new s:[]:Sh(t)?r=_h(s)?Se(On(t)):{}:r={}}return(i?mr:$i)(t,(function(t,e,i){return n(r,t,e,i)})),r}function Lf(t,n){return t==null?!0:Rs(t,n)}function qf(t,n,r){return t==null?t:Us(t,n,Fs(r))}function Vf(t,n,e,i){return i=typeof i=="function"?i:r,t==null?t:Us(t,n,Fs(e),i)}function Ff(t){return t==null?[]:Kr(t,Of(t))}function Gf(t){return t==null?[]:Kr(t,Sf(t))}function Hf(t,n,e){return e===r&&(e=n,n=r),e!==r&&(e=Zh(e),e=e===e?e:0),n!==r&&(n=Zh(n),n=n===n?n:0),wi(Zh(t),n,e)}function zf(t,n,e){return n=Bh(n),e===r?(e=n,n=0):e=Bh(e),t=Zh(t),qi(t,n,e)}function Wf(t,n,e){if(e&&typeof e!="boolean"&&aa(t,n,e)&&(n=e=r),e===r&&(typeof n=="boolean"?(e=n,n=r):typeof t=="boolean"&&(e=t,t=r)),t===r&&n===r?(t=0,n=1):(t=Bh(t),n===r?(n=t,t=0):n=Bh(n)),t>n){var i=t;t=n,n=i}if(e||t%1||n%1){var s=Qn();return Hn(t+s*(n-t+nr("1e-"+((s+"").length-1))),n)}return ys(t,n)}var Bf=po((function(t,n,r){return n=n.toLowerCase(),t+(r?Kf(n):n)}));function Kf(t){return _l(Yh(t).toLowerCase())}function Jf(t){return t=Yh(t),t&&t.replace(Zt,Yr).replace(Fn,"")}function Zf(t,n,e){t=Yh(t),n=Ms(n);var i=t.length;e=e===r?i:wi(Kh(e),0,i);var s=e;return e-=n.length,e>=0&&t.slice(e,s)==n}function Qf(t){return t=Yh(t),t&&jt.test(t)?t.replace(St,te):t}function Xf(t){return t=Yh(t),t&&Ct.test(t)?t.replace(Mt,"\\$&"):t}var Yf=po((function(t,n,r){return t+(r?"-":"")+n.toLowerCase()})),tl=po((function(t,n,r){return t+(r?" ":"")+n.toLowerCase()})),nl=lo("toLowerCase");function rl(t,n,r){t=Yh(t),n=Kh(n);var e=n?de(t):0;if(!n||e>=n)return t;var i=(n-e)/2;return Oo(Rn(i),r)+t+Oo(Cn(i),r)}function el(t,n,r){t=Yh(t),n=Kh(n);var e=n?de(t):0;return n&&e<n?t+Oo(n-e,r):t}function il(t,n,r){t=Yh(t),n=Kh(n);var e=n?de(t):0;return n&&e<n?Oo(n-e,r)+t:t}function sl(t,n,r){return r||n==null?n=0:n&&(n=+n),Wn(Yh(t).replace(Rt,""),n||0)}function ol(t,n,e){return(e?aa(t,n,e):n===r)?n=1:n=Kh(n),ms(Yh(t),n)}function al(){var t=arguments,n=Yh(t[0]);return t.length<3?n:n.replace(t[1],t[2])}var ul=po((function(t,n,r){return t+(r?"_":"")+n.toLowerCase()}));function cl(t,n,e){return e&&typeof e!="number"&&aa(t,n,e)&&(n=e=r),e=e===r?D:e>>>0,e?(t=Yh(t),t&&(typeof n=="string"||n!=null&&!Rh(n))&&(n=Ms(n),!n&&ee(t))?zs(pe(t),0,e):t.split(n,e)):[]}var hl=po((function(t,n,r){return t+(r?" ":"")+_l(n)}));function fl(t,n,r){return t=Yh(t),r=r==null?0:wi(Kh(r),0,t.length),n=Ms(n),t.slice(r,r+n.length)==n}function ll(t,n,e){var i=Oe.templateSettings;e&&aa(t,n,e)&&(n=r),t=Yh(t),n=rf({},n,i,To);var s=rf({},n.imports,i.imports,To),o=Of(s),u=Kr(s,o),c,h,f=0,l=n.interpolate||Qt,d="__p += '",p=en((n.escape||Qt).source+"|"+l.source+"|"+(l===Pt?Gt:Qt).source+"|"+(n.evaluate||Qt).source+"|$","g"),v="//# sourceURL="+(ln.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Kn+"]")+`\n`;t.replace(p,(function(n,r,e,i,s,o){return e||(e=i),d+=t.slice(f,o).replace(Xt,ne),r&&(c=!0,d+=`' +\n__e(`+r+`) +\n'`),s&&(h=!0,d+=`';\n`+s+`;\n__p += '`),e&&(d+=`' +\n((__t = (`+e+`)) == null ? '' : __t) +\n'`),f=o+n.length,n})),d+=`';\n`;var w=ln.call(n,"variable")&&n.variable;if(!w)d=`with (obj) {\n`+d+`\n}\n`;else if(Vt.test(w))throw new Yt(a);d=(h?d.replace(gt,""):d).replace(_t,"$1").replace(Et,"$1;"),d="function("+(w||"obj")+`) {\n`+(w?"":`obj || (obj = {});\n`)+"var __t, __p = ''"+(c?", __e = _.escape":"")+(h?`, __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n`:`;\n`)+d+`return __p\n}`;var y=Ol((function(){return tn(o,v+"return "+d).apply(r,u)}));if(y.source=d,mh(y))throw y;return y}function dl(t){return Yh(t).toLowerCase()}function pl(t){return Yh(t).toUpperCase()}function vl(t,n,e){if(t=Yh(t),t&&(e||n===r))return Wr(t);if(!t||!(n=Ms(n)))return t;var i=pe(t),s=pe(n),o=Zr(i,s),a=Qr(i,s)+1;return zs(i,o,a).join("")}function wl(t,n,e){if(t=Yh(t),t&&(e||n===r))return t.slice(0,ve(t)+1);if(!t||!(n=Ms(n)))return t;var i=pe(t),s=Qr(i,pe(n))+1;return zs(i,0,s).join("")}function yl(t,n,e){if(t=Yh(t),t&&(e||n===r))return t.replace(Rt,"");if(!t||!(n=Ms(n)))return t;var i=pe(t),s=Zr(i,pe(n));return zs(i,s).join("")}function bl(t,n){var e=j,i=A;if(Sh(n)){var s="separator"in n?n.separator:s;e="length"in n?Kh(n.length):e,i="omission"in n?Ms(n.omission):i}t=Yh(t);var o=t.length;if(ee(t)){var a=pe(t);o=a.length}if(e>=o)return t;var u=e-de(i);if(u<1)return i;var c=a?zs(a,0,u).join(""):t.slice(0,u);if(s===r)return c+i;if(a&&(u+=c.length-u),Rh(s)){if(t.slice(u).search(s)){var h,f=c;for(s.global||(s=en(s.source,Yh(Ht.exec(s))+"g")),s.lastIndex=0;h=s.exec(f);)var l=h.index;c=c.slice(0,l===r?u:l)}}else if(t.indexOf(Ms(s),u)!=u){var d=c.lastIndexOf(s);d>-1&&(c=c.slice(0,d))}return c+i}function ml(t){return t=Yh(t),t&&It.test(t)?t.replace(Ot,we):t}var gl=po((function(t,n,r){return t+(r?" ":"")+n.toUpperCase()})),_l=lo("toUpperCase");function El(t,n,e){return t=Yh(t),n=e?r:n,n===r?ie(t)?me(t):Tr(t):t.match(n)||[]}var Ol=gs((function(t,n){try{return yr(t,r,n)}catch(t){return mh(t)?t:new Yt(t)}})),Sl=ko((function(t,n){return mr(n,(function(n){n=$a(n),pi(t,n,Tc(t[n],t))})),t}));function Il(t){var n=t==null?0:t.length,r=Ho();return t=n?Ir(t,(function(t){if(typeof t[1]!="function")throw new on(o);return[r(t[0]),t[1]]})):[],gs((function(r){for(var e=-1;++e<n;){var i=t[e];if(yr(i[0],this,r))return yr(i[1],this,r)}}))}function jl(t){return bi(yi(t,f))}function Al(t){return function(){return t}}function Nl(t,n){return t==null||t!==t?n:t}var Pl=bo(),xl=bo(!0);function $l(t){return t}function Tl(t){return ns(typeof t=="function"?t:yi(t,f))}function Ml(t){return os(yi(t,f))}function Cl(t,n){return as(t,yi(n,f))}var Rl=gs((function(t,n){return function(r){return Gi(r,t,n)}})),Ul=gs((function(t,n){return function(r){return Gi(t,r,n)}}));function Dl(t,n,r){var e=Of(n),i=Mi(n,e);r==null&&!(Sh(n)&&(i.length||!e.length))&&(r=n,n=t,t=this,i=Mi(n,Of(n)));var s=!(Sh(r)&&"chain"in r)||!!r.chain,o=_h(t);return mr(i,(function(r){var e=n[r];t[r]=e,o&&(t.prototype[r]=function(){var n=this.__chain__;if(s||n){var r=t(this.__wrapped__),i=r.__actions__=eo(this.__actions__);return i.push({func:e,args:arguments,thisArg:t}),r.__chain__=n,r}return e.apply(t,jr([this.value()],arguments))})})),t}function kl(){return sr._===this&&(sr._=yn),this}function Ll(){}function ql(t){return t=Kh(t),gs((function(n){return hs(n,t)}))}var Vl=Eo(Ir),Fl=Eo(_r),Gl=Eo(Pr);function Hl(t){return ua(t)?Lr($a(t)):ps(t)}function zl(t){return function(n){return t==null?r:Ci(t,n)}}var Wl=Io(),Bl=Io(!0);function Kl(){return[]}function Jl(){return!1}function Zl(){return{}}function Ql(){return""}function Xl(){return!0}function Yl(t,n){if(t=Kh(t),t<1||t>C)return[];var r=D,e=Hn(t,D);n=Ho(n),t-=D;for(var i=Hr(e,n);++r<t;)n(r);return i}function td(t){return uh(t)?Ir(t,$a):Lh(t)?[t]:eo(xa(Yh(t)))}function nd(t){var n=++dn;return Yh(t)+n}var rd=_o((function(t,n){return t+n}),0),ed=No("ceil"),id=_o((function(t,n){return t/n}),1),sd=No("floor");function od(t){return t&&t.length?Ii(t,$l,Di):r}function ad(t,n){return t&&t.length?Ii(t,Ho(n,2),Di):r}function ud(t){return kr(t,$l)}function cd(t,n){return kr(t,Ho(n,2))}function hd(t){return t&&t.length?Ii(t,$l,is):r}function fd(t,n){return t&&t.length?Ii(t,Ho(n,2),is):r}var ld=_o((function(t,n){return t*n}),1),dd=No("round"),pd=_o((function(t,n){return t-n}),0);function vd(t){return t&&t.length?Gr(t,$l):0}function wd(t,n){return t&&t.length?Gr(t,Ho(n,2)):0}return Oe.after=Pc,Oe.ary=xc,Oe.assign=tf,Oe.assignIn=nf,Oe.assignInWith=rf,Oe.assignWith=ef,Oe.at=sf,Oe.before=$c,Oe.bind=Tc,Oe.bindAll=Sl,Oe.bindKey=Mc,Oe.castArray=Xc,Oe.chain=zu,Oe.chunk=Ra,Oe.compact=Ua,Oe.concat=Da,Oe.cond=Il,Oe.conforms=jl,Oe.constant=Al,Oe.countBy=rc,Oe.create=of,Oe.curry=Cc,Oe.curryRight=Rc,Oe.debounce=Uc,Oe.defaults=af,Oe.defaultsDeep=uf,Oe.defer=Dc,Oe.delay=kc,Oe.difference=ka,Oe.differenceBy=La,Oe.differenceWith=qa,Oe.drop=Va,Oe.dropRight=Fa,Oe.dropRightWhile=Ga,Oe.dropWhile=Ha,Oe.fill=za,Oe.filter=ic,Oe.flatMap=ac,Oe.flatMapDeep=uc,Oe.flatMapDepth=cc,Oe.flatten=Ka,Oe.flattenDeep=Ja,Oe.flattenDepth=Za,Oe.flip=Lc,Oe.flow=Pl,Oe.flowRight=xl,Oe.fromPairs=Qa,Oe.functions=vf,Oe.functionsIn=wf,Oe.groupBy=lc,Oe.initial=tu,Oe.intersection=nu,Oe.intersectionBy=ru,Oe.intersectionWith=eu,Oe.invert=gf,Oe.invertBy=_f,Oe.invokeMap=pc,Oe.iteratee=Tl,Oe.keyBy=vc,Oe.keys=Of,Oe.keysIn=Sf,Oe.map=wc,Oe.mapKeys=If,Oe.mapValues=jf,Oe.matches=Ml,Oe.matchesProperty=Cl,Oe.memoize=qc,Oe.merge=Af,Oe.mergeWith=Nf,Oe.method=Rl,Oe.methodOf=Ul,Oe.mixin=Dl,Oe.negate=Vc,Oe.nthArg=ql,Oe.omit=Pf,Oe.omitBy=xf,Oe.once=Fc,Oe.orderBy=yc,Oe.over=Vl,Oe.overArgs=Gc,Oe.overEvery=Fl,Oe.overSome=Gl,Oe.partial=Hc,Oe.partialRight=zc,Oe.partition=bc,Oe.pick=$f,Oe.pickBy=Tf,Oe.property=Hl,Oe.propertyOf=zl,Oe.pull=uu,Oe.pullAll=cu,Oe.pullAllBy=hu,Oe.pullAllWith=fu,Oe.pullAt=lu,Oe.range=Wl,Oe.rangeRight=Bl,Oe.rearg=Wc,Oe.reject=_c,Oe.remove=du,Oe.rest=Bc,Oe.reverse=pu,Oe.sampleSize=Oc,Oe.set=Cf,Oe.setWith=Rf,Oe.shuffle=Sc,Oe.slice=vu,Oe.sortBy=Ac,Oe.sortedUniq=Eu,Oe.sortedUniqBy=Ou,Oe.split=cl,Oe.spread=Kc,Oe.tail=Su,Oe.take=Iu,Oe.takeRight=ju,Oe.takeRightWhile=Au,Oe.takeWhile=Nu,Oe.tap=Wu,Oe.throttle=Jc,Oe.thru=Bu,Oe.toArray=Wh,Oe.toPairs=Uf,Oe.toPairsIn=Df,Oe.toPath=td,Oe.toPlainObject=Qh,Oe.transform=kf,Oe.unary=Zc,Oe.union=Pu,Oe.unionBy=xu,Oe.unionWith=$u,Oe.uniq=Tu,Oe.uniqBy=Mu,Oe.uniqWith=Cu,Oe.unset=Lf,Oe.unzip=Ru,Oe.unzipWith=Uu,Oe.update=qf,Oe.updateWith=Vf,Oe.values=Ff,Oe.valuesIn=Gf,Oe.without=Du,Oe.words=El,Oe.wrap=Qc,Oe.xor=ku,Oe.xorBy=Lu,Oe.xorWith=qu,Oe.zip=Vu,Oe.zipObject=Fu,Oe.zipObjectDeep=Gu,Oe.zipWith=Hu,Oe.entries=Uf,Oe.entriesIn=Df,Oe.extend=nf,Oe.extendWith=rf,Dl(Oe,Oe),Oe.add=rd,Oe.attempt=Ol,Oe.camelCase=Bf,Oe.capitalize=Kf,Oe.ceil=ed,Oe.clamp=Hf,Oe.clone=Yc,Oe.cloneDeep=nh,Oe.cloneDeepWith=rh,Oe.cloneWith=th,Oe.conformsTo=eh,Oe.deburr=Jf,Oe.defaultTo=Nl,Oe.divide=id,Oe.endsWith=Zf,Oe.eq=ih,Oe.escape=Qf,Oe.escapeRegExp=Xf,Oe.every=ec,Oe.find=sc,Oe.findIndex=Wa,Oe.findKey=cf,Oe.findLast=oc,Oe.findLastIndex=Ba,Oe.findLastKey=hf,Oe.floor=sd,Oe.forEach=hc,Oe.forEachRight=fc,Oe.forIn=ff,Oe.forInRight=lf,Oe.forOwn=df,Oe.forOwnRight=pf,Oe.get=yf,Oe.gt=sh,Oe.gte=oh,Oe.has=bf,Oe.hasIn=mf,Oe.head=Xa,Oe.identity=$l,Oe.includes=dc,Oe.indexOf=Ya,Oe.inRange=zf,Oe.invoke=Ef,Oe.isArguments=ah,Oe.isArray=uh,Oe.isArrayBuffer=ch,Oe.isArrayLike=hh,Oe.isArrayLikeObject=fh,Oe.isBoolean=lh,Oe.isBuffer=dh,Oe.isDate=ph,Oe.isElement=vh,Oe.isEmpty=wh,Oe.isEqual=yh,Oe.isEqualWith=bh,Oe.isError=mh,Oe.isFinite=gh,Oe.isFunction=_h,Oe.isInteger=Eh,Oe.isLength=Oh,Oe.isMap=jh,Oe.isMatch=Ah,Oe.isMatchWith=Nh,Oe.isNaN=Ph,Oe.isNative=xh,Oe.isNil=Th,Oe.isNull=$h,Oe.isNumber=Mh,Oe.isObject=Sh,Oe.isObjectLike=Ih,Oe.isPlainObject=Ch,Oe.isRegExp=Rh,Oe.isSafeInteger=Uh,Oe.isSet=Dh,Oe.isString=kh,Oe.isSymbol=Lh,Oe.isTypedArray=qh,Oe.isUndefined=Vh,Oe.isWeakMap=Fh,Oe.isWeakSet=Gh,Oe.join=iu,Oe.kebabCase=Yf,Oe.last=su,Oe.lastIndexOf=ou,Oe.lowerCase=tl,Oe.lowerFirst=nl,Oe.lt=Hh,Oe.lte=zh,Oe.max=od,Oe.maxBy=ad,Oe.mean=ud,Oe.meanBy=cd,Oe.min=hd,Oe.minBy=fd,Oe.stubArray=Kl,Oe.stubFalse=Jl,Oe.stubObject=Zl,Oe.stubString=Ql,Oe.stubTrue=Xl,Oe.multiply=ld,Oe.nth=au,Oe.noConflict=kl,Oe.noop=Ll,Oe.now=Nc,Oe.pad=rl,Oe.padEnd=el,Oe.padStart=il,Oe.parseInt=sl,Oe.random=Wf,Oe.reduce=mc,Oe.reduceRight=gc,Oe.repeat=ol,Oe.replace=al,Oe.result=Mf,Oe.round=dd,Oe.runInContext=t,Oe.sample=Ec,Oe.size=Ic,Oe.snakeCase=ul,Oe.some=jc,Oe.sortedIndex=wu,Oe.sortedIndexBy=yu,Oe.sortedIndexOf=bu,Oe.sortedLastIndex=mu,Oe.sortedLastIndexBy=gu,Oe.sortedLastIndexOf=_u,Oe.startCase=hl,Oe.startsWith=fl,Oe.subtract=pd,Oe.sum=vd,Oe.sumBy=wd,Oe.template=ll,Oe.times=Yl,Oe.toFinite=Bh,Oe.toInteger=Kh,Oe.toLength=Jh,Oe.toLower=dl,Oe.toNumber=Zh,Oe.toSafeInteger=Xh,Oe.toString=Yh,Oe.toUpper=pl,Oe.trim=vl,Oe.trimEnd=wl,Oe.trimStart=yl,Oe.truncate=bl,Oe.unescape=ml,Oe.uniqueId=nd,Oe.upperCase=gl,Oe.upperFirst=_l,Oe.each=hc,Oe.eachRight=fc,Oe.first=Xa,Dl(Oe,function(){var t={};return $i(Oe,(function(n,r){ln.call(Oe.prototype,r)||(t[r]=n)})),t}(),{chain:!1}),Oe.VERSION=e,mr(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Oe[t].placeholder=Oe})),mr(["drop","take"],(function(t,n){Ae.prototype[t]=function(e){e=e===r?1:Gn(Kh(e),0);var i=this.__filtered__&&!n?new Ae(this):this.clone();return i.__filtered__?i.__takeCount__=Hn(e,i.__takeCount__):i.__views__.push({size:Hn(e,D),type:t+(i.__dir__<0?"Right":"")}),i},Ae.prototype[t+"Right"]=function(n){return this.reverse()[t](n).reverse()}})),mr(["filter","map","takeWhile"],(function(t,n){var r=n+1,e=r==x||r==T;Ae.prototype[t]=function(t){var n=this.clone();return n.__iteratees__.push({iteratee:Ho(t,3),type:r}),n.__filtered__=n.__filtered__||e,n}})),mr(["head","last"],(function(t,n){var r="take"+(n?"Right":"");Ae.prototype[t]=function(){return this[r](1).value()[0]}})),mr(["initial","tail"],(function(t,n){var r="drop"+(n?"":"Right");Ae.prototype[t]=function(){return this.__filtered__?new Ae(this):this[r](1)}})),Ae.prototype.compact=function(){return this.filter($l)},Ae.prototype.find=function(t){return this.filter(t).head()},Ae.prototype.findLast=function(t){return this.reverse().find(t)},Ae.prototype.invokeMap=gs((function(t,n){return typeof t=="function"?new Ae(this):this.map((function(r){return Gi(r,t,n)}))})),Ae.prototype.reject=function(t){return this.filter(Vc(Ho(t)))},Ae.prototype.slice=function(t,n){t=Kh(t);var e=this;return e.__filtered__&&(t>0||n<0)?new Ae(e):(t<0?e=e.takeRight(-t):t&&(e=e.drop(t)),n!==r&&(n=Kh(n),e=n<0?e.dropRight(-n):e.take(n-t)),e)},Ae.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ae.prototype.toArray=function(){return this.take(D)},$i(Ae.prototype,(function(t,n){var e=/^(?:filter|find|map|reject)|While$/.test(n),i=/^(?:head|last)$/.test(n),s=Oe[i?"take"+(n=="last"?"Right":""):n],o=i||/^find/.test(n);s&&(Oe.prototype[n]=function(){var n=this.__wrapped__,a=i?[1]:arguments,u=n instanceof Ae,c=a[0],h=u||uh(n),f=function(t){var n=s.apply(Oe,jr([t],a));return i&&l?n[0]:n};h&&e&&typeof c=="function"&&c.length!=1&&(u=h=!1);var l=this.__chain__,d=!!this.__actions__.length,p=o&&!l,v=u&&!d;if(!o&&h){n=v?n:new Ae(this);var w=t.apply(n,a);return w.__actions__.push({func:Bu,args:[f],thisArg:r}),new je(w,l)}return p&&v?t.apply(this,a):(w=this.thru(f),p?i?w.value()[0]:w.value():w)})})),mr(["pop","push","shift","sort","splice","unshift"],(function(t){var n=an[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",e=/^(?:pop|shift)$/.test(t);Oe.prototype[t]=function(){var t=arguments;if(e&&!this.__chain__){var i=this.value();return n.apply(uh(i)?i:[],t)}return this[r]((function(r){return n.apply(uh(r)?r:[],t)}))}})),$i(Ae.prototype,(function(t,n){var r=Oe[n];if(r){var e=r.name+"";ln.call(hr,e)||(hr[e]=[]),hr[e].push({name:n,func:r})}})),hr[mo(r,y).name]=[{name:"wrapper",func:r}],Ae.prototype.clone=Ne,Ae.prototype.reverse=Pe,Ae.prototype.value=xe,Oe.prototype.at=Ku,Oe.prototype.chain=Ju,Oe.prototype.commit=Zu,Oe.prototype.next=Qu,Oe.prototype.plant=Yu,Oe.prototype.reverse=tc,Oe.prototype.toJSON=Oe.prototype.valueOf=Oe.prototype.value=nc,Oe.prototype.first=Oe.prototype.head,Nn&&(Oe.prototype[Nn]=Xu),Oe},_e=ge();ar?((ar.exports=_e)._=_e,or._=_e):sr._=_e}).call(Ad)})(Nd,Nd.exports);var Pd=Object.defineProperty,xd=Object.defineProperties,$d=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,Md=Object.prototype.hasOwnProperty,Cd=Object.prototype.propertyIsEnumerable,Rd=(t,n,r)=>n in t?Pd(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,Ud=(t,n)=>{for(var r in n||(n={}))Md.call(n,r)&&Rd(t,r,n[r]);if(Td)for(var r of Td(n))Cd.call(n,r)&&Rd(t,r,n[r]);return t},Dd=(t,n)=>xd(t,$d(n));function kd(t,n,r){var e;const i=Jn(t);return((e=n.rpcMap)==null?void 0:e[i.reference])||`${Id}?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function Ld(t){return t.includes(":")?t.split(":")[1]:t}function qd(t){return t.map((t=>`${t.split(":")[0]}:${t.split(":")[1]}`))}function Vd(t,n){const r=Object.keys(n.namespaces).filter((n=>n.includes(t)));if(!r.length)return[];const e=[];return r.forEach((t=>{const r=n.namespaces[t].accounts;e.push(...r)})),e}function Fd(t={},n={}){const r=Gd(t),e=Gd(n);return Nd.exports.merge(r,e)}function Gd(t){var n,r,e,i;const s={};if(!Ae(t))return s;for(const[o,a]of Object.entries(t)){const t=ge(o)?[o]:a.chains,u=a.methods||[],c=a.events||[],h=a.rpcMap||{},f=_e(o);s[f]=Dd(Ud(Ud({},s[f]),a),{chains:Yr(t,(n=s[f])==null?void 0:n.chains),methods:Yr(u,(r=s[f])==null?void 0:r.methods),events:Yr(c,(e=s[f])==null?void 0:e.events),rpcMap:Ud(Ud({},h),(i=s[f])==null?void 0:i.rpcMap)})}return s}function Hd(t){return t.includes(":")?t.split(":")[2]:t}function zd(t){const n={};for(const[r,e]of Object.entries(t)){const t=e.methods||[],i=e.events||[],s=e.accounts||[],o=ge(r)?[r]:e.chains?e.chains:qd(e.accounts);n[r]={chains:o,methods:t,events:i,accounts:s}}return n}function Wd(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):t.includes(":")?Number(t.split(":")[1]):Number(t)}const Bd={},Kd=t=>Bd[t],Jd=(t,n)=>{Bd[t]=n};class Zd{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2]))||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=Ld(n);t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class Qd{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}if(this.namespace.methods.includes(t.request.method)){const n=await this.client.request(t);console.log(n);return n}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(parseInt(t),n),this.chainId=parseInt(t),this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,n){const r=n||kd(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=parseInt(Ld(n));t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}getHttpProvider(){const t=this.chainId,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}async handleSwitchChain(t){var n,r;let e=t.request.params?(n=t.request.params[0])==null?void 0:n.chainId:"0x0";e=e.startsWith("0x")?e:`0x${e}`;const i=parseInt(e,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:e}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class Xd{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=Ld(n);t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class Yd{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=Ld(n);t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class tp{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{const r=this.getCardanoRPCUrl(n),e=Ld(n);t[e]=this.createHttpProvider(e,r)})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}getCardanoRPCUrl(t){const n=this.namespace.rpcMap;if(n)return n[t]}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||this.getCardanoRPCUrl(t);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class np{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=Ld(n);t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class rp{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;const e=Ld(n);t[e]=this.createHttpProvider(e,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Ju(new md(r,Kd("disableProviderPing")))}}class ep{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Kd("events"),this.client=Kd("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(this.chainId=t,!this.httpProviders[t]){const r=n||kd(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(jd.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2]))||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((n=>{var r;t[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||kd(t,this.namespace);return typeof r>"u"?void 0:new Ju(new md(r,Kd("disableProviderPing")))}}var ip=Object.defineProperty,sp=Object.defineProperties,op=Object.getOwnPropertyDescriptors,ap=Object.getOwnPropertySymbols,up=Object.prototype.hasOwnProperty,cp=Object.prototype.propertyIsEnumerable,hp=(t,n,r)=>n in t?ip(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,fp=(t,n)=>{for(var r in n||(n={}))up.call(n,r)&&hp(t,r,n[r]);if(ap)for(var r of ap(n))cp.call(n,r)&&hp(t,r,n[r]);return t},lp=(t,n)=>sp(t,op(n));class dp{constructor(n){this.events=new t,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=n,this.logger=typeof n?.logger<"u"&&typeof n?.logger!="string"?n.logger:To.pino(To.getDefaultLoggerOptions({level:n?.logger||gd})),this.disableProviderPing=n?.disableProviderPing||!1}static async init(t){const n=new dp(t);return await n.initialize(),n}async request(t,n){const[r,e]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(r).request({request:fp({},t),chainId:`${r}:${e}`,topic:this.session.topic})}sendAsync(t,n,r){this.request(t,r).then((t=>n(null,t))).catch((t=>n(t,void 0)))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:Ie("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}removeListener(t,n){this.events.removeListener(t,n)}off(t,n){this.events.off(t,n)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let n=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(n>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:r,approval:e}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});r&&(this.uri=r,this.events.emit("display_uri",r)),await e().then((t=>{this.session=t,this.namespaces||(this.namespaces=zd(t.namespaces),this.persist("namespaces",this.namespaces))})).catch((t=>{if(t.message!==ql)throw t;n++}))}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,n){try{if(!this.session)return;const[r,e]=this.validateChain(t);this.getProvider(r).setDefaultChain(e,n)}catch(t){if(!/Please call connect/.test(t.message))throw t}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(je(n)){for(const r of n)t.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ud.init({logger:this.providerOpts.logger||gd,relayUrl:this.providerOpts.relayUrl||_d,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map((t=>_e(t))))];Jd("client",this.client),Jd("events",this.events),Jd("disableProviderPing",this.disableProviderPing),t.forEach((t=>{if(!this.session)return;const n=Vd(t,this.session),r=qd(n),e=Fd(this.namespaces,this.optionalNamespaces),i=lp(fp({},e[t]),{accounts:n,chains:r});switch(t){case"eip155":this.rpcProviders[t]=new Qd({namespace:i});break;case"solana":this.rpcProviders[t]=new Xd({namespace:i});break;case"cosmos":this.rpcProviders[t]=new Yd({namespace:i});break;case"polkadot":this.rpcProviders[t]=new Zd({namespace:i});break;case"cip34":this.rpcProviders[t]=new tp({namespace:i});break;case"elrond":this.rpcProviders[t]=new np({namespace:i});break;case"multiversx":this.rpcProviders[t]=new rp({namespace:i});break;case"near":this.rpcProviders[t]=new ep({namespace:i});break}}))}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",(t=>{this.events.emit("session_ping",t)})),this.client.on("session_event",(t=>{const{params:n}=t,{event:r}=n;if(r.name==="accountsChanged"){const t=r.data;t&&je(t)&&this.events.emit("accountsChanged",t.map(Hd))}else if(r.name==="chainChanged"){const t=n.chainId,r=n.event.data,e=_e(t),i=Wd(t)!==Wd(r)?`${e}:${Wd(r)}`:t;this.onChainChanged(i)}else this.events.emit(r.name,r.data);this.events.emit("session_event",t)})),this.client.on("session_update",(({topic:t,params:n})=>{var r;const{namespaces:e}=n,i=(r=this.client)==null?void 0:r.session.get(t);this.session=lp(fp({},i),{namespaces:e}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:n})})),this.client.on("session_delete",(async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",lp(fp({},Ie("USER_DISCONNECTED")),{data:t.topic}))})),this.on(jd.DEFAULT_CHAIN_CHANGED,(t=>{this.onChainChanged(t,!0)}))}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach((t=>{var n;this.getProvider(t).updateNamespace((n=this.session)==null?void 0:n.namespaces[t])}))}setNamespaces(t){const{namespaces:n,optionalNamespaces:r,sessionProperties:e}=t;n&&Object.keys(n).length&&(this.namespaces=n),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=e,this.persist("namespaces",n),this.persist("optionalNamespaces",r)}validateChain(t){const[n,r]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map((t=>_e(t))).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const e=_e(Object.keys(this.namespaces)[0]),i=this.rpcProviders[e].getDefaultChain();return[e,i]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,n=!1){var r;if(!this.namespaces)return;const[e,i]=this.validateChain(t);n||this.getProvider(e).setDefaultChain(i),((r=this.namespaces[e])!=null?r:this.namespaces[`${e}:${i}`]).defaultChain=i,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,n){this.client.core.storage.setItem(`${Sd}/${t}`,n)}async getFromStore(t){return await this.client.core.storage.getItem(`${Sd}/${t}`)}}const pp=dp;const vp="wc",wp="ethereum_provider",yp=`${vp}@2:${wp}:`,bp="https://rpc.walletconnect.com/v1/",mp=["eth_sendTransaction","personal_sign"],gp=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],_p=["chainChanged","accountsChanged"],Ep=["chainChanged","accountsChanged","message","disconnect","connect"];var Op=Object.defineProperty,Sp=Object.defineProperties,Ip=Object.getOwnPropertyDescriptors,jp=Object.getOwnPropertySymbols,Ap=Object.prototype.hasOwnProperty,Np=Object.prototype.propertyIsEnumerable,Pp=(t,n,r)=>n in t?Op(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,xp=(t,n)=>{for(var r in n||(n={}))Ap.call(n,r)&&Pp(t,r,n[r]);if(jp)for(var r of jp(n))Np.call(n,r)&&Pp(t,r,n[r]);return t},$p=(t,n)=>Sp(t,Ip(n));function Tp(t){return Number(t[0].split(":")[1])}function Mp(t){return`0x${t.toString(16)}`}function Cp(t){const{chains:n,optionalChains:r,methods:e,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=t;if(!je(n))throw new Error("Invalid chains");const u={chains:n,methods:e||mp,events:s||_p,rpcMap:xp({},n.length?{[Tp(n)]:a[Tp(n)]}:{})},c=s?.filter((t=>!_p.includes(t))),h=e?.filter((t=>!mp.includes(t)));if(!r&&!o&&!i&&!(c!=null&&c.length)&&!(h!=null&&h.length))return{required:n.length?u:void 0};const f=c?.length&&h?.length||!r,l={chains:[...new Set(f?u.chains.concat(r||[]):r)],methods:[...new Set(u.methods.concat(i!=null&&i.length?i:gp))],events:[...new Set(u.events.concat(o!=null&&o.length?o:Ep))],rpcMap:a};return{required:n.length?u:void 0,optional:r.length?l:void 0}}class Rp{constructor(){this.events=new t.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=yp,this.on=(t,n)=>(this.events.on(t,n),this),this.once=(t,n)=>(this.events.once(t,n),this),this.removeListener=(t,n)=>(this.events.removeListener(t,n),this),this.off=(t,n)=>(this.events.off(t,n),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const n=new Rp;return await n.initialize(t),n}async request(t){const n=await this.signer.request(t,this.formatChainId(this.chainId));console.log("TX req: ",t);console.log("TX res: ",n);return n}sendAsync(t,n){this.signer.sendAsync(t,n,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:n,optional:r}=Cp(this.rpc);try{const e=await new Promise((async(e,i)=>{var s;this.rpc.showQrModal&&((s=this.modal)==null||s.subscribeModal((t=>{!t.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))}))),await this.signer.connect($p(xp({namespaces:xp({},n&&{[this.namespace]:n})},r&&{optionalNamespaces:{[this.namespace]:r}}),{pairingTopic:t?.pairingTopic})).then((t=>{e(t)})).catch((t=>{i(new Error(t.message))}))}));if(!e)return;const i=Zn(e.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Mp(this.chainId)})}catch(t){throw this.signer.logger.error(t),t}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",(t=>{const{params:n}=t,{event:r}=n;r.name==="accountsChanged"?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):r.name==="chainChanged"?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",t)})),this.signer.on("chainChanged",(t=>{const n=parseInt(t);this.chainId=n,this.events.emit("chainChanged",Mp(this.chainId)),this.persist()})),this.signer.on("session_update",(t=>{this.events.emit("session_update",t)})),this.signer.on("session_delete",(t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",$p(xp({},Ie("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))})),this.signer.on("display_uri",(t=>{var n,r;this.rpc.showQrModal&&((n=this.modal)==null||n.closeModal(),(r=this.modal)==null||r.openModal({uri:t})),this.events.emit("display_uri",t)}))}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const n=t.filter((t=>this.isCompatibleChainId(t))).map((t=>this.parseChainId(t)));n.length&&(this.chainId=n[0],this.events.emit("chainChanged",Mp(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const n=this.parseChainId(t);this.chainId=n,this.switchEthereumChain(n)}}parseAccountId(t){const[n,r,e]=t.split(":");return{chainId:`${n}:${r}`,address:e}}setAccounts(t){this.accounts=t.filter((t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId)).map((t=>this.parseAccountId(t).address)),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var n,r;const e=(n=t?.chains)!=null?n:[],i=(r=t?.optionalChains)!=null?r:[],s=e.concat(i);if(!s.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const o=e.length?t?.methods||mp:[],a=e.length?t?.events||_p:[],u=t?.optionalMethods||[],c=t?.optionalEvents||[],h=t?.rpcMap||this.buildRpcMap(s,t.projectId),f=t?.qrModalOptions||void 0;return{chains:e?.map((t=>this.formatChainId(t))),optionalChains:i.map((t=>this.formatChainId(t))),methods:o,events:a,optionalMethods:u,optionalEvents:c,rpcMap:h,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:f,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,n){const r={};return t.forEach((t=>{r[t]=this.getRpcUrl(t,n)})),r}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Tp(this.rpc.chains):Tp(this.rpc.optionalChains),this.signer=await pp.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await import("@walletconnect/modal");t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(xp({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(t){throw this.signer.logger.error(t),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:n,optionalChains:r,rpcMap:e}=t;n&&je(n)&&(this.rpc.chains=n.map((t=>this.formatChainId(t))),n.forEach((t=>{this.rpc.rpcMap[t]=e?.[t]||this.getRpcUrl(t)}))),r&&je(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=r?.map((t=>this.formatChainId(t))),r.forEach((t=>{this.rpc.rpcMap[t]=e?.[t]||this.getRpcUrl(t)})))}getRpcUrl(t,n){var r;return((r=this.rpc.rpcMap)==null?void 0:r[t])||`${bp}?chainId=eip155:${t}&projectId=${n||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),n=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:n?.accounts),this.setAccounts(n?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map((t=>this.parseAccount(t)))}}const Up={1:"https://ethereum.publicnode.com",5:"https://eth-goerli.g.alchemy.com/v2/yVhq9zPJorAWsw-F87fEabSUl7cCU6z4",11155111:"https://sepolia.infura.io/v3/9f79b2f9274344af90b8d4e244b580ef",137:"https://polygon-rpc.com/",80001:"https://polygon-mumbai.g.alchemy.com/v2/rVI6pOV4irVsrw20cJxc1fxK_1cSeiY0",56:"https://bsc-dataseed.binance.org/",97:"https://data-seed-prebsc-1-s1.binance.org:8545",43114:"https://api.avax.network/ext/bc/C/rpc",43113:"https://api.avax-test.network/ext/bc/C/rpc",250:"https://rpc.fantom.network/",25:"https://evm-cronos.crypto.org",338:"https://evm-t3.cronos.org",42161:"https://arb1.arbitrum.io/rpc",421613:"https://arb-goerli.g.alchemy.com/v2/nFrflomLgsQQL5NWjGileAVqIGGxZWce",10:"https://mainnet.optimism.io"};const Dp=[1,5,11155111,137,80001,56,97,42161,10];const kp=async()=>await Rp.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",methods:["eth_sendTransaction","eth_signTransaction","eth_sign","personal_sign","eth_signTypedData"],events:["chainChanged","accountsChanged"],showQrModal:false,optionalChains:Dp});export{Up as WC_DEFAULT_RPC_MAP,Dp as WC_V2_DEFAULT_CHAINS,kp as getWalletConnectV2ProviderInstance};
//# sourceMappingURL=p-1f1b1e11.js.map