var t;(function(t){t["TOKENS_UPDATED"]="tokensUpdated";t["GET_USER_INPUT"]="getUserInput";t["EXECUTE_CALLBACK"]="executeCallback";t["ON_CONFIRM"]="onConfirm"})(t||(t={}));var s;(function(t){t["SIGN_PERSONAL_MESSAGE"]="signPersonalMessage";t["PUT_USER_INPUT"]="putUserInput"})(s||(s={}));class i{constructor(t,s){this.tokenScript=t;this.viewAdapter=s;this.userEntryValues={}}async showCard(t){this.currentCard=t;this.viewAdapter.viewLoading();await this.viewAdapter.showTokenView(this.currentCard)}async unloadTokenCard(){this.currentCard=null;await this.viewAdapter.unloadTokenView()}getCurrentCard(){return this.currentCard}getUserEntryValue(t){if(!this.userEntryValues[t])return undefined;return this.userEntryValues[t]}async setUserEntryValues(t){const s=[];let i=false;for(let e in t){if(this.userEntryValues[e]&&this.userEntryValues[e]===t[e]){continue}if(!this.userEntryValues[e]&&t[e]==="")continue;const n=this.findAttribute(e);if(!n&&!i)i=true;console.log("User input '"+e+"' changed ("+this.userEntryValues[e]+" -> "+t[e]+")");s.push(e);this.userEntryValues[e]=t[e]}if(s.length>0){this.tokenScript.getAttributes().invalidate(s);if(this.currentCard)this.currentCard.getAttributes().invalidate(s);if(i)this.updateCardData()}}findAttribute(t){if(this.tokenScript.getAttributes().hasAttribute(t))return this.tokenScript.getAttributes().getAttribute(t);if(this.currentCard&&this.currentCard.getAttributes().hasAttribute(t))return this.currentCard.getAttributes().getAttribute(t);return null}dispatchViewEvent(t,s,i){return this.viewAdapter.dispatchViewEvent(t,s,i)}async updateCardData(){this.viewAdapter.viewLoading();this.viewAdapter.dispatchViewEvent(t.TOKENS_UPDATED,await this.currentCard.tokenViewData.getCurrentTokenData(true),this.currentCard.tokenViewData.getViewDataId())}}export{s as R,t as V,i as a};
//# sourceMappingURL=p-e3f47bbc.js.map