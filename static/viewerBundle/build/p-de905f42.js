import{E as e}from"./p-1d75f834.js";import{W as t}from"./p-4d4dcfe3.js";import{r,q as n}from"./p-5267f02f.js";import"./p-404a2ccb.js";import"./p-ea15b96e.js";function o(e,{strict:t=true}={}){if(!e)return false;if(typeof e!=="string")return false;return t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function s(e){if(o(e,{strict:false}))return Math.ceil((e.length-2)/2);return e.length}const i="2.18.0";const u=e=>e;const c=()=>`viem@${i}`;class a extends Error{constructor(e,t={}){super();Object.defineProperty(this,"details",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"docsPath",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"metaMessages",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"shortMessage",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ViemError"});Object.defineProperty(this,"version",{enumerable:true,configurable:true,writable:true,value:c()});const r=t.cause instanceof a?t.cause.details:t.cause?.message?t.cause.message:t.details;const n=t.cause instanceof a?t.cause.docsPath||t.docsPath:t.docsPath;this.message=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...n?[`Docs: ${t.docsBaseUrl??"https://viem.sh"}${n}${t.docsSlug?`#${t.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join("\n");if(t.cause)this.cause=t.cause;this.details=r;this.docsPath=n;this.metaMessages=t.metaMessages;this.shortMessage=e}walk(e){return l(this,e)}}function l(e,t){if(t?.(e))return e;if(e&&typeof e==="object"&&"cause"in e)return l(e.cause,t);return t?null:e}class d extends a{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`);Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"SizeExceedsPaddingSizeError"})}}function f(e,{dir:t,size:r=32}={}){if(typeof e==="string")return h(e,{dir:t,size:r});return b(e,{dir:t,size:r})}function h(e,{dir:t,size:r=32}={}){if(r===null)return e;const n=e.replace("0x","");if(n.length>r*2)throw new d({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[t==="right"?"padEnd":"padStart"](r*2,"0")}`}function b(e,{dir:t,size:r=32}={}){if(r===null)return e;if(e.length>r)throw new d({size:e.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let o=0;o<r;o++){const s=t==="right";n[s?o:r-o-1]=e[s?o:e.length-o-1]}return n}class p extends a{constructor({max:e,min:t,signed:r,size:n,value:o}){super(`Number "${o}" is not in safe ${n?`${n*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`);Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"IntegerOutOfRangeError"})}}class w extends a{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`);Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"SizeOverflowError"})}}function g(e,{dir:t="left"}={}){let r=typeof e==="string"?e.replace("0x",""):e;let n=0;for(let e=0;e<r.length-1;e++){if(r[t==="left"?e:r.length-e-1].toString()==="0")n++;else break}r=t==="left"?r.slice(n):r.slice(0,r.length-n);if(typeof e==="string"){if(r.length===1&&t==="right")r=`${r}0`;return`0x${r.length%2===1?`0${r}`:r}`}return r}function m(e,{size:t}){if(s(e)>t)throw new w({givenSize:s(e),maxSize:t})}const y=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function v(e,t={}){if(typeof e==="number"||typeof e==="bigint")return O(e,t);if(typeof e==="string"){return E(e,t)}if(typeof e==="boolean")return j(e,t);return x(e,t)}function j(e,t={}){const r=`0x${Number(e)}`;if(typeof t.size==="number"){m(r,{size:t.size});return f(r,{size:t.size})}return r}function x(e,t={}){let r="";for(let t=0;t<e.length;t++){r+=y[e[t]]}const n=`0x${r}`;if(typeof t.size==="number"){m(n,{size:t.size});return f(n,{dir:"right",size:t.size})}return n}function O(e,t={}){const{signed:r,size:n}=t;const o=BigInt(e);let s;if(n){if(r)s=(1n<<BigInt(n)*8n-1n)-1n;else s=2n**(BigInt(n)*8n)-1n}else if(typeof e==="number"){s=BigInt(Number.MAX_SAFE_INTEGER)}const i=typeof s==="bigint"&&r?-s-1n:0;if(s&&o>s||o<i){const t=typeof e==="bigint"?"n":"";throw new p({max:s?`${s}${t}`:undefined,min:`${i}${t}`,signed:r,size:n,value:`${e}${t}`})}const u=`0x${(r&&o<0?(1n<<BigInt(n*8))+BigInt(o):o).toString(16)}`;if(n)return f(u,{size:n});return u}const $=new TextEncoder;function E(e,t={}){const r=$.encode(e);return x(r,t)}const R=new TextEncoder;function U(e,t={}){if(typeof e==="number"||typeof e==="bigint")return I(e,t);if(typeof e==="boolean")return S(e,t);if(o(e))return k(e,t);return z(e,t)}function S(e,t={}){const r=new Uint8Array(1);r[0]=Number(e);if(typeof t.size==="number"){m(r,{size:t.size});return f(r,{size:t.size})}return r}const A={zero:48,nine:57,A:65,F:70,a:97,f:102};function M(e){if(e>=A.zero&&e<=A.nine)return e-A.zero;if(e>=A.A&&e<=A.F)return e-(A.A-10);if(e>=A.a&&e<=A.f)return e-(A.a-10);return undefined}function k(e,t={}){let r=e;if(t.size){m(r,{size:t.size});r=f(r,{dir:"right",size:t.size})}let n=r.slice(2);if(n.length%2)n=`0${n}`;const o=n.length/2;const s=new Uint8Array(o);for(let e=0,t=0;e<o;e++){const r=M(n.charCodeAt(t++));const o=M(n.charCodeAt(t++));if(r===undefined||o===undefined){throw new a(`Invalid byte sequence ("${n[t-2]}${n[t-1]}" in "${n}").`)}s[e]=r*16+o}return s}function I(e,t){const r=O(e,t);return k(r)}function z(e,t={}){const r=R.encode(e);if(typeof t.size==="number"){m(r,{size:t.size});return f(r,{dir:"right",size:t.size})}return r}var T={};var q={};Object.defineProperty(q,"__esModule",{value:true});q.output=q.exists=q.hash=q.bytes=q.bool=q.number=q.isBytes=void 0;function P(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}q.number=P;function C(e){if(typeof e!=="boolean")throw new Error(`boolean expected, not ${e}`)}q.bool=C;function N(e){return e instanceof Uint8Array||e!=null&&typeof e==="object"&&e.constructor.name==="Uint8Array"}q.isBytes=N;function L(e,...t){if(!N(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}q.bytes=L;function _(e){if(typeof e!=="function"||typeof e.create!=="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");P(e.outputLen);P(e.blockLen)}q.hash=_;function B(e,t=true){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}q.exists=B;function D(e,t){L(e);const r=t.outputLen;if(e.length<r){throw new Error(`digestInto() expects output buffer of length at least ${r}`)}}q.output=D;const H={number:P,bool:C,bytes:L,hash:_,exists:B,output:D};q.default=H;var F={};Object.defineProperty(F,"__esModule",{value:true});F.add5L=F.add5H=F.add4H=F.add4L=F.add3H=F.add3L=F.add=F.rotlBL=F.rotlBH=F.rotlSL=F.rotlSH=F.rotr32L=F.rotr32H=F.rotrBL=F.rotrBH=F.rotrSL=F.rotrSH=F.shrSL=F.shrSH=F.toBig=F.split=F.fromBig=void 0;const J=BigInt(2**32-1);const V=BigInt(32);function W(e,t=false){if(t)return{h:Number(e&J),l:Number(e>>V&J)};return{h:Number(e>>V&J)|0,l:Number(e&J)|0}}F.fromBig=W;function X(e,t=false){let r=new Uint32Array(e.length);let n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:s,l:i}=W(e[o],t);[r[o],n[o]]=[s,i]}return[r,n]}F.split=X;const G=(e,t)=>BigInt(e>>>0)<<V|BigInt(t>>>0);F.toBig=G;const K=(e,t,r)=>e>>>r;F.shrSH=K;const Q=(e,t,r)=>e<<32-r|t>>>r;F.shrSL=Q;const Y=(e,t,r)=>e>>>r|t<<32-r;F.rotrSH=Y;const Z=(e,t,r)=>e<<32-r|t>>>r;F.rotrSL=Z;const ee=(e,t,r)=>e<<64-r|t>>>r-32;F.rotrBH=ee;const te=(e,t,r)=>e>>>r-32|t<<64-r;F.rotrBL=te;const re=(e,t)=>t;F.rotr32H=re;const ne=(e,t)=>e;F.rotr32L=ne;const oe=(e,t,r)=>e<<r|t>>>32-r;F.rotlSH=oe;const se=(e,t,r)=>t<<r|e>>>32-r;F.rotlSL=se;const ie=(e,t,r)=>t<<r-32|e>>>64-r;F.rotlBH=ie;const ue=(e,t,r)=>e<<r-32|t>>>64-r;F.rotlBL=ue;function ce(e,t,r,n){const o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}F.add=ce;const ae=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);F.add3L=ae;const le=(e,t,r,n)=>t+r+n+(e/2**32|0)|0;F.add3H=le;const de=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0);F.add4L=de;const fe=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0;F.add4H=fe;const he=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0);F.add5L=he;const be=(e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0;F.add5H=be;const pe={fromBig:W,split:X,toBig:G,shrSH:K,shrSL:Q,rotrSH:Y,rotrSL:Z,rotrBH:ee,rotrBL:te,rotr32H:re,rotr32L:ne,rotlSH:oe,rotlSL:se,rotlBH:ie,rotlBL:ue,add:ce,add3L:ae,add3H:le,add4L:de,add4H:fe,add5H:be,add5L:he};F.default=pe;var we={};var ge={};Object.defineProperty(ge,"__esModule",{value:true});ge.crypto=void 0;ge.crypto=typeof globalThis==="object"&&"crypto"in globalThis?globalThis.crypto:undefined;(function(e){
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(e,"__esModule",{value:true});e.randomBytes=e.wrapXOFConstructorWithOpts=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.byteSwap32=e.byteSwapIfBE=e.byteSwap=e.isLE=e.rotl=e.rotr=e.createView=e.u32=e.u8=e.isBytes=void 0;const t=ge;const r=q;function n(e){return e instanceof Uint8Array||e!=null&&typeof e==="object"&&e.constructor.name==="Uint8Array"}e.isBytes=n;const o=e=>new Uint8Array(e.buffer,e.byteOffset,e.byteLength);e.u8=o;const s=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4));e.u32=s;const i=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);e.createView=i;const u=(e,t)=>e<<32-t|e>>>t;e.rotr=u;const c=(e,t)=>e<<t|e>>>32-t>>>0;e.rotl=c;e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;const a=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;e.byteSwap=a;e.byteSwapIfBE=e.isLE?e=>e:t=>(0,e.byteSwap)(t);function l(t){for(let r=0;r<t.length;r++){t[r]=(0,e.byteSwap)(t[r])}}e.byteSwap32=l;const d=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function f(e){(0,r.bytes)(e);let t="";for(let r=0;r<e.length;r++){t+=d[e[r]]}return t}e.bytesToHex=f;const h={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function b(e){if(e>=h._0&&e<=h._9)return e-h._0;if(e>=h._A&&e<=h._F)return e-(h._A-10);if(e>=h._a&&e<=h._f)return e-(h._a-10);return}function p(e){if(typeof e!=="string")throw new Error("hex string expected, got "+typeof e);const t=e.length;const r=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,o=0;t<r;t++,o+=2){const r=b(e.charCodeAt(o));const s=b(e.charCodeAt(o+1));if(r===undefined||s===undefined){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}n[t]=r*16+s}return n}e.hexToBytes=p;const w=async()=>{};e.nextTick=w;async function g(t,r,n){let o=Date.now();for(let s=0;s<t;s++){n(s);const t=Date.now()-o;if(t>=0&&t<r)continue;await(0,e.nextTick)();o+=t}}e.asyncLoop=g;function m(e){if(typeof e!=="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array((new TextEncoder).encode(e))}e.utf8ToBytes=m;function y(e){if(typeof e==="string")e=m(e);(0,r.bytes)(e);return e}e.toBytes=y;function v(...e){let t=0;for(let n=0;n<e.length;n++){const o=e[n];(0,r.bytes)(o);t+=o.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r);r+=o.length}return n}e.concatBytes=v;class j{clone(){return this._cloneInto()}}e.Hash=j;const x={}.toString;function O(e,t){if(t!==undefined&&x.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");const r=Object.assign(e,t);return r}e.checkOpts=O;function $(e){const t=t=>e().update(y(t)).digest();const r=e();t.outputLen=r.outputLen;t.blockLen=r.blockLen;t.create=()=>e();return t}e.wrapConstructor=$;function E(e){const t=(t,r)=>e(r).update(y(t)).digest();const r=e({});t.outputLen=r.outputLen;t.blockLen=r.blockLen;t.create=t=>e(t);return t}e.wrapConstructorWithOpts=E;function R(e){const t=(t,r)=>e(r).update(y(t)).digest();const r=e({});t.outputLen=r.outputLen;t.blockLen=r.blockLen;t.create=t=>e(t);return t}e.wrapXOFConstructorWithOpts=R;function U(e=32){if(t.crypto&&typeof t.crypto.getRandomValues==="function"){return t.crypto.getRandomValues(new Uint8Array(e))}throw new Error("crypto.getRandomValues must be defined")}e.randomBytes=U})(we);Object.defineProperty(T,"__esModule",{value:true});T.shake256=T.shake128=T.keccak_512=T.keccak_384=Ce=T.keccak_256=T.keccak_224=T.sha3_512=T.sha3_384=T.sha3_256=T.sha3_224=T.Keccak=T.keccakP=void 0;const me=q;const ye=F;const ve=we;const je=[];const xe=[];const Oe=[];const $e=BigInt(0);const Ee=BigInt(1);const Re=BigInt(2);const Ue=BigInt(7);const Se=BigInt(256);const Ae=BigInt(113);for(let e=0,t=Ee,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5];je.push(2*(5*n+r));xe.push((e+1)*(e+2)/2%64);let o=$e;for(let e=0;e<7;e++){t=(t<<Ee^(t>>Ue)*Ae)%Se;if(t&Re)o^=Ee<<(Ee<<BigInt(e))-Ee}Oe.push(o)}const[Me,ke]=(0,ye.split)(Oe,true);const Ie=(e,t,r)=>r>32?(0,ye.rotlBH)(e,t,r):(0,ye.rotlSH)(e,t,r);const ze=(e,t,r)=>r>32?(0,ye.rotlBL)(e,t,r):(0,ye.rotlSL)(e,t,r);function Te(e,t=24){const r=new Uint32Array(5*2);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10;const o=(t+2)%10;const s=r[o];const i=r[o+1];const u=Ie(s,i,1)^r[n];const c=ze(s,i,1)^r[n+1];for(let r=0;r<50;r+=10){e[t+r]^=u;e[t+r+1]^=c}}let t=e[2];let o=e[3];for(let r=0;r<24;r++){const n=xe[r];const s=Ie(t,o,n);const i=ze(t,o,n);const u=je[r];t=e[u];o=e[u+1];e[u]=s;e[u+1]=i}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=Me[n];e[1]^=ke[n]}r.fill(0)}T.keccakP=Te;class qe extends ve.Hash{constructor(e,t,r,n=false,o=24){super();this.blockLen=e;this.suffix=t;this.outputLen=r;this.enableXOF=n;this.rounds=o;this.pos=0;this.posOut=0;this.finished=false;this.destroyed=false;(0,me.number)(r);if(0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200);this.state32=(0,ve.u32)(this.state)}keccak(){if(!ve.isLE)(0,ve.byteSwap32)(this.state32);Te(this.state32,this.rounds);if(!ve.isLE)(0,ve.byteSwap32)(this.state32);this.posOut=0;this.pos=0}update(e){(0,me.exists)(this);const{blockLen:t,state:r}=this;e=(0,ve.toBytes)(e);const n=e.length;for(let o=0;o<n;){const s=Math.min(t-this.pos,n-o);for(let t=0;t<s;t++)r[this.pos++]^=e[o++];if(this.pos===t)this.keccak()}return this}finish(){if(this.finished)return;this.finished=true;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t;if((t&128)!==0&&r===n-1)this.keccak();e[n-1]^=128;this.keccak()}writeInto(e){(0,me.exists)(this,false);(0,me.bytes)(e);this.finish();const t=this.state;const{blockLen:r}=this;for(let n=0,o=e.length;n<o;){if(this.posOut>=r)this.keccak();const s=Math.min(r-this.posOut,o-n);e.set(t.subarray(this.posOut,this.posOut+s),n);this.posOut+=s;n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){(0,me.number)(e);return this.xofInto(new Uint8Array(e))}digestInto(e){(0,me.output)(e,this);if(this.finished)throw new Error("digest() was already called");this.writeInto(e);this.destroy();return e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=true;this.state.fill(0)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:o,enableXOF:s}=this;e||(e=new qe(t,r,n,s,o));e.state32.set(this.state32);e.pos=this.pos;e.posOut=this.posOut;e.finished=this.finished;e.rounds=o;e.suffix=r;e.outputLen=n;e.enableXOF=s;e.destroyed=this.destroyed;return e}}T.Keccak=qe;const Pe=(e,t,r)=>(0,ve.wrapConstructor)((()=>new qe(t,e,r)));T.sha3_224=Pe(6,144,224/8);T.sha3_256=Pe(6,136,256/8);T.sha3_384=Pe(6,104,384/8);T.sha3_512=Pe(6,72,512/8);T.keccak_224=Pe(1,144,224/8);var Ce=T.keccak_256=Pe(1,136,256/8);T.keccak_384=Pe(1,104,384/8);T.keccak_512=Pe(1,72,512/8);const Ne=(e,t,r)=>(0,ve.wrapXOFConstructorWithOpts)(((n={})=>new qe(t,e,n.dkLen===undefined?r:n.dkLen,true)));T.shake128=Ne(31,168,128/8);T.shake256=Ne(31,136,256/8);function Le(e,t){const r=t||"hex";const n=Ce(o(e,{strict:false})?U(e):e);if(r==="bytes")return n;return v(n)}class _e extends Map{constructor(e){super();Object.defineProperty(this,"maxSize",{enumerable:true,configurable:true,writable:true,value:void 0});this.maxSize=e}set(e,t){super.set(e,t);if(this.maxSize&&this.size>this.maxSize)this.delete(this.keys().next().value);return this}}function Be(e,t={}){let r=e;if(typeof t.size!=="undefined"){m(r,{size:t.size});r=g(r,{dir:"right"})}return(new TextDecoder).decode(r)}const De=(e,t,r)=>JSON.stringify(e,((e,r)=>{const n=typeof r==="bigint"?r.toString():r;return typeof t==="function"?t(e,n):n}),r);class He extends a{constructor({body:e,cause:t,details:r,headers:n,status:o,url:s}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[o&&`Status: ${o}`,`URL: ${u(s)}`,e&&`Request body: ${De(e)}`].filter(Boolean)});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"HttpRequestError"});Object.defineProperty(this,"body",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"headers",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"status",{enumerable:true,configurable:true,writable:true,value:void 0});Object.defineProperty(this,"url",{enumerable:true,configurable:true,writable:true,value:void 0});this.body=e;this.headers=n;this.status=o;this.url=s}}class Fe extends a{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${u(r)}`,`Request body: ${De(e)}`]});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"RpcRequestError"});Object.defineProperty(this,"code",{enumerable:true,configurable:true,writable:true,value:void 0});this.code=t.code}}class Je extends a{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${u(t)}`,`Request body: ${De(e)}`]});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"TimeoutError"})}}const Ve=-1;class We extends a{constructor(e,{code:t,docsPath:r,metaMessages:n,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:n||e?.metaMessages});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"RpcError"});Object.defineProperty(this,"code",{enumerable:true,configurable:true,writable:true,value:void 0});this.name=e.name;this.code=e instanceof Fe?e.code:t??Ve}}class Xe extends We{constructor(e,t){super(e,t);Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ProviderRpcError"});Object.defineProperty(this,"data",{enumerable:true,configurable:true,writable:true,value:void 0});this.data=t.data}}class Ge extends We{constructor(e){super(e,{code:Ge.code,shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ParseRpcError"})}}Object.defineProperty(Ge,"code",{enumerable:true,configurable:true,writable:true,value:-32700});class Ke extends We{constructor(e){super(e,{code:Ke.code,shortMessage:"JSON is not a valid request object."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"InvalidRequestRpcError"})}}Object.defineProperty(Ke,"code",{enumerable:true,configurable:true,writable:true,value:-32600});class Qe extends We{constructor(e,{method:t}={}){super(e,{code:Qe.code,shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"MethodNotFoundRpcError"})}}Object.defineProperty(Qe,"code",{enumerable:true,configurable:true,writable:true,value:-32601});class Ye extends We{constructor(e){super(e,{code:Ye.code,shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join("\n")});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"InvalidParamsRpcError"})}}Object.defineProperty(Ye,"code",{enumerable:true,configurable:true,writable:true,value:-32602});class Ze extends We{constructor(e){super(e,{code:Ze.code,shortMessage:"An internal error was received."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"InternalRpcError"})}}Object.defineProperty(Ze,"code",{enumerable:true,configurable:true,writable:true,value:-32603});class et extends We{constructor(e){super(e,{code:et.code,shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join("\n")});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"InvalidInputRpcError"})}}Object.defineProperty(et,"code",{enumerable:true,configurable:true,writable:true,value:-32e3});class tt extends We{constructor(e){super(e,{code:tt.code,shortMessage:"Requested resource not found."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(tt,"code",{enumerable:true,configurable:true,writable:true,value:-32001});class rt extends We{constructor(e){super(e,{code:rt.code,shortMessage:"Requested resource not available."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ResourceUnavailableRpcError"})}}Object.defineProperty(rt,"code",{enumerable:true,configurable:true,writable:true,value:-32002});class nt extends We{constructor(e){super(e,{code:nt.code,shortMessage:"Transaction creation failed."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"TransactionRejectedRpcError"})}}Object.defineProperty(nt,"code",{enumerable:true,configurable:true,writable:true,value:-32003});class ot extends We{constructor(e,{method:t}={}){super(e,{code:ot.code,shortMessage:`Method${t?` "${t}"`:""} is not implemented.`});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"MethodNotSupportedRpcError"})}}Object.defineProperty(ot,"code",{enumerable:true,configurable:true,writable:true,value:-32004});class st extends We{constructor(e){super(e,{code:st.code,shortMessage:"Request exceeds defined limit."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"LimitExceededRpcError"})}}Object.defineProperty(st,"code",{enumerable:true,configurable:true,writable:true,value:-32005});class it extends We{constructor(e){super(e,{code:it.code,shortMessage:"Version of JSON-RPC protocol is not supported."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"JsonRpcVersionUnsupportedError"})}}Object.defineProperty(it,"code",{enumerable:true,configurable:true,writable:true,value:-32006});class ut extends Xe{constructor(e){super(e,{code:ut.code,shortMessage:"User rejected the request."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"UserRejectedRequestError"})}}Object.defineProperty(ut,"code",{enumerable:true,configurable:true,writable:true,value:4001});class ct extends Xe{constructor(e){super(e,{code:ct.code,shortMessage:"The requested method and/or account has not been authorized by the user."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"UnauthorizedProviderError"})}}Object.defineProperty(ct,"code",{enumerable:true,configurable:true,writable:true,value:4100});class at extends Xe{constructor(e,{method:t}={}){super(e,{code:at.code,shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"UnsupportedProviderMethodError"})}}Object.defineProperty(at,"code",{enumerable:true,configurable:true,writable:true,value:4200});class lt extends Xe{constructor(e){super(e,{code:lt.code,shortMessage:"The Provider is disconnected from all chains."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ProviderDisconnectedError"})}}Object.defineProperty(lt,"code",{enumerable:true,configurable:true,writable:true,value:4900});class dt extends Xe{constructor(e){super(e,{code:dt.code,shortMessage:"The Provider is not connected to the requested chain."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"ChainDisconnectedError"})}}Object.defineProperty(dt,"code",{enumerable:true,configurable:true,writable:true,value:4901});class ft extends Xe{constructor(e){super(e,{code:ft.code,shortMessage:"An error occurred when attempting to switch chain."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"SwitchChainError"})}}Object.defineProperty(ft,"code",{enumerable:true,configurable:true,writable:true,value:4902});class ht extends We{constructor(e){super(e,{shortMessage:"An unknown RPC error occurred."});Object.defineProperty(this,"name",{enumerable:true,configurable:true,writable:true,value:"UnknownRpcError"})}}const bt=new Map;function pt({fn:e,id:t,shouldSplitBatch:r,wait:n=0,sort:o}){const s=async()=>{const t=c();i();const r=t.map((({args:e})=>e));if(r.length===0)return;e(r).then((e=>{if(o&&Array.isArray(e))e.sort(o);for(let r=0;r<t.length;r++){const{pendingPromise:n}=t[r];n.resolve?.([e[r],e])}})).catch((e=>{for(let r=0;r<t.length;r++){const{pendingPromise:n}=t[r];n.reject?.(e)}}))};const i=()=>bt.delete(t);const u=()=>c().map((({args:e})=>e));const c=()=>bt.get(t)||[];const a=e=>bt.set(t,[...c(),e]);return{flush:i,async schedule(e){const t={};const o=new Promise(((e,r)=>{t.resolve=e;t.reject=r}));const i=r?.([...u(),e]);if(i)s();const l=c().length>0;if(l){a({args:e,pendingPromise:t});return o}a({args:e,pendingPromise:t});setTimeout(s,n);return o}}}async function wt(e){return new Promise((t=>setTimeout(t,e)))}const gt=256;let mt=gt;let yt;function vt(e=11){if(!yt||mt+e>gt*2){yt="";mt=0;for(let e=0;e<gt;e++){yt+=(256+Math.random()*256|0).toString(16).substring(1)}}return yt.substring(mt,mt+++e)}const jt=new _e(8192);function xt(e,{enabled:t=true,id:r}){if(!t||!r)return e();if(jt.get(r))return jt.get(r);const n=e().finally((()=>jt.delete(r)));jt.set(r,n);return n}function Ot(e,{delay:t=100,retryCount:r=2,shouldRetry:n=(()=>true)}={}){return new Promise(((o,s)=>{const i=async({count:u=0}={})=>{const c=async({error:e})=>{const r=typeof t==="function"?t({count:u,error:e}):t;if(r)await wt(r);i({count:u+1})};try{const t=await e();o(t)}catch(e){if(u<r&&await n({count:u,error:e}))return c({error:e});s(e)}};i()}))}function $t(e,t={}){return async(r,n={})=>{const{dedupe:o=false,retryDelay:s=150,retryCount:i=3,uid:u}={...t,...n};const c=o?Le(E(`${u}.${De(r)}`)):undefined;return xt((()=>Ot((async()=>{try{return await e(r)}catch(e){const t=e;switch(t.code){case Ge.code:throw new Ge(t);case Ke.code:throw new Ke(t);case Qe.code:throw new Qe(t,{method:r.method});case Ye.code:throw new Ye(t);case Ze.code:throw new Ze(t);case et.code:throw new et(t);case tt.code:throw new tt(t);case rt.code:throw new rt(t);case nt.code:throw new nt(t);case ot.code:throw new ot(t,{method:r.method});case st.code:throw new st(t);case it.code:throw new it(t);case ut.code:throw new ut(t);case ct.code:throw new ct(t);case at.code:throw new at(t);case lt.code:throw new lt(t);case dt.code:throw new dt(t);case ft.code:throw new ft(t);case 5e3:throw new ut(t);default:if(e instanceof a)throw e;throw new ht(t)}}}),{delay:({count:e,error:t})=>{if(t&&t instanceof He){const e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return Number.parseInt(e)*1e3}return~~(1<<e)*s},retryCount:i,shouldRetry:({error:e})=>Et(e)})),{enabled:o,id:c})}}function Et(e){if("code"in e&&typeof e.code==="number"){if(e.code===-1)return true;if(e.code===st.code)return true;if(e.code===Ze.code)return true;return false}if(e instanceof He&&e.status){if(e.status===403)return true;if(e.status===408)return true;if(e.status===413)return true;if(e.status===429)return true;if(e.status===500)return true;if(e.status===502)return true;if(e.status===503)return true;if(e.status===504)return true;return false}return true}function Rt({key:e,name:t,request:r,retryCount:n=3,retryDelay:o=150,timeout:s,type:i},u){const c=vt();return{config:{key:e,name:t,request:r,retryCount:n,retryDelay:o,timeout:s,type:i},request:$t(r,{retryCount:n,retryDelay:o,uid:c}),value:u}}class Ut extends a{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro"})}}function St(e,{errorInstance:t=new Error("timed out"),timeout:r,signal:n}){return new Promise(((o,s)=>{(async()=>{let i;try{const u=new AbortController;if(r>0){i=setTimeout((()=>{if(n){u.abort()}else{s(t)}}),r)}o(await e({signal:u?.signal||null}))}catch(e){if(e?.name==="AbortError")s(t);s(e)}finally{clearTimeout(i)}})()}))}function At(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const Mt=At();function kt(e,t={}){return{async request(r){const{body:n,onRequest:o=t.onRequest,onResponse:s=t.onResponse,timeout:i=t.timeout??1e4}=r;const u={...t.fetchOptions??{},...r.fetchOptions??{}};const{headers:c,method:a,signal:l}=u;try{const t=await St((async({signal:t})=>{const r={...u,body:Array.isArray(n)?De(n.map((e=>({jsonrpc:"2.0",id:e.id??Mt.take(),...e})))):De({jsonrpc:"2.0",id:n.id??Mt.take(),...n}),headers:{"Content-Type":"application/json",...c},method:a||"POST",signal:l||(i>0?t:null)};const s=new Request(e,r);if(o)await o(s);const d=await fetch(e,r);return d}),{errorInstance:new Je({body:n,url:e}),timeout:i,signal:true});if(s)await s(t);let r;if(t.headers.get("Content-Type")?.startsWith("application/json"))r=await t.json();else{r=await t.text();r=JSON.parse(r||"{}")}if(!t.ok){throw new He({body:n,details:De(r.error)||t.statusText,headers:t.headers,status:t.status,url:e})}return r}catch(t){if(t instanceof He)throw t;if(t instanceof Je)throw t;throw new He({body:n,cause:t,url:e})}}}}function It(e,t={}){const{batch:r,fetchOptions:n,key:o="http",name:s="HTTP JSON-RPC",onFetchRequest:i,onFetchResponse:u,retryDelay:c}=t;return({chain:a,retryCount:l,timeout:d})=>{const{batchSize:f=1e3,wait:h=0}=typeof r==="object"?r:{};const b=t.retryCount??l;const p=d??t.timeout??1e4;const w=e||a?.rpcUrls.default.http[0];if(!w)throw new Ut;const g=kt(w,{fetchOptions:n,onRequest:i,onResponse:u,timeout:p});return Rt({key:o,name:s,async request({method:e,params:t}){const n={method:e,params:t};const{schedule:o}=pt({id:w,wait:h,shouldSplitBatch(e){return e.length>f},fn:e=>g.request({body:e}),sort:(e,t)=>e.id-t.id});const s=async e=>r?o(e):[await g.request({body:e})];const[{error:i,result:u}]=await s(n);if(i)throw new Fe({body:n,error:i,url:w});return u},retryCount:b,retryDelay:c,timeout:p,type:"http"},{fetchOptions:n,url:w})}}function zt(e,t){let r;let n;let o;let s="";for(r in e){if((o=e[r])!==void 0){if(Array.isArray(o)){for(n=0;n<o.length;n++){s&&(s+="&");s+=`${encodeURIComponent(r)}=${encodeURIComponent(o[n])}`}}else{s&&(s+="&");s+=`${encodeURIComponent(r)}=${encodeURIComponent(o)}`}}}return(t||"")+s}function Tt(e,t){function r(r){if(typeof r==="object"&&r!==null){try{return e(r)}catch(e){}}else if(typeof r==="string"&&typeof t==="function"){try{t(r);return e(r)}catch(e){}}return r}return e=>{e={...e};if(e){Object.keys(e).forEach((t=>{const n=e[t];if(typeof n==="undefined"||n===void 0){delete e[t]}else{e[t]=r(n)}}))}const t=zt(e).toString();return t?`?${t}`:""}}var qt=Tt(JSON.stringify,JSON.parse);var Pt=e=>{try{return e()}catch(e){return null}};function Ct(e){return[...new Uint8Array(e)].map((e=>e.toString(16).padStart(2,"0"))).join("")}function Nt(){return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone}var Lt=(e=>{e["Auth"]="Auth";e["SignMessage"]="SignMessage";e["SignEvm"]="SignEvm";e["SignPsbt"]="SignPsbt";e["BatchSignPsbt"]="BatchSignPsbt";e["SignCkbTx"]="SignCkbTx";e["SignCotaNFT"]="SignCotaNFT";e["SignCkbRawTx"]="SignCkbRawTx";e["SignNostrEvent"]="SignNostrEvent";e["EncryptNostrMessage"]="EncryptNostrMessage";e["EvmWeb2Login"]="EvmWeb2Login";e["DecryptNostrMessage"]="DecryptNostrMessage";e["AuthMiniApp"]="AuthMiniApp";e["SignMiniAppMessage"]="SignMiniAppMessage";e["SignMiniAppEvm"]="SignMiniAppEvm";return e})(Lt||{});var _t={joyidAppURL:"https://testnet.joyid.dev"};var Bt=()=>_t;var Dt=class e extends Error{constructor(t,r){super(r);this.error=t;this.error_description=r;Object.setPrototypeOf(this,e.prototype)}};var Ht=class e extends Dt{constructor(){super("timeout","Timeout");Object.setPrototypeOf(this,e.prototype)}};var Ft=class e extends Ht{constructor(t){super();this.popup=t;Object.setPrototypeOf(this,e.prototype)}};var Jt=class e extends Dt{constructor(t){super("cancelled","Popup closed");this.popup=t;Object.setPrototypeOf(this,e.prototype)}};var Vt=class extends Dt{constructor(e){super("NotSupported","Popup window is blocked by browser. see: https://docs.joy.id/guide/best-practice#popup-window-blocked");this.popup=e;Object.setPrototypeOf(this,Jt.prototype)}};var Wt="joyid-redirect";var Xt=(e,t,r)=>{const n=e.joyidAppURL??Bt().joyidAppURL;const o=new URL(`${n}`);o.pathname=r;let s=e.redirectURL;if(t==="redirect"){const e=new URL(s);e.searchParams.set(Wt,"true");s=e.href}o.searchParams.set("type",t);const i=qt({...e,redirectURL:s});o.searchParams.set("_data_",i);return o.href};var Gt=3e3;var Kt=(e="")=>{const t=400;const r=600;const n=window.screenX+(window.innerWidth-t)/2;const o=window.screenY+(window.innerHeight-r)/2;return window.open(e,"joyid:authorize:popup",`left=${n},top=${o},width=${t},height=${r},resizable,scrollbars=yes,status=1`)};var Qt=async e=>new Promise(((t,r)=>{if(Nt()){r(new Vt(e.popup))}let n;let o;const s=setInterval((()=>{if(e.popup?.closed){clearInterval(s);clearTimeout(o);window.removeEventListener("message",n,false);r(new Jt(e.popup))}}),1e3);o=setTimeout((()=>{clearInterval(s);r(new Ft(e.popup));window.removeEventListener("message",n,false)}),(e.timeoutInSeconds??Gt)*1e3);n=i=>{const u=e.joyidAppURL??Bt().joyidAppURL;if(u==null){throw new Error("joyidAppURL is not set in the config")}const c=new URL(u);if(i.origin!==c.origin){return}if(!i.data||i.data?.type!==e.type){return}clearTimeout(o);clearInterval(s);window.removeEventListener("message",n,false);e.popup.close();if(i.data.error){r(new Error(i.data.error))}t(i.data.data)};window.addEventListener("message",n)}));var Yt="joyid-block-dialog-style";var Zt="joyid-block-dialog-approve";var er="joyid-block-dialog-reject";var tr=`\n.joyid-block-dialog {\n  position: fixed;\n  top: 32px;\n  left: 50%;\n  width: 340px;\n  margin-left: -170px;\n  background: white;\n  color: #333;\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: space-between;\n  align-items: center;\n  height: 110px;\n  z-index: 100002;\n  box-sizing: border-box;\n  border: 1px solid #ffffff;\n  border-radius: 8px;\n  padding: 16px 20px;\n}\n.joyid-block-dialog-bg {\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0,0,0,0.5);\n  position: fixed;\n  top: 0;\n  left: 0;\n  display: none;\n  z-index: 100001;\n  display: block;\n}\n.joyid-block-dialog-title {\n  font-weight: bold;\n  font-size: 14px;\n  margin-bottom: 8px;\n}\n.joyid-block-dialog-tip {\n  font-size: 12px;\n  color: #777;\n}\n.joyid-block-dialog-btn {\n  width: 90px;\n  height: 35px;\n  font-size: 12px;\n  text-align: center;\n  border-radius: 6px;\n  cursor: pointer;\n}\n.joyid-block-dialog-action {\n  text-align: right;\n}\n#${Zt} {\n  border: 1px solid #333;\n  color: #333;\n  background: #D2FF00;\n  margin-bottom: 8px;\n}\n\n#${er} {\n  background: transparent;\n}\n`;var rr=`\n<div class="joyid-block-dialog">\n  <div class="joyid-block-dialog-content">\n    <div class="joyid-block-dialog-title">\n      Request Pop-up\n    </div>\n    <div class="joyid-block-dialog-tip">\n      Click Approve to complete creating or using wallet\n    </div>\n  </div>\n  <div class="joyid-block-dialog-action">\n    <button class="joyid-block-dialog-btn" id="${Zt}">Approve</button>\n    <button class="joyid-block-dialog-btn" id="${er}">Reject</button>\n  </div>\n</div>\n`;var nr=()=>{const e=document.getElementById(Yt);if(e!=null){return}const t=document.createElement("style");t.appendChild(document.createTextNode(tr));const r=document.head??document.getElementsByTagName("head")[0];r.appendChild(t)};var or=async e=>{nr();const t=document.createElement("div");t.innerHTML=rr;document.body.appendChild(t);const r=document.createElement("div");r.className="joyid-block-dialog-bg";document.body.appendChild(r);const n=document.getElementById(Zt);const o=document.getElementById(er);const s=()=>{document.body.removeChild(t);document.body.removeChild(r)};return new Promise(((t,r)=>{n?.addEventListener("click",(async()=>{try{const r=await e();s();t(r)}catch(e){s();r(e)}}));o?.addEventListener("click",(()=>{s();r(new Error("User Rejected"))}))}))};var sr=(e,t)=>Xt(e,t,"/auth");var ir=async(e,t)=>{t=t??{};if(t.popup==null){t.popup=Kt("");if(t.popup==null){return or((async()=>ir(e,t)))}}t.popup.location.href=sr(e,"popup");return Qt({...t,type:"Auth"})};var ur=(e,t)=>Xt(e,t,"/sign-message");var cr=async(e,t)=>{t=t??{};if(t.popup==null){t.popup=Kt("");if(t.popup==null){return or((async()=>cr(e,t)))}}t.popup.location.href=ur(e,"popup");return Qt({...t,type:"SignMessage"})};var ar="joyid:ethereum::address";var lr=(e,t="popup")=>Xt({..._t,...e},t,"/sign-evm");var dr=(e,t="popup")=>Xt({..._t,...e},t,"/sign-typed-data");var fr=e=>{Object.assign(_t,e);return _t};var hr=async e=>{e={..._t,...e};const t=await ir({redirectURL:location.href,requestNetwork:"ethereum",...e});Pt((()=>{localStorage.setItem(ar,t.ethAddress)}));return t.ethAddress};var br=()=>{Pt((()=>{localStorage.removeItem(ar)}))};var pr=()=>Pt((()=>localStorage.getItem(ar)))??null;var wr=e=>{let t=e;if(t==null){const e=pr();if(e!=null){t=e}}if(t==null){throw new Error("signerAddress is required")}return t};var gr=async(e,t,r)=>{const n=typeof e!=="string";r={..._t,...r};t=wr(t);const o=await cr({requestNetwork:"ethereum",challenge:typeof e==="string"?e:Ct(e),isData:n,address:t,redirectURL:location.href,...r});return o.signature};var mr=async(e,t,r)=>{r={..._t,...r};t=wr(t);if(r.popup==null){r.popup=Kt("");if(r.popup==null){return or((async()=>mr(e,t,r)))}}const{popup:n,timeoutInSeconds:o,...s}=r;r.popup.location.href=dr({...s,typedData:e,signerAddress:t,redirectURL:location.href});const i=await Qt({timeoutInSeconds:o??5e3,popup:n,type:Lt.SignMessage});return i.signature};var yr=async(e,t,r,n)=>{const o=t??e.from??pr();if(o==null){throw new Error("signerAddress or tx.from is required")}r={..._t,...r};if(r.popup==null){r.popup=Kt("");if(r.popup==null){return or((async()=>yr(e,o,r,n)))}}const{popup:s,timeoutInSeconds:i,...u}=r;r.popup.location.href=lr({...u,tx:e,signerAddress:o,redirectURL:location.href,isSend:n});const c=await Qt({timeoutInSeconds:i??5e3,popup:s,type:Lt.SignEvm});return c.tx};var vr=async(e,t,r)=>yr(e,t,r,true);function jr(e){if(o(e)){return Be(U(e))}return e}var xr="joyid:ethereum:chainId";var Or=class extends e{constructor(e,t){super();this.account=null;this.request=async e=>{switch(e.method){case"eth_requestAccounts":{const e=await this.connect();this.account=e;return[e]}case"eth_accounts":{return[this.account]}case"eth_chainId":{return this.chainId}case"eth_sign":{throw new Error("eth_sign is not supported, use personal_sign instead")}case"wallet_switchEthereumChain":{const t=e.params?.[0]?.chainId;this.switchChain(parseInt(t));this.emit("chainChanged",t);return void 0}case"personal_sign":{const[t,r]=e.params;const n=jr(t);try{const e=await gr(o(n)?U(n):n,r);return e}catch(e){throw new Xe(e,{code:4001,shortMessage:"User rejected the request"})}}case"eth_sendTransaction":{const[t]=e.params;try{const e=await vr(t);return e}catch(e){throw new Xe(e,{code:4001,shortMessage:"User rejected the request"})}}case"eth_signTypedData_v4":{const[t,r]=e.params;const n=jr(r);try{const e=await mr(JSON.parse(n),t);return e}catch(e){throw new Xe(e,{code:4001,shortMessage:"User rejected the request"})}}default:{const t=this.chains.find((e=>e.id===this.chainId));if(t==null){throw new Error(`Unsupported chain id: ${this.chainId}, chainId must be one of ${this.chains.map((e=>e.id)).join(",")}`)}const r=It(t.rpcUrls.default.http[0]);return r({chain:t}).request(e)}}};let r=t.network?.chainId??e?.[0]?.id;const n=Pt((()=>localStorage.getItem(xr)));if(n!=null){r=Number(n)}if(r==null){throw new Error("No chain provided")}this.chainId=r;this.account=pr();this.chains=e;this.initConfig(r,t)}getAccount(){return this.account??pr()}initConfig(e,t){const r=this.chains.find((t=>t.id===e));if(r==null){throw new Error(`Unsupported chain id: ${e}, chainId must be one of ${this.chains.map((e=>e.id)).join(",")}`)}const n=r.rpcUrls.default.http[0];if(!n){throw new Error("No rpc url provided in chains config")}fr({...t,network:{chainId:r.id,name:r.name,nativeCurrency:r.nativeCurrency,rpcUrls:r.rpcUrls.default.http,blockExplorerUrls:r.blockExplorers?.default.url?[r.blockExplorers.default.url]:void 0}});this.chainId=e;return r}switchChain(e){const t=this.initConfig(e);Pt((()=>{localStorage.setItem(xr,e.toString())}));return t}getChainId(){return this.chainId}async connect(){const e=await hr();this.emit("connect",{chainId:this.chainId.toString()});this.emit("accountsChanged",[e]);this.emit("chainChanged",this.chainId.toString());this.account=e;return e}disconnect(){Pt((()=>{this.emit("disconnect");this.account=null;br();localStorage.removeItem(xr)}))}};const $r=async()=>{const e=t.map((e=>{const t=n[e];return{id:e,name:r[e],nativeCurrency:{name:"Ethereum",symbol:"ETH",decimals:18},rpcUrls:{default:{http:typeof t.rpc==="string"?[t.rpc]:t.rpc}},blockExplorers:t.explorer?{default:{name:"Default explorer",url:t.explorer,apiUrl:""}}:null}}));return new Or(e,{name:"Smart Token Viewer",logo:`${location.origin}/assets/icon/icon.png`,joyidAppURL:"https://app.joy.id"})};export{$r as getJoyIDProviderInstance};
//# sourceMappingURL=p-de905f42.js.map