import{c as t,a as e,b as r}from"./p-0a353f40.js";var i=function(){throw new Error("ws does not work in the browser. Browser clients must use the native "+"WebSocket object")};var n=t((function(t,r){(function(t,e){e(r)})(e,(function(t){var r=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof e<"u"?e:typeof self<"u"?self:{};function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function s(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),r}function o(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var a=c;function c(t,e,r){var i=r&&r.stringify||o,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var a=new Array(s);a[0]=i(t);for(var c=1;c<s;c++)a[c]=i(e[c]);return a.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var u="",f=1-n,l=-1,d=t&&t.length||0,p=0;p<d;){if(t.charCodeAt(p)===37&&p+1<d){switch(l=l>-1?l:0,t.charCodeAt(p+1)){case 100:case 102:if(f>=h||e[f]==null)break;l<p&&(u+=t.slice(l,p)),u+=Number(e[f]),l=p+2,p++;break;case 105:if(f>=h||e[f]==null)break;l<p&&(u+=t.slice(l,p)),u+=Math.floor(Number(e[f])),l=p+2,p++;break;case 79:case 111:case 106:if(f>=h||e[f]===void 0)break;l<p&&(u+=t.slice(l,p));var w=typeof e[f];if(w==="string"){u+="'"+e[f]+"'",l=p+2,p++;break}if(w==="function"){u+=e[f].name||"<anonymous>",l=p+2,p++;break}u+=i(e[f]),l=p+2,p++;break;case 115:if(f>=h)break;l<p&&(u+=t.slice(l,p)),u+=String(e[f]),l=p+2,p++;break;case 37:l<p&&(u+=t.slice(l,p)),u+="%",l=p+2,p++,f--;break}++f}++p}return l===-1?t:(l<d&&(u+=t.slice(l)),u)}const h=a;var u=p;const f=T().console||{},l={mapHttpRequest:j,mapHttpResponse:j,wrapRequestSerializer:S,wrapResponseSerializer:S,wrapErrorSerializer:S,req:j,res:j,err:E};function d(t,e){return Array.isArray(t)?t.filter((function(t){return t!=="!stdSerializers.err"})):t===!0?Object.keys(e):!1}function p(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||f;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=d(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(r);c.log||(c.log=I),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:l,set:y});const h={transmit:e,serialize:n,asObject:t.browser.asObject,levels:o,timestamp:O(t)};c.levels=p.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=I,c.serializers=i,c._serialize=n,c._stdErrSerialize=s,c.child=v,e&&(c._logEvent=g());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function l(){return this._level}function y(t){if(t!=="silent"&&!this.levels.values[t])throw Error("unknown level "+t);this._level=t,w(h,c,"error","log"),w(h,c,"fatal","error"),w(h,c,"warn","error"),w(h,c,"info","log"),w(h,c,"debug","log"),w(h,c,"trace","log")}function v(r,s){if(!r)throw new Error("missing bindings for child Pino");s=s||{},n&&r.serializers&&(s.serializers=r.serializers);const o=s.serializers;if(n&&o){var a=Object.assign({},i,o),c=t.browser.serialize===!0?Object.keys(a):n;delete r.serializers,b([r],c,a,this._stdErrSerialize)}function h(t){this._childLevel=(t._childLevel|0)+1,this.error=m(t,r,"error"),this.fatal=m(t,r,"fatal"),this.warn=m(t,r,"warn"),this.info=m(t,r,"info"),this.debug=m(t,r,"debug"),this.trace=m(t,r,"trace"),a&&(this.serializers=a,this._serialize=c),e&&(this._logEvent=g([].concat(t._logEvent.bindings,r)))}return h.prototype=this,new h(this)}return c}p.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},p.stdSerializers=l,p.stdTimeFunctions=Object.assign({},{nullTime:A,epochTime:x,unixTime:N,isoTime:M});function w(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?I:n[r]?n[r]:f[r]||f[i]||I,y(t,e,r)}function y(t,e,r){!t.transmit&&e[r]===I||(e[r]=function(i){return function(){const n=t.timestamp(),s=new Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===f?f:this;for(var a=0;a<s.length;a++)s[a]=arguments[a];if(t.serialize&&!t.asObject&&b(s,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(o,v(this,r,s,n)):i.apply(o,s),t.transmit){const i=t.transmit.level||e.level,o=p.levels.values[i],a=p.levels.values[r];if(a<o)return;_(this,{ts:n,methodLevel:r,methodValue:a,transmitLevel:i,transmitValue:p.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},s)}}}(e[r]))}function v(t,e,r,i){t._serialize&&b(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const o={};i&&(o.time=i),o.level=p.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof n[0]=="object";)Object.assign(o,n.shift());s=n.length?h(n.shift(),n):void 0}else typeof s=="string"&&(s=h(n.shift(),n));return s!==void 0&&(o.msg=s),o}function b(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=p.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const i in t[n])e&&e.indexOf(i)>-1&&i in r&&(t[n][i]=r[i](t[n][i]))}function m(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function _(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;b(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter((function(t){return c.indexOf(t)===-1})),t._logEvent.level.label=s,t._logEvent.level.value=o,i(s,t._logEvent,a),t._logEvent=g(c)}function g(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function E(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function O(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?A:x}function j(){return{}}function S(t){return t}function I(){}function A(){return!1}function x(){return Date.now()}function N(){return Math.round(Date.now()/1e3)}function M(){return new Date(Date.now()).toISOString()}function T(){function t(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var R={exports:{}},P=typeof Reflect=="object"?Reflect:null,U=P&&typeof P.apply=="function"?P.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},$;P&&typeof P.ownKeys=="function"?$=P.ownKeys:Object.getOwnPropertySymbols?$=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:$=function(t){return Object.getOwnPropertyNames(t)};function D(t){console&&console.warn&&console.warn(t)}var C=Number.isNaN||function(t){return t!==t};function k(){k.init.call(this)}R.exports=k,R.exports.once=X,k.EventEmitter=k,k.prototype._events=void 0,k.prototype._eventsCount=0,k.prototype._maxListeners=void 0;var L=10;function F(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(k,"defaultMaxListeners",{enumerable:!0,get:function(){return L},set:function(t){if(typeof t!="number"||t<0||C(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");L=t}}),k.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},k.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||C(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function V(t){return t._maxListeners===void 0?k.defaultMaxListeners:t._maxListeners}k.prototype.getMaxListeners=function(){return V(this)},k.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[t];if(a===void 0)return!1;if(typeof a=="function")U(a,this,e);else for(var c=a.length,h=W(a,c),r=0;r<c;++r)U(h[r],this,e);return!0};function q(t,e,r,i){var n,s,o;if(F(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=V(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,D(a)}return t}k.prototype.addListener=function(t,e){return q(this,t,e,!1)},k.prototype.on=k.prototype.addListener,k.prototype.prependListener=function(t,e){return q(this,t,e,!0)};function G(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function K(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=G.bind(i);return n.listener=r,i.wrapFn=n,n}k.prototype.once=function(t,e){return F(e),this.on(t,K(this,t,e)),this},k.prototype.prependOnceListener=function(t,e){return F(e),this.prependListener(t,K(this,t,e)),this},k.prototype.removeListener=function(t,e){var r,i,n,s,o;if(F(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():H(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},k.prototype.off=k.prototype.removeListener,k.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function B(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?J(n):W(n,n.length)}k.prototype.listeners=function(t){return B(this,t,!0)},k.prototype.rawListeners=function(t){return B(this,t,!1)},k.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):z.call(t,e)},k.prototype.listenerCount=z;function z(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}k.prototype.eventNames=function(){return this._eventsCount>0?$(this._events):[]};function W(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function H(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function J(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function X(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Z(t,e,s,{once:!0}),e!=="error"&&Y(t,n,{once:!0})}))}function Y(t,e,r){typeof t.on=="function"&&Z(t,"error",e,r)}function Z(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Q={};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var tt=function(t,e){return tt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},tt(t,e)};function et(t,e){tt(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var rt=function(){return rt=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},rt.apply(this,arguments)};function it(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function nt(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function st(t,e){return function(r,i){e(r,i,t)}}function ot(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function at(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function ct(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=o[0]&2?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function ht(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ut(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ft(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lt(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function dt(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(lt(arguments[e]));return t}function pt(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function wt(t){return this instanceof wt?(this.v=t,this):new wt(t)}function yt(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,i){s.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{c(i[t](e))}catch(t){f(s[0][3],t)}}function c(t){t.value instanceof wt?Promise.resolve(t.value.v).then(h,u):f(s[0][2],t)}function h(t){a("next",t)}function u(t){a("throw",t)}function f(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function vt(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:wt(t[i](e)),done:i==="return"}:n?n(e):e}:n}}function bt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ft=="function"?ft(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(e){r[e]=t[e]&&function(r){return new Promise((function(i,s){r=t[e](r),n(i,s,r.done,r.value)}))}}function n(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}}function mt(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _t(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function gt(t){return t&&t.__esModule?t:{default:t}}function Et(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ot(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var jt=Object.freeze({__proto__:null,__extends:et,get __assign(){return rt},__rest:it,__decorate:nt,__param:st,__metadata:ot,__awaiter:at,__generator:ct,__createBinding:ht,__exportStar:ut,__values:ft,__read:lt,__spread:dt,__spreadArrays:pt,__await:wt,__asyncGenerator:yt,__asyncDelegator:vt,__asyncValues:bt,__makeTemplateObject:mt,__importStar:_t,__importDefault:gt,__classPrivateFieldGet:Et,__classPrivateFieldSet:Ot}),St=s(jt),It={};Object.defineProperty(It,"__esModule",{value:!0});function At(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}It.safeJsonParse=At;function xt(t){return typeof t=="string"?t:JSON.stringify(t,((t,e)=>typeof e>"u"?null:e))}It.safeJsonStringify=xt;var Nt={exports:{}},Mt;function Tt(){return Mt||(Mt=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},t.prototype.setItem=function(t,e){this[t]=String(e)},t.prototype.removeItem=function(t){delete this[t]},t.prototype.clear=function(){const t=this;Object.keys(t).forEach((function(e){t[e]=void 0,delete t[e]}))},t.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},t.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),typeof r<"u"&&r.localStorage?Nt.exports=r.localStorage:typeof window<"u"&&window.localStorage?Nt.exports=window.localStorage:Nt.exports=new e}()),Nt.exports}var Rt={},Pt={},Ut;function $t(){if(Ut)return Pt;Ut=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.IKeyValueStorage=void 0;class t{}return Pt.IKeyValueStorage=t,Pt}var Dt={},Ct;function kt(){if(Ct)return Dt;Ct=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.parseEntry=void 0;const t=It;function e(e){var r;return[e[0],t.safeJsonParse((r=e[1])!==null&&r!==void 0?r:"")]}return Dt.parseEntry=e,Dt}var Lt;function Ft(){return Lt||(Lt=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=St;e.__exportStar($t(),t),e.__exportStar(kt(),t)}(Rt)),Rt}Object.defineProperty(Q,"__esModule",{value:!0}),Q.KeyValueStorage=void 0;const Vt=St,qt=It,Gt=Vt.__importDefault(Tt()),Kt=Ft();class Bt{constructor(){this.localStorage=Gt.default}getKeys(){return Vt.__awaiter(this,void 0,void 0,(function*(){return Object.keys(this.localStorage)}))}getEntries(){return Vt.__awaiter(this,void 0,void 0,(function*(){return Object.entries(this.localStorage).map(Kt.parseEntry)}))}getItem(t){return Vt.__awaiter(this,void 0,void 0,(function*(){const e=this.localStorage.getItem(t);if(e!==null)return qt.safeJsonParse(e)}))}setItem(t,e){return Vt.__awaiter(this,void 0,void 0,(function*(){this.localStorage.setItem(t,qt.safeJsonStringify(e))}))}removeItem(t){return Vt.__awaiter(this,void 0,void 0,(function*(){this.localStorage.removeItem(t)}))}}Q.KeyValueStorage=Bt;var zt=Q.default=Bt,Wt={};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Ht=function(t,e){return Ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Ht(t,e)};function Jt(t,e){Ht(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Xt=function(){return Xt=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Xt.apply(this,arguments)};function Yt(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Zt(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Qt(t,e){return function(r,i){e(r,i,t)}}function te(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ee(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function re(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=o[0]&2?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function ie(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ne(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function se(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function oe(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function ae(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(oe(arguments[e]));return t}function ce(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function he(t){return this instanceof he?(this.v=t,this):new he(t)}function ue(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,i){s.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{c(i[t](e))}catch(t){f(s[0][3],t)}}function c(t){t.value instanceof he?Promise.resolve(t.value.v).then(h,u):f(s[0][2],t)}function h(t){a("next",t)}function u(t){a("throw",t)}function f(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function fe(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:he(t[i](e)),done:i==="return"}:n?n(e):e}:n}}function le(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof se=="function"?se(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(e){r[e]=t[e]&&function(r){return new Promise((function(i,s){r=t[e](r),n(i,s,r.done,r.value)}))}}function n(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}}function de(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function pe(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function we(t){return t&&t.__esModule?t:{default:t}}function ye(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ve(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var be=Object.freeze({__proto__:null,__extends:Jt,get __assign(){return Xt},__rest:Yt,__decorate:Zt,__param:Qt,__metadata:te,__awaiter:ee,__generator:re,__createBinding:ie,__exportStar:ne,__values:se,__read:oe,__spread:ae,__spreadArrays:ce,__await:he,__asyncGenerator:ue,__asyncDelegator:fe,__asyncValues:le,__makeTemplateObject:de,__importStar:pe,__importDefault:we,__classPrivateFieldGet:ye,__classPrivateFieldSet:ve}),me=s(be),_e={};function ge(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Ee=ge;ge.EventEmitter=ge,ge.prototype._events=void 0,ge.prototype._maxListeners=void 0,ge.defaultMaxListeners=10,ge.prototype.setMaxListeners=function(t){if(!je(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},ge.prototype.emit=function(t){var e,r,i,n,s,o;if(this._events||(this._events={}),t==="error"&&(!this._events.error||Se(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var a=new Error('Uncaught, unspecified "error" event. ('+e+")");throw a.context=e,a}if(r=this._events[t],Ie(r))return!1;if(Oe(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(Se(r))for(n=Array.prototype.slice.call(arguments,1),o=r.slice(),i=o.length,s=0;s<i;s++)o[s].apply(this,n);return!0},ge.prototype.addListener=function(t,e){var r;if(!Oe(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Oe(e.listener)?e.listener:e),this._events[t]?Se(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Se(this._events[t])&&!this._events[t].warned&&(Ie(this._maxListeners)?r=ge.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},ge.prototype.on=ge.prototype.addListener,ge.prototype.once=function(t,e){if(!Oe(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},ge.prototype.removeListener=function(t,e){var r,i,n,s;if(!Oe(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||Oe(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Se(r)){for(s=n;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){i=s;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},ge.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],Oe(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},ge.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:Oe(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},ge.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Oe(e))return 1;if(e)return e.length}return 0},ge.listenerCount=function(t,e){return t.listenerCount(e)};function Oe(t){return typeof t=="function"}function je(t){return typeof t=="number"}function Se(t){return typeof t=="object"&&t!==null}function Ie(t){return t===void 0}var Ae={};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xe=function(t,e){return xe=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},xe(t,e)};function Ne(t,e){xe(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Me=function(){return Me=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Me.apply(this,arguments)};function Te(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Re(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Pe(t,e){return function(r,i){e(r,i,t)}}function Ue(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function $e(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function De(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=o[0]&2?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function Ce(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ke(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Le(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fe(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function Ve(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Fe(arguments[e]));return t}function qe(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function Ge(t){return this instanceof Ge?(this.v=t,this):new Ge(t)}function Ke(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,i){s.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{c(i[t](e))}catch(t){f(s[0][3],t)}}function c(t){t.value instanceof Ge?Promise.resolve(t.value.v).then(h,u):f(s[0][2],t)}function h(t){a("next",t)}function u(t){a("throw",t)}function f(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Be(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:Ge(t[i](e)),done:i==="return"}:n?n(e):e}:n}}function ze(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Le=="function"?Le(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(e){r[e]=t[e]&&function(r){return new Promise((function(i,s){r=t[e](r),n(i,s,r.done,r.value)}))}}function n(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}}function We(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function He(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Je(t){return t&&t.__esModule?t:{default:t}}function Xe(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ye(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ze=Object.freeze({__proto__:null,__extends:Ne,get __assign(){return Me},__rest:Te,__decorate:Re,__param:Pe,__metadata:Ue,__awaiter:$e,__generator:De,__createBinding:Ce,__exportStar:ke,__values:Le,__read:Fe,__spread:Ve,__spreadArrays:qe,__await:Ge,__asyncGenerator:Ke,__asyncDelegator:Be,__asyncValues:ze,__makeTemplateObject:We,__importStar:He,__importDefault:Je,__classPrivateFieldGet:Xe,__classPrivateFieldSet:Ye}),Qe=s(Ze),tr={},er={},rr;function ir(){if(rr)return er;rr=1,Object.defineProperty(er,"__esModule",{value:!0}),er.delay=void 0;function t(t){return new Promise((e=>{setTimeout((()=>{e(!0)}),t)}))}return er.delay=t,er}var nr={},sr={},or={},ar;function cr(){return ar||(ar=1,Object.defineProperty(or,"__esModule",{value:!0}),or.ONE_THOUSAND=or.ONE_HUNDRED=void 0,or.ONE_HUNDRED=100,or.ONE_THOUSAND=1e3),or}var hr={},ur;function fr(){return ur||(ur=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(hr)),hr}var lr;function dr(){return lr||(lr=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qe;e.__exportStar(cr(),t),e.__exportStar(fr(),t)}(sr)),sr}var pr;function wr(){if(pr)return nr;pr=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.fromMiliseconds=nr.toMiliseconds=void 0;const t=dr();function e(e){return e*t.ONE_THOUSAND}nr.toMiliseconds=e;function r(e){return Math.floor(e/t.ONE_THOUSAND)}return nr.fromMiliseconds=r,nr}var yr;function vr(){return yr||(yr=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qe;e.__exportStar(ir(),t),e.__exportStar(wr(),t)}(tr)),tr}var br={},mr;function _r(){if(mr)return br;mr=1,Object.defineProperty(br,"__esModule",{value:!0}),br.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const e=this.get(t);if(typeof e.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const r=Date.now()-e.started;this.timestamps.set(t,{started:e.started,elapsed:r})}get(t){const e=this.timestamps.get(t);if(typeof e>"u")throw new Error(`No timestamp found for label: ${t}`);return e}elapsed(t){const e=this.get(t);return e.elapsed||Date.now()-e.started}}return br.Watch=t,br.default=t,br}var gr={},Er={},Or;function jr(){if(Or)return Er;Or=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.IWatch=void 0;class t{}return Er.IWatch=t,Er}var Sr;function Ir(){return Sr||(Sr=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Qe.__exportStar(jr(),t)}(gr)),gr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qe;e.__exportStar(vr(),t),e.__exportStar(_r(),t),e.__exportStar(Ir(),t),e.__exportStar(dr(),t)})(Ae);var Ar={},xr={};class Nr{}var Mr=Object.freeze({__proto__:null,IEvents:Nr}),Tr=s(Mr),Rr;function Pr(){if(Rr)return xr;Rr=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.IHeartBeat=void 0;const t=Tr;class e extends t.IEvents{constructor(t){super()}}return xr.IHeartBeat=e,xr}var Ur;function $r(){return Ur||(Ur=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),me.__exportStar(Pr(),t)}(Ar)),Ar}var Dr={},Cr={},kr;function Lr(){if(kr)return Cr;kr=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.HEARTBEAT_EVENTS=Cr.HEARTBEAT_INTERVAL=void 0;const t=Ae;return Cr.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Cr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Cr}var Fr;function Vr(){return Fr||(Fr=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),me.__exportStar(Lr(),t)}(Dr)),Dr}var qr;function Gr(){if(qr)return _e;qr=1,Object.defineProperty(_e,"__esModule",{value:!0}),_e.HeartBeat=void 0;const t=me,e=Ee,r=Ae,i=$r(),n=Vr();class s extends i.IHeartBeat{constructor(t){super(t),this.events=new e.EventEmitter,this.interval=n.HEARTBEAT_INTERVAL,this.interval=t?.interval||n.HEARTBEAT_INTERVAL}static init(e){return t.__awaiter(this,void 0,void 0,(function*(){const t=new s(e);return yield t.init(),t}))}init(){return t.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}initialize(){return t.__awaiter(this,void 0,void 0,(function*(){setInterval((()=>this.pulse()),r.toMiliseconds(this.interval))}))}pulse(){this.events.emit(n.HEARTBEAT_EVENTS.pulse)}}return _e.HeartBeat=s,_e}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=me;e.__exportStar(Gr(),t),e.__exportStar($r(),t),e.__exportStar(Vr(),t)})(Wt);var Kr={};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Br=function(t,e){return Br=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Br(t,e)};function zr(t,e){Br(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wr=function(){return Wr=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},Wr.apply(this,arguments)};function Hr(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Jr(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Xr(t,e){return function(r,i){e(r,i,t)}}function Yr(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Zr(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function Qr(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=o[0]&2?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function ti(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function ei(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ri(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ii(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function ni(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ii(arguments[e]));return t}function si(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function oi(t){return this instanceof oi?(this.v=t,this):new oi(t)}function ai(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,i){s.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{c(i[t](e))}catch(t){f(s[0][3],t)}}function c(t){t.value instanceof oi?Promise.resolve(t.value.v).then(h,u):f(s[0][2],t)}function h(t){a("next",t)}function u(t){a("throw",t)}function f(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ci(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:oi(t[i](e)),done:i==="return"}:n?n(e):e}:n}}function hi(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ri=="function"?ri(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(e){r[e]=t[e]&&function(r){return new Promise((function(i,s){r=t[e](r),n(i,s,r.done,r.value)}))}}function n(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}}function ui(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function fi(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function li(t){return t&&t.__esModule?t:{default:t}}function di(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function pi(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var wi=Object.freeze({__proto__:null,__extends:zr,get __assign(){return Wr},__rest:Hr,__decorate:Jr,__param:Xr,__metadata:Yr,__awaiter:Zr,__generator:Qr,__createBinding:ti,__exportStar:ei,__values:ri,__read:ii,__spread:ni,__spreadArrays:si,__await:oi,__asyncGenerator:ai,__asyncDelegator:ci,__asyncValues:hi,__makeTemplateObject:ui,__importStar:fi,__importDefault:li,__classPrivateFieldGet:di,__classPrivateFieldSet:pi}),yi=s(wi),vi={},bi;function mi(){return bi||(bi=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.PINO_CUSTOM_CONTEXT_KEY=vi.PINO_LOGGER_DEFAULTS=void 0,vi.PINO_LOGGER_DEFAULTS={level:"info"},vi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),vi}var _i={},gi;function Ei(){if(gi)return _i;gi=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.generateChildLogger=_i.formatChildLoggerContext=_i.getLoggerContext=_i.setBrowserLoggerContext=_i.getBrowserLoggerContext=_i.getDefaultLoggerOptions=void 0;const t=mi();function e(e){return Object.assign(Object.assign({},e),{level:e?.level||t.PINO_LOGGER_DEFAULTS.level})}_i.getDefaultLoggerOptions=e;function r(e,r=t.PINO_CUSTOM_CONTEXT_KEY){return e[r]||""}_i.getBrowserLoggerContext=r;function i(e,r,i=t.PINO_CUSTOM_CONTEXT_KEY){return e[i]=r,e}_i.setBrowserLoggerContext=i;function n(e,i=t.PINO_CUSTOM_CONTEXT_KEY){let n="";return typeof e.bindings>"u"?n=r(e,i):n=e.bindings().context||"",n}_i.getLoggerContext=n;function s(e,r,i=t.PINO_CUSTOM_CONTEXT_KEY){const s=n(e,i);return s.trim()?`${s}/${r}`:r}_i.formatChildLoggerContext=s;function o(e,r,n=t.PINO_CUSTOM_CONTEXT_KEY){const o=s(e,r,n),a=e.child({context:o});return i(a,o,n)}return _i.generateChildLogger=o,_i}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=yi,r=e.__importDefault(u);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(mi(),t),e.__exportStar(Ei(),t)})(Kr);var Oi={exports:{}},ji=typeof Reflect=="object"?Reflect:null,Si=ji&&typeof ji.apply=="function"?ji.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},Ii;ji&&typeof ji.ownKeys=="function"?Ii=ji.ownKeys:Object.getOwnPropertySymbols?Ii=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ii=function(t){return Object.getOwnPropertyNames(t)};function Ai(t){console&&console.warn&&console.warn(t)}var xi=Number.isNaN||function(t){return t!==t};function Ni(){Ni.init.call(this)}Oi.exports=Ni,Oi.exports.once=Vi,Ni.EventEmitter=Ni,Ni.prototype._events=void 0,Ni.prototype._eventsCount=0,Ni.prototype._maxListeners=void 0;var Mi=10;function Ti(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ni,"defaultMaxListeners",{enumerable:!0,get:function(){return Mi},set:function(t){if(typeof t!="number"||t<0||xi(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Mi=t}}),Ni.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ni.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||xi(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ri(t){return t._maxListeners===void 0?Ni.defaultMaxListeners:t._maxListeners}Ni.prototype.getMaxListeners=function(){return Ri(this)},Ni.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[t];if(a===void 0)return!1;if(typeof a=="function")Si(a,this,e);else for(var c=a.length,h=ki(a,c),r=0;r<c;++r)Si(h[r],this,e);return!0};function Pi(t,e,r,i){var n,s,o;if(Ti(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=Ri(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Ai(a)}return t}Ni.prototype.addListener=function(t,e){return Pi(this,t,e,!1)},Ni.prototype.on=Ni.prototype.addListener,Ni.prototype.prependListener=function(t,e){return Pi(this,t,e,!0)};function Ui(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function $i(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=Ui.bind(i);return n.listener=r,i.wrapFn=n,n}Ni.prototype.once=function(t,e){return Ti(e),this.on(t,$i(this,t,e)),this},Ni.prototype.prependOnceListener=function(t,e){return Ti(e),this.prependListener(t,$i(this,t,e)),this},Ni.prototype.removeListener=function(t,e){var r,i,n,s,o;if(Ti(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():Li(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},Ni.prototype.off=Ni.prototype.removeListener,Ni.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function Di(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?Fi(n):ki(n,n.length)}Ni.prototype.listeners=function(t){return Di(this,t,!0)},Ni.prototype.rawListeners=function(t){return Di(this,t,!1)},Ni.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Ci.call(t,e)},Ni.prototype.listenerCount=Ci;function Ci(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ni.prototype.eventNames=function(){return this._eventsCount>0?Ii(this._events):[]};function ki(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function Li(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Fi(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Vi(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}Gi(t,e,s,{once:!0}),e!=="error"&&qi(t,n,{once:!0})}))}function qi(t,e,r){typeof t.on=="function"&&Gi(t,"error",e,r)}function Gi(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class Ki extends Nr{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Bi extends Nr{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}}class zi{constructor(t,e){this.logger=t,this.core=e}}class Wi extends Nr{constructor(t,e){super(),this.relayer=t,this.logger=e}}class Hi extends Nr{constructor(t){super()}}class Ji{constructor(t,e,r,i){this.core=t,this.logger=e,this.name=r}}class Xi extends Nr{constructor(t,e){super(),this.relayer=t,this.logger=e}}class Yi extends Nr{constructor(t,e){super(),this.core=t,this.logger=e}}class Zi{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class Qi{constructor(t){this.client=t}}function tn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function en(t){return typeof t=="string"?t:JSON.stringify(t)}var rn={},nn={},sn={},on={};Object.defineProperty(on,"__esModule",{value:!0}),on.BrowserRandomSource=void 0;const an=65536;class cn{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const e=new Uint8Array(t);for(let t=0;t<e.length;t+=an)this._crypto.getRandomValues(e.subarray(t,t+Math.min(e.length-t,an)));return e}}on.BrowserRandomSource=cn;function hn(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var un={},fn={};Object.defineProperty(fn,"__esModule",{value:!0});function ln(t){for(var e=0;e<t.length;e++)t[e]=0;return t}fn.wipe=ln;var dn={},pn=Object.freeze({__proto__:null,default:dn}),wn=s(pn);Object.defineProperty(un,"__esModule",{value:!0}),un.NodeRandomSource=void 0;const yn=fn;class vn{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof hn<"u"){const t=wn;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let e=this._crypto.randomBytes(t);if(e.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const r=new Uint8Array(t);for(let t=0;t<r.length;t++)r[t]=e[t];return(0,yn.wipe)(e),r}}un.NodeRandomSource=vn,Object.defineProperty(sn,"__esModule",{value:!0}),sn.SystemRandomSource=void 0;const bn=on,mn=un;class _n{constructor(){if(this.isAvailable=!1,this.name="",this._source=new bn.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new mn.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}sn.SystemRandomSource=_n;var gn={},En={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(t,e){var r=t>>>16&65535,i=t&65535,n=e>>>16&65535,s=e&65535;return i*s+(r*s+i*n<<16>>>0)|0}t.mul=Math.imul||e;function r(t,e){return t+e|0}t.add=r;function i(t,e){return t-e|0}t.sub=i;function n(t,e){return t<<e|t>>>32-e}t.rotl=n;function s(t,e){return t<<32-e|t>>>e}t.rotr=s;function o(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}})(En),Object.defineProperty(gn,"__esModule",{value:!0});var On=En;function jn(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}gn.readInt16BE=jn;function Sn(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}gn.readUint16BE=Sn;function In(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}gn.readInt16LE=In;function An(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}gn.readUint16LE=An;function xn(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}gn.writeUint16BE=xn,gn.writeInt16BE=xn;function Nn(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}gn.writeUint16LE=Nn,gn.writeInt16LE=Nn;function Mn(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}gn.readInt32BE=Mn;function Tn(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}gn.readUint32BE=Tn;function Rn(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}gn.readInt32LE=Rn;function Pn(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}gn.readUint32LE=Pn;function Un(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}gn.writeUint32BE=Un,gn.writeInt32BE=Un;function $n(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}gn.writeUint32LE=$n,gn.writeInt32LE=$n;function Dn(t,e){e===void 0&&(e=0);var r=Mn(t,e),i=Mn(t,e+4);return r*4294967296+i-(i>>31)*4294967296}gn.readInt64BE=Dn;function Cn(t,e){e===void 0&&(e=0);var r=Tn(t,e),i=Tn(t,e+4);return r*4294967296+i}gn.readUint64BE=Cn;function kn(t,e){e===void 0&&(e=0);var r=Rn(t,e),i=Rn(t,e+4);return i*4294967296+r-(r>>31)*4294967296}gn.readInt64LE=kn;function Ln(t,e){e===void 0&&(e=0);var r=Pn(t,e),i=Pn(t,e+4);return i*4294967296+r}gn.readUint64LE=Ln;function Fn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Un(t/4294967296>>>0,e,r),Un(t>>>0,e,r+4),e}gn.writeUint64BE=Fn,gn.writeInt64BE=Fn;function Vn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),$n(t>>>0,e,r),$n(t/4294967296>>>0,e,r+4),e}gn.writeUint64LE=Vn,gn.writeInt64LE=Vn;function qn(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}gn.readUintBE=qn;function Gn(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}gn.readUintLE=Gn;function Kn(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!On.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}gn.writeUintBE=Kn;function Bn(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!On.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}gn.writeUintLE=Bn;function zn(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}gn.readFloat32BE=zn;function Wn(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}gn.readFloat32LE=Wn;function Hn(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}gn.readFloat64BE=Hn;function Jn(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}gn.readFloat64LE=Jn;function Xn(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}gn.writeFloat32BE=Xn;function Yn(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}gn.writeFloat32LE=Yn;function Zn(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}gn.writeFloat64BE=Zn;function Qn(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}gn.writeFloat64LE=Qn,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=sn,r=gn,i=fn;t.defaultRandomSource=new e.SystemRandomSource;function n(e,r=t.defaultRandomSource){return r.randomBytes(e)}t.randomBytes=n;function s(e=t.defaultRandomSource){const s=n(4,e),o=(0,r.readUint32LE)(s);return(0,i.wipe)(s),o}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(e,r=o,s=t.defaultRandomSource){if(r.length<2)throw new Error("randomString charset is too short");if(r.length>256)throw new Error("randomString charset is too long");let a="";const c=r.length,h=256-256%c;for(;e>0;){const t=n(Math.ceil(e*256/h),s);for(let i=0;i<t.length&&e>0;i++){const n=t[i];n<h&&(a+=r.charAt(n%c),e--)}(0,i.wipe)(t)}return a}t.randomString=a;function c(e,r=o,i=t.defaultRandomSource){const n=Math.ceil(e/(Math.log(r.length)/Math.LN2));return a(n,r,i)}t.randomStringForEntropy=c}(nn);var ts={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=gn,r=fn;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function i(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},i.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var i=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=e[i++],r--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(i=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,i,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[i++],r--;return this},i.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,i=this._bufferLength,n=r/536870912|0,o=r<<3,a=r%128<112?128:256;this._buffer[i]=128;for(var c=i+1;c<a-8;c++)this._buffer[c]=0;e.writeUint32BE(n,this._buffer,a-8),e.writeUint32BE(o,this._buffer,a-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,a),this._finished=!0}for(var c=0;c<this.digestLength/8;c++)e.writeUint32BE(this._stateHi[c],t,c*8),e.writeUint32BE(this._stateLo[c],t,c*8+4);return this},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(t){r.wipe(t.stateHi),r.wipe(t.stateLo),t.buffer&&r.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},i}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(t,r,i,s,o,a,c){for(var h=i[0],u=i[1],f=i[2],l=i[3],d=i[4],p=i[5],w=i[6],y=i[7],v=s[0],b=s[1],m=s[2],_=s[3],g=s[4],E=s[5],O=s[6],j=s[7],S,I,A,x,N,M,T,R;c>=128;){for(var P=0;P<16;P++){var U=8*P+a;t[P]=e.readUint32BE(o,U),r[P]=e.readUint32BE(o,U+4)}for(var P=0;P<80;P++){var $=h,D=u,C=f,k=l,L=d,F=p,V=w,q=y,G=v,K=b,B=m,z=_,W=g,H=E,J=O,X=j;if(S=y,I=j,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=(d>>>14|g<<32-14)^(d>>>18|g<<32-18)^(g>>>41-32|d<<32-(41-32)),I=(g>>>14|d<<32-14)^(g>>>18|d<<32-18)^(d>>>41-32|g<<32-(41-32)),N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,S=d&p^~d&w,I=g&E^~g&O,N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,S=n[P*2],I=n[P*2+1],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,S=t[P%16],I=r[P%16],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,A=T&65535|R<<16,x=N&65535|M<<16,S=A,I=x,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=(h>>>28|v<<32-28)^(v>>>34-32|h<<32-(34-32))^(v>>>39-32|h<<32-(39-32)),I=(v>>>28|h<<32-28)^(h>>>34-32|v<<32-(34-32))^(h>>>39-32|v<<32-(39-32)),N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,S=h&u^h&f^u&f,I=v&b^v&m^b&m,N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,q=T&65535|R<<16,X=N&65535|M<<16,S=k,I=z,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=A,I=x,N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,k=T&65535|R<<16,z=N&65535|M<<16,u=$,f=D,l=C,d=k,p=L,w=F,y=V,h=q,b=G,m=K,_=B,g=z,E=W,O=H,j=J,v=X,P%16===15)for(var U=0;U<16;U++)S=t[U],I=r[U],N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=t[(U+9)%16],I=r[(U+9)%16],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,A=t[(U+1)%16],x=r[(U+1)%16],S=(A>>>1|x<<32-1)^(A>>>8|x<<32-8)^A>>>7,I=(x>>>1|A<<32-1)^(x>>>8|A<<32-8)^(x>>>7|A<<32-7),N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,A=t[(U+14)%16],x=r[(U+14)%16],S=(A>>>19|x<<32-19)^(x>>>61-32|A<<32-(61-32))^A>>>6,I=(x>>>19|A<<32-19)^(A>>>61-32|x<<32-(61-32))^(x>>>6|A<<32-6),N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,t[U]=T&65535|R<<16,r[U]=N&65535|M<<16}S=h,I=v,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[0],I=s[0],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[0]=h=T&65535|R<<16,s[0]=v=N&65535|M<<16,S=u,I=b,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[1],I=s[1],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[1]=u=T&65535|R<<16,s[1]=b=N&65535|M<<16,S=f,I=m,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[2],I=s[2],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[2]=f=T&65535|R<<16,s[2]=m=N&65535|M<<16,S=l,I=_,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[3],I=s[3],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[3]=l=T&65535|R<<16,s[3]=_=N&65535|M<<16,S=d,I=g,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[4],I=s[4],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[4]=d=T&65535|R<<16,s[4]=g=N&65535|M<<16,S=p,I=E,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[5],I=s[5],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[5]=p=T&65535|R<<16,s[5]=E=N&65535|M<<16,S=w,I=O,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[6],I=s[6],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[6]=w=T&65535|R<<16,s[6]=O=N&65535|M<<16,S=y,I=j,N=I&65535,M=I>>>16,T=S&65535,R=S>>>16,S=i[7],I=s[7],N+=I&65535,M+=I>>>16,T+=S&65535,R+=S>>>16,M+=N>>>16,T+=M>>>16,R+=T>>>16,i[7]=y=T&65535|R<<16,s[7]=j=N&65535|M<<16,a+=128,c-=128}return a}function o(t){var e=new i;e.update(t);var r=e.digest();return e.clean(),r}t.hash=o})(ts),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=nn,r=ts,i=fn;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(t){const e=new Float64Array(16);if(t)for(let r=0;r<t.length;r++)e[r]=t[r];return e}const s=new Uint8Array(32);s[0]=9;const o=n(),a=n([1]),c=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),l=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(t,e){for(let r=0;r<16;r++)t[r]=e[r]|0}function p(t){let e=1;for(let r=0;r<16;r++){let i=t[r]+e+65535;e=Math.floor(i/65536),t[r]=i-e*65536}t[0]+=e-1+37*(e-1)}function w(t,e,r){const i=~(r-1);for(let r=0;r<16;r++){const n=i&(t[r]^e[r]);t[r]^=n,e[r]^=n}}function y(t,e){const r=n(),i=n();for(let t=0;t<16;t++)i[t]=e[t];p(i),p(i),p(i);for(let t=0;t<2;t++){r[0]=i[0]-65517;for(let t=1;t<15;t++)r[t]=i[t]-65535-(r[t-1]>>16&1),r[t-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);const t=r[15]>>16&1;r[14]&=65535,w(i,r,1-t)}for(let e=0;e<16;e++)t[2*e]=i[e]&255,t[2*e+1]=i[e]>>8}function v(t,e){let r=0;for(let i=0;i<32;i++)r|=t[i]^e[i];return(1&r-1>>>8)-1}function b(t,e){const r=new Uint8Array(32),i=new Uint8Array(32);return y(r,t),y(i,e),v(r,i)}function m(t){const e=new Uint8Array(32);return y(e,t),e[0]&1}function _(t,e){for(let r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function g(t,e,r){for(let i=0;i<16;i++)t[i]=e[i]+r[i]}function E(t,e,r){for(let i=0;i<16;i++)t[i]=e[i]-r[i]}function O(t,e,r){let i,n,s=0,o=0,a=0,c=0,h=0,u=0,f=0,l=0,d=0,p=0,w=0,y=0,v=0,b=0,m=0,_=0,g=0,E=0,O=0,j=0,S=0,I=0,A=0,x=0,N=0,M=0,T=0,R=0,P=0,U=0,$=0,D=r[0],C=r[1],k=r[2],L=r[3],F=r[4],V=r[5],q=r[6],G=r[7],K=r[8],B=r[9],z=r[10],W=r[11],H=r[12],J=r[13],X=r[14],Y=r[15];i=e[0],s+=i*D,o+=i*C,a+=i*k,c+=i*L,h+=i*F,u+=i*V,f+=i*q,l+=i*G,d+=i*K,p+=i*B,w+=i*z,y+=i*W,v+=i*H,b+=i*J,m+=i*X,_+=i*Y,i=e[1],o+=i*D,a+=i*C,c+=i*k,h+=i*L,u+=i*F,f+=i*V,l+=i*q,d+=i*G,p+=i*K,w+=i*B,y+=i*z,v+=i*W,b+=i*H,m+=i*J,_+=i*X,g+=i*Y,i=e[2],a+=i*D,c+=i*C,h+=i*k,u+=i*L,f+=i*F,l+=i*V,d+=i*q,p+=i*G,w+=i*K,y+=i*B,v+=i*z,b+=i*W,m+=i*H,_+=i*J,g+=i*X,E+=i*Y,i=e[3],c+=i*D,h+=i*C,u+=i*k,f+=i*L,l+=i*F,d+=i*V,p+=i*q,w+=i*G,y+=i*K,v+=i*B,b+=i*z,m+=i*W,_+=i*H,g+=i*J,E+=i*X,O+=i*Y,i=e[4],h+=i*D,u+=i*C,f+=i*k,l+=i*L,d+=i*F,p+=i*V,w+=i*q,y+=i*G,v+=i*K,b+=i*B,m+=i*z,_+=i*W,g+=i*H,E+=i*J,O+=i*X,j+=i*Y,i=e[5],u+=i*D,f+=i*C,l+=i*k,d+=i*L,p+=i*F,w+=i*V,y+=i*q,v+=i*G,b+=i*K,m+=i*B,_+=i*z,g+=i*W,E+=i*H,O+=i*J,j+=i*X,S+=i*Y,i=e[6],f+=i*D,l+=i*C,d+=i*k,p+=i*L,w+=i*F,y+=i*V,v+=i*q,b+=i*G,m+=i*K,_+=i*B,g+=i*z,E+=i*W,O+=i*H,j+=i*J,S+=i*X,I+=i*Y,i=e[7],l+=i*D,d+=i*C,p+=i*k,w+=i*L,y+=i*F,v+=i*V,b+=i*q,m+=i*G,_+=i*K,g+=i*B,E+=i*z,O+=i*W,j+=i*H,S+=i*J,I+=i*X,A+=i*Y,i=e[8],d+=i*D,p+=i*C,w+=i*k,y+=i*L,v+=i*F,b+=i*V,m+=i*q,_+=i*G,g+=i*K,E+=i*B,O+=i*z,j+=i*W,S+=i*H,I+=i*J,A+=i*X,x+=i*Y,i=e[9],p+=i*D,w+=i*C,y+=i*k,v+=i*L,b+=i*F,m+=i*V,_+=i*q,g+=i*G,E+=i*K,O+=i*B,j+=i*z,S+=i*W,I+=i*H,A+=i*J,x+=i*X,N+=i*Y,i=e[10],w+=i*D,y+=i*C,v+=i*k,b+=i*L,m+=i*F,_+=i*V,g+=i*q,E+=i*G,O+=i*K,j+=i*B,S+=i*z,I+=i*W,A+=i*H,x+=i*J,N+=i*X,M+=i*Y,i=e[11],y+=i*D,v+=i*C,b+=i*k,m+=i*L,_+=i*F,g+=i*V,E+=i*q,O+=i*G,j+=i*K,S+=i*B,I+=i*z,A+=i*W,x+=i*H,N+=i*J,M+=i*X,T+=i*Y,i=e[12],v+=i*D,b+=i*C,m+=i*k,_+=i*L,g+=i*F,E+=i*V,O+=i*q,j+=i*G,S+=i*K,I+=i*B,A+=i*z,x+=i*W,N+=i*H,M+=i*J,T+=i*X,R+=i*Y,i=e[13],b+=i*D,m+=i*C,_+=i*k,g+=i*L,E+=i*F,O+=i*V,j+=i*q,S+=i*G,I+=i*K,A+=i*B,x+=i*z,N+=i*W,M+=i*H,T+=i*J,R+=i*X,P+=i*Y,i=e[14],m+=i*D,_+=i*C,g+=i*k,E+=i*L,O+=i*F,j+=i*V,S+=i*q,I+=i*G,A+=i*K,x+=i*B,N+=i*z,M+=i*W,T+=i*H,R+=i*J,P+=i*X,U+=i*Y,i=e[15],_+=i*D,g+=i*C,E+=i*k,O+=i*L,j+=i*F,S+=i*V,I+=i*q,A+=i*G,x+=i*K,N+=i*B,M+=i*z,T+=i*W,R+=i*H,P+=i*J,U+=i*X,$+=i*Y,s+=38*g,o+=38*E,a+=38*O,c+=38*j,h+=38*S,u+=38*I,f+=38*A,l+=38*x,d+=38*N,p+=38*M,w+=38*T,y+=38*R,v+=38*P,b+=38*U,m+=38*$,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=h,t[5]=u,t[6]=f,t[7]=l,t[8]=d,t[9]=p,t[10]=w,t[11]=y,t[12]=v,t[13]=b,t[14]=m,t[15]=_}function j(t,e){O(t,e,e)}function S(t,e){const r=n();let i;for(i=0;i<16;i++)r[i]=e[i];for(i=253;i>=0;i--)j(r,r),i!==2&&i!==4&&O(r,r,e);for(i=0;i<16;i++)t[i]=r[i]}function I(t,e){const r=n();let i;for(i=0;i<16;i++)r[i]=e[i];for(i=250;i>=0;i--)j(r,r),i!==1&&O(r,r,e);for(i=0;i<16;i++)t[i]=r[i]}function A(t,e){const r=n(),i=n(),s=n(),o=n(),a=n(),c=n(),u=n(),f=n(),l=n();E(r,t[1],t[0]),E(l,e[1],e[0]),O(r,r,l),g(i,t[0],t[1]),g(l,e[0],e[1]),O(i,i,l),O(s,t[3],e[3]),O(s,s,h),O(o,t[2],e[2]),g(o,o,o),E(a,i,r),E(c,o,s),g(u,o,s),g(f,i,r),O(t[0],a,c),O(t[1],f,u),O(t[2],u,c),O(t[3],a,f)}function x(t,e,r){for(let i=0;i<4;i++)w(t[i],e[i],r)}function N(t,e){const r=n(),i=n(),s=n();S(s,e[2]),O(r,e[0],s),O(i,e[1],s),y(t,i),t[31]^=m(r)<<7}function M(t,e,r){d(t[0],o),d(t[1],a),d(t[2],a),d(t[3],o);for(let i=255;i>=0;--i){const n=r[i/8|0]>>(i&7)&1;x(t,e,n),A(e,t),A(t,t),x(t,e,n)}}function T(t,e){const r=[n(),n(),n(),n()];d(r[0],u),d(r[1],f),d(r[2],a),O(r[3],u,f),M(t,r,e)}function R(e){if(e.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const i=(0,r.hash)(e);i[0]&=248,i[31]&=127,i[31]|=64;const s=new Uint8Array(32),o=[n(),n(),n(),n()];T(o,i),N(s,o);const a=new Uint8Array(64);return a.set(e),a.set(s,32),{publicKey:s,secretKey:a}}t.generateKeyPairFromSeed=R;function P(t){const r=(0,e.randomBytes)(32,t),n=R(r);return(0,i.wipe)(r),n}t.generateKeyPair=P;function U(e){if(e.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(e.subarray(32))}t.extractPublicKeyFromSecretKey=U;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function D(t,e){let r,i,n,s;for(i=63;i>=32;--i){for(r=0,n=i-32,s=i-12;n<s;++n)e[n]+=r-16*e[i]*$[n-(i-32)],r=Math.floor((e[n]+128)/256),e[n]-=r*256;e[n]+=r,e[i]=0}for(r=0,n=0;n<32;n++)e[n]+=r-(e[31]>>4)*$[n],r=e[n]>>8,e[n]&=255;for(n=0;n<32;n++)e[n]-=r*$[n];for(i=0;i<32;i++)e[i+1]+=e[i]>>8,t[i]=e[i]&255}function C(t){const e=new Float64Array(64);for(let r=0;r<64;r++)e[r]=t[r];for(let e=0;e<64;e++)t[e]=0;D(t,e)}function k(t,e){const i=new Float64Array(64),s=[n(),n(),n(),n()],o=(0,r.hash)(t.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;const a=new Uint8Array(64);a.set(o.subarray(32),32);const c=new r.SHA512;c.update(a.subarray(32)),c.update(e);const h=c.digest();c.clean(),C(h),T(s,h),N(a,s),c.reset(),c.update(a.subarray(0,32)),c.update(t.subarray(32)),c.update(e);const u=c.digest();C(u);for(let t=0;t<32;t++)i[t]=h[t];for(let t=0;t<32;t++)for(let e=0;e<32;e++)i[t+e]+=u[t]*o[e];return D(a.subarray(32),i),a}t.sign=k;function L(t,e){const r=n(),i=n(),s=n(),h=n(),u=n(),f=n(),p=n();return d(t[2],a),_(t[1],e),j(s,t[1]),O(h,s,c),E(s,s,t[2]),g(h,t[2],h),j(u,h),j(f,u),O(p,f,u),O(r,p,s),O(r,r,h),I(r,r),O(r,r,s),O(r,r,h),O(r,r,h),O(t[0],r,h),j(i,t[0]),O(i,i,h),b(i,s)&&O(t[0],t[0],l),j(i,t[0]),O(i,i,h),b(i,s)?-1:(m(t[0])===e[31]>>7&&E(t[0],o,t[0]),O(t[3],t[0],t[1]),0)}function F(e,i,s){const o=new Uint8Array(32),a=[n(),n(),n(),n()],c=[n(),n(),n(),n()];if(s.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(L(c,e))return!1;const h=new r.SHA512;h.update(s.subarray(0,32)),h.update(e),h.update(i);const u=h.digest();return C(u),M(a,c,u),T(c,s.subarray(32)),A(a,c),N(o,a),!v(s,o)}t.verify=F;function V(t){let e=[n(),n(),n(),n()];if(L(e,t))throw new Error("Ed25519: invalid public key");let r=n(),i=n(),s=e[1];g(r,a,s),E(i,a,s),S(i,i),O(r,r,i);let o=new Uint8Array(32);return y(o,r),o}t.convertPublicKeyToX25519=V;function q(t){const e=(0,r.hash)(t.subarray(0,32));e[0]&=248,e[31]&=127,e[31]|=64;const n=new Uint8Array(e.subarray(0,32));return(0,i.wipe)(e),n}t.convertSecretKeyToX25519=q}(rn);const es="EdDSA",rs="JWT",is=".",ns="base64url",ss="utf8",os="utf8",as=":",cs="did",hs="key",us="base58btc",fs="z",ls="K36",ds=32;function ps(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ws(t,e){e||(e=t.reduce(((t,e)=>t+e.length),0));const r=ps(e);let i=0;for(const e of t)r.set(e,i),i+=e.length;return r}function ys(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length===0)return"";for(var r=0,i=0,n=0,s=e.length;n!==s&&e[n]===0;)n++,r++;for(var o=(s-n)*u+1>>>0,h=new Uint8Array(o);n!==s;){for(var f=e[n],l=0,d=o-1;(f!==0||l<i)&&d!==-1;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(f!==0)throw new Error("Non-zero carry");i=l,n++}for(var p=o-i;p!==o&&h[p]===0;)p++;for(var w=c.repeat(r);p<o;++p)w+=t.charAt(h[p]);return w}function l(t){if(typeof t!="string")throw new TypeError("Expected String");if(t.length===0)return new Uint8Array;var e=0;if(t[e]!==" "){for(var i=0,n=0;t[e]===c;)i++,e++;for(var s=(t.length-e)*h+1>>>0,o=new Uint8Array(s);t[e];){var u=r[t.charCodeAt(e)];if(u===255)return;for(var f=0,l=s-1;(u!==0||f<n)&&l!==-1;l--,f++)u+=a*o[l]>>>0,o[l]=u%256>>>0,u=u/256>>>0;if(u!==0)throw new Error("Non-zero carry");n=f,e++}if(t[e]!==" "){for(var d=s-n;d!==s&&o[d]===0;)d++;for(var p=new Uint8Array(i+(s-d)),w=i;d!==s;)p[w++]=o[d++];return p}}}function d(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:l,decode:d}}var vs=ys,bs=vs;const ms=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_s=t=>(new TextEncoder).encode(t),gs=t=>(new TextDecoder).decode(t);class Es{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Os{constructor(t,e,r){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ss(this,t)}}class js{constructor(t){this.decoders=t}or(t){return Ss(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ss=(t,e)=>new js({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Is{constructor(t,e,r,i){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=i,this.encoder=new Es(t,e,r),this.decoder=new Os(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const As=({name:t,prefix:e,encode:r,decode:i})=>new Is(t,e,r,i),xs=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=bs(r,e);return As({prefix:t,name:e,encode:i,decode:t=>ms(n(t))})},Ns=(t,e,r,i)=>{const n={};for(let t=0;t<e.length;++t)n[e[t]]=t;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,h=0;for(let e=0;e<s;++e){const s=n[t[e]];if(s===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ms=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let i=0;i<t.length;++i)for(a=a<<8|t[i],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Ts=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>As({prefix:e,name:t,encode(t){return Ms(t,i,r)},decode(e){return Ns(e,i,r,t)}}),Rs=As({prefix:"\0",name:"identity",encode:t=>gs(t),decode:t=>_s(t)});var Ps=Object.freeze({__proto__:null,identity:Rs});const Us=Ts({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $s=Object.freeze({__proto__:null,base2:Us});const Ds=Ts({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Cs=Object.freeze({__proto__:null,base8:Ds});const ks=xs({prefix:"9",name:"base10",alphabet:"0123456789"});var Ls=Object.freeze({__proto__:null,base10:ks});const Fs=Ts({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Vs=Ts({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var qs=Object.freeze({__proto__:null,base16:Fs,base16upper:Vs});const Gs=Ts({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ks=Ts({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Bs=Ts({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zs=Ts({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ws=Ts({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hs=Ts({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Js=Ts({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xs=Ts({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ys=Ts({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Zs=Object.freeze({__proto__:null,base32:Gs,base32upper:Ks,base32pad:Bs,base32padupper:zs,base32hex:Ws,base32hexupper:Hs,base32hexpad:Js,base32hexpadupper:Xs,base32z:Ys});const Qs=xs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),to=xs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eo=Object.freeze({__proto__:null,base36:Qs,base36upper:to});const ro=xs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),io=xs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var no=Object.freeze({__proto__:null,base58btc:ro,base58flickr:io});const so=Ts({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),oo=Ts({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ao=Ts({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),co=Ts({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ho=Object.freeze({__proto__:null,base64:so,base64pad:oo,base64url:ao,base64urlpad:co});const uo=Array.from(""),fo=uo.reduce(((t,e,r)=>(t[r]=e,t)),[]),lo=uo.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]);function po(t){return t.reduce(((t,e)=>(t+=fo[e],t)),"")}function wo(t){const e=[];for(const r of t){const t=lo[r.codePointAt(0)];if(t===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}const yo=As({prefix:"",name:"base256emoji",encode:po,decode:wo});var vo=Object.freeze({__proto__:null,base256emoji:yo}),bo=Oo,mo=128,_o=127,go=~_o,Eo=Math.pow(2,31);function Oo(t,e,r){e=e||[],r=r||0;for(var i=r;t>=Eo;)e[r++]=t&255|mo,t/=128;for(;t&go;)e[r++]=t&255|mo,t>>>=7;return e[r]=t|0,Oo.bytes=r-i+1,e}var jo=Ao,So=128,Io=127;function Ao(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw Ao.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&Io)<<i:(s&Io)*Math.pow(2,i),i+=7}while(s>=So);return Ao.bytes=n-e,r}var xo=Math.pow(2,7),No=Math.pow(2,14),Mo=Math.pow(2,21),To=Math.pow(2,28),Ro=Math.pow(2,35),Po=Math.pow(2,42),Uo=Math.pow(2,49),$o=Math.pow(2,56),Do=Math.pow(2,63),Co=function(t){return t<xo?1:t<No?2:t<Mo?3:t<To?4:t<Ro?5:t<Po?6:t<Uo?7:t<$o?8:t<Do?9:10},ko={encode:bo,decode:jo,encodingLength:Co},Lo=ko;const Fo=(t,e,r=0)=>(Lo.encode(t,e,r),e),Vo=t=>Lo.encodingLength(t),qo=(t,e)=>{const r=e.byteLength,i=Vo(t),n=i+Vo(r),s=new Uint8Array(n+r);return Fo(t,s,0),Fo(r,s,i),s.set(e,n),new Go(t,r,e,s)};class Go{constructor(t,e,r,i){this.code=t,this.size=e,this.digest=r,this.bytes=i}}const Ko=({name:t,code:e,encode:r})=>new Bo(t,e,r);class Bo{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?qo(this.code,e):e.then((t=>qo(this.code,t)))}else throw Error("Unknown type, must be binary type")}}const zo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Wo=Ko({name:"sha2-256",code:18,encode:zo("SHA-256")}),Ho=Ko({name:"sha2-512",code:19,encode:zo("SHA-512")});Object.freeze({__proto__:null,sha256:Wo,sha512:Ho});const Jo=0,Xo="identity",Yo=ms;Object.freeze({__proto__:null,identity:{code:Jo,name:Xo,encode:Yo,digest:t=>qo(Jo,Yo(t))}});new TextEncoder,new TextDecoder;const Zo={...Ps,...$s,...Cs,...Ls,...qs,...Zs,...eo,...no,...ho,...vo};function Qo(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const ta=Qo("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),ea=Qo("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{t=t.substring(1);const e=ps(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),ra={utf8:ta,"utf-8":ta,hex:Zo.base16,latin1:ea,ascii:ea,binary:ea,...Zo};function ia(t,e="utf8"){const r=ra[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function na(t,e="utf8"){const r=ra[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function sa(t){return ia(na(en(t),ss),ns)}function oa(t){const e=na(ls,us),r=fs+ia(ws([e,t]),us);return[cs,hs,r].join(as)}function aa(t){return ia(t,ns)}function ca(t){return na([sa(t.header),sa(t.payload)].join(is),os)}function ha(t){return[sa(t.header),sa(t.payload),aa(t.signature)].join(is)}function ua(t=nn.randomBytes(ds)){return rn.generateKeyPairFromSeed(t)}async function fa(t,e,r,i,n=Ae.fromMiliseconds(Date.now())){const s={alg:es,typ:rs},o=oa(i.publicKey),a=n+r,c={iss:o,sub:t,aud:e,iat:n,exp:a},h=ca({header:s,payload:c}),u=rn.sign(i.secretKey,h);return ha({header:s,payload:c,signature:u})}var la={},da={};Object.defineProperty(da,"__esModule",{value:!0});var pa=gn,wa=fn,ya=20;function va(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],c=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],f=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],w=e[3]<<24|e[2]<<16|e[1]<<8|e[0],y=e[7]<<24|e[6]<<16|e[5]<<8|e[4],v=e[11]<<24|e[10]<<16|e[9]<<8|e[8],b=e[15]<<24|e[14]<<16|e[13]<<8|e[12],m=i,_=n,g=s,E=o,O=a,j=c,S=h,I=u,A=f,x=l,N=d,M=p,T=w,R=y,P=v,U=b,$=0;$<ya;$+=2)m=m+O|0,T^=m,T=T>>>32-16|T<<16,A=A+T|0,O^=A,O=O>>>32-12|O<<12,_=_+j|0,R^=_,R=R>>>32-16|R<<16,x=x+R|0,j^=x,j=j>>>32-12|j<<12,g=g+S|0,P^=g,P=P>>>32-16|P<<16,N=N+P|0,S^=N,S=S>>>32-12|S<<12,E=E+I|0,U^=E,U=U>>>32-16|U<<16,M=M+U|0,I^=M,I=I>>>32-12|I<<12,g=g+S|0,P^=g,P=P>>>32-8|P<<8,N=N+P|0,S^=N,S=S>>>32-7|S<<7,E=E+I|0,U^=E,U=U>>>32-8|U<<8,M=M+U|0,I^=M,I=I>>>32-7|I<<7,_=_+j|0,R^=_,R=R>>>32-8|R<<8,x=x+R|0,j^=x,j=j>>>32-7|j<<7,m=m+O|0,T^=m,T=T>>>32-8|T<<8,A=A+T|0,O^=A,O=O>>>32-7|O<<7,m=m+j|0,U^=m,U=U>>>32-16|U<<16,N=N+U|0,j^=N,j=j>>>32-12|j<<12,_=_+S|0,T^=_,T=T>>>32-16|T<<16,M=M+T|0,S^=M,S=S>>>32-12|S<<12,g=g+I|0,R^=g,R=R>>>32-16|R<<16,A=A+R|0,I^=A,I=I>>>32-12|I<<12,E=E+O|0,P^=E,P=P>>>32-16|P<<16,x=x+P|0,O^=x,O=O>>>32-12|O<<12,g=g+I|0,R^=g,R=R>>>32-8|R<<8,A=A+R|0,I^=A,I=I>>>32-7|I<<7,E=E+O|0,P^=E,P=P>>>32-8|P<<8,x=x+P|0,O^=x,O=O>>>32-7|O<<7,_=_+S|0,T^=_,T=T>>>32-8|T<<8,M=M+T|0,S^=M,S=S>>>32-7|S<<7,m=m+j|0,U^=m,U=U>>>32-8|U<<8,N=N+U|0,j^=N,j=j>>>32-7|j<<7;pa.writeUint32LE(m+i|0,t,0),pa.writeUint32LE(_+n|0,t,4),pa.writeUint32LE(g+s|0,t,8),pa.writeUint32LE(E+o|0,t,12),pa.writeUint32LE(O+a|0,t,16),pa.writeUint32LE(j+c|0,t,20),pa.writeUint32LE(S+h|0,t,24),pa.writeUint32LE(I+u|0,t,28),pa.writeUint32LE(A+f|0,t,32),pa.writeUint32LE(x+l|0,t,36),pa.writeUint32LE(N+d|0,t,40),pa.writeUint32LE(M+p|0,t,44),pa.writeUint32LE(T+w|0,t,48),pa.writeUint32LE(R+y|0,t,52),pa.writeUint32LE(P+v|0,t,56),pa.writeUint32LE(U+b|0,t,60)}function ba(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=n}for(var a=new Uint8Array(64),c=0;c<r.length;c+=64){va(a,s,t);for(var h=c;h<c+64&&h<r.length;h++)i[h]=r[h]^a[h-c];_a(s,0,o)}return wa.wipe(a),n===0&&wa.wipe(s),i}da.streamXOR=ba;function ma(t,e,r,i){return i===void 0&&(i=0),wa.wipe(r),ba(t,e,r,r,i)}da.stream=ma;function _a(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var ga={},Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});function Oa(t,e,r){return~(t-1)&e|t-1&r}Ea.select=Oa;function ja(t,e){return(t|0)-(e|0)-1>>>31&1}Ea.lessOrEqual=ja;function Sa(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Ea.compare=Sa;function Ia(t,e){return t.length===0||e.length===0?!1:Sa(t,e)!==0}Ea.equal=Ia,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ea,r=fn;t.DIGEST_LENGTH=16;var i=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var i=e[2]|e[3]<<8;this._r[1]=(r>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(n>>>7|s<<9)&8191;var o=e[8]|e[9]<<8;this._r[4]=(s>>>4|o<<12)&255,this._r[5]=o>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(o>>>14|a<<2)&8191;var c=e[12]|e[13]<<8;this._r[7]=(a>>>11|c<<5)&8065;var h=e[14]|e[15]<<8;this._r[8]=(c>>>8|h<<8)&8191,this._r[9]=h>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(t,e,r){for(var i=this._fin?0:2048,n=this._h[0],s=this._h[1],o=this._h[2],a=this._h[3],c=this._h[4],h=this._h[5],u=this._h[6],f=this._h[7],l=this._h[8],d=this._h[9],p=this._r[0],w=this._r[1],y=this._r[2],v=this._r[3],b=this._r[4],m=this._r[5],_=this._r[6],g=this._r[7],E=this._r[8],O=this._r[9];r>=16;){var j=t[e+0]|t[e+1]<<8;n+=j&8191;var S=t[e+2]|t[e+3]<<8;s+=(j>>>13|S<<3)&8191;var I=t[e+4]|t[e+5]<<8;o+=(S>>>10|I<<6)&8191;var A=t[e+6]|t[e+7]<<8;a+=(I>>>7|A<<9)&8191;var x=t[e+8]|t[e+9]<<8;c+=(A>>>4|x<<12)&8191,h+=x>>>1&8191;var N=t[e+10]|t[e+11]<<8;u+=(x>>>14|N<<2)&8191;var M=t[e+12]|t[e+13]<<8;f+=(N>>>11|M<<5)&8191;var T=t[e+14]|t[e+15]<<8;l+=(M>>>8|T<<8)&8191,d+=T>>>5|i;var R=0,P=R;P+=n*p,P+=s*(5*O),P+=o*(5*E),P+=a*(5*g),P+=c*(5*_),R=P>>>13,P&=8191,P+=h*(5*m),P+=u*(5*b),P+=f*(5*v),P+=l*(5*y),P+=d*(5*w),R+=P>>>13,P&=8191;var U=R;U+=n*w,U+=s*p,U+=o*(5*O),U+=a*(5*E),U+=c*(5*g),R=U>>>13,U&=8191,U+=h*(5*_),U+=u*(5*m),U+=f*(5*b),U+=l*(5*v),U+=d*(5*y),R+=U>>>13,U&=8191;var $=R;$+=n*y,$+=s*w,$+=o*p,$+=a*(5*O),$+=c*(5*E),R=$>>>13,$&=8191,$+=h*(5*g),$+=u*(5*_),$+=f*(5*m),$+=l*(5*b),$+=d*(5*v),R+=$>>>13,$&=8191;var D=R;D+=n*v,D+=s*y,D+=o*w,D+=a*p,D+=c*(5*O),R=D>>>13,D&=8191,D+=h*(5*E),D+=u*(5*g),D+=f*(5*_),D+=l*(5*m),D+=d*(5*b),R+=D>>>13,D&=8191;var C=R;C+=n*b,C+=s*v,C+=o*y,C+=a*w,C+=c*p,R=C>>>13,C&=8191,C+=h*(5*O),C+=u*(5*E),C+=f*(5*g),C+=l*(5*_),C+=d*(5*m),R+=C>>>13,C&=8191;var k=R;k+=n*m,k+=s*b,k+=o*v,k+=a*y,k+=c*w,R=k>>>13,k&=8191,k+=h*p,k+=u*(5*O),k+=f*(5*E),k+=l*(5*g),k+=d*(5*_),R+=k>>>13,k&=8191;var L=R;L+=n*_,L+=s*m,L+=o*b,L+=a*v,L+=c*y,R=L>>>13,L&=8191,L+=h*w,L+=u*p,L+=f*(5*O),L+=l*(5*E),L+=d*(5*g),R+=L>>>13,L&=8191;var F=R;F+=n*g,F+=s*_,F+=o*m,F+=a*b,F+=c*v,R=F>>>13,F&=8191,F+=h*y,F+=u*w,F+=f*p,F+=l*(5*O),F+=d*(5*E),R+=F>>>13,F&=8191;var V=R;V+=n*E,V+=s*g,V+=o*_,V+=a*m,V+=c*b,R=V>>>13,V&=8191,V+=h*v,V+=u*y,V+=f*w,V+=l*p,V+=d*(5*O),R+=V>>>13,V&=8191;var q=R;q+=n*O,q+=s*E,q+=o*g,q+=a*_,q+=c*m,R=q>>>13,q&=8191,q+=h*b,q+=u*v,q+=f*y,q+=l*w,q+=d*p,R+=q>>>13,q&=8191,R=(R<<2)+R|0,R=R+P|0,P=R&8191,R=R>>>13,U+=R,n=P,s=U,o=$,a=D,c=C,h=k,u=L,f=F,l=V,d=q,e+=16,r-=16}this._h[0]=n,this._h[1]=s,this._h[2]=o,this._h[3]=a,this._h[4]=c,this._h[5]=h,this._h[6]=u,this._h[7]=f,this._h[8]=l,this._h[9]=d},e.prototype.finish=function(t,e){e===void 0&&(e=0);var r=new Uint16Array(10),i,n,s,o;if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=i,i=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,r[0]=this._h[0]+5,i=r[0]>>>13,r[0]&=8191,o=1;o<10;o++)r[o]=this._h[o]+i,i=r[o]>>>13,r[o]&=8191;for(r[9]-=1<<13,n=(i^1)-1,o=0;o<10;o++)r[o]&=n;for(n=~n,o=0;o<10;o++)this._h[o]=this._h[o]&n|r[o];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,s=this._h[0]+this._pad[0],this._h[0]=s&65535,o=1;o<8;o++)s=(this._h[o]+this._pad[o]|0)+(s>>>16)|0,this._h[o]=s&65535;return t[e+0]=this._h[0]>>>0,t[e+1]=this._h[0]>>>8,t[e+2]=this._h[1]>>>0,t[e+3]=this._h[1]>>>8,t[e+4]=this._h[2]>>>0,t[e+5]=this._h[2]>>>8,t[e+6]=this._h[3]>>>0,t[e+7]=this._h[3]>>>8,t[e+8]=this._h[4]>>>0,t[e+9]=this._h[4]>>>8,t[e+10]=this._h[5]>>>0,t[e+11]=this._h[5]>>>8,t[e+12]=this._h[6]>>>0,t[e+13]=this._h[6]>>>8,t[e+14]=this._h[7]>>>0,t[e+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(t){var e=0,r=t.length,i;if(this._leftover){i=16-this._leftover,i>r&&(i=r);for(var n=0;n<i;n++)this._buffer[this._leftover+n]=t[e+n];if(r-=i,e+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(r>=16&&(i=r-r%16,this._blocks(t,e,i),e+=i,r-=i),r){for(var n=0;n<r;n++)this._buffer[this._leftover+n]=t[e+n];this._leftover+=r}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},e.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=i;function n(t,e){var r=new i(t);r.update(e);var n=r.digest();return r.clean(),n}t.oneTimeAuth=n;function s(r,i){return r.length!==t.DIGEST_LENGTH||i.length!==t.DIGEST_LENGTH?!1:e.equal(r,i)}t.equal=s}(ga),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=da,r=ga,i=fn,n=gn,s=Ea;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function a(e){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,e.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return a.prototype.seal=function(t,r,n,s){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(t,o.length-t.length);var a=new Uint8Array(32);e.stream(this._key,o,a,4);var c=r.length+this.tagLength,h;if(s){if(s.length!==c)throw new Error("ChaCha20Poly1305: incorrect destination length");h=s}else h=new Uint8Array(c);return e.streamXOR(this._key,o,r,h,4),this._authenticate(h.subarray(h.length-this.tagLength,h.length),a,h.subarray(0,h.length-this.tagLength),n),i.wipe(o),h},a.prototype.open=function(t,r,n,o){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var a=new Uint8Array(16);a.set(t,a.length-t.length);var c=new Uint8Array(32);e.stream(this._key,a,c,4);var h=new Uint8Array(this.tagLength);if(this._authenticate(h,c,r.subarray(0,r.length-this.tagLength),n),!s.equal(h,r.subarray(r.length-this.tagLength,r.length)))return null;var u=r.length-this.tagLength,f;if(o){if(o.length!==u)throw new Error("ChaCha20Poly1305: incorrect destination length");f=o}else f=new Uint8Array(u);return e.streamXOR(this._key,a,r.subarray(0,r.length-this.tagLength),f,4),i.wipe(a),f},a.prototype.clean=function(){return i.wipe(this._key),this},a.prototype._authenticate=function(t,e,s,a){var c=new r.Poly1305(e);a&&(c.update(a),a.length%16>0&&c.update(o.subarray(a.length%16))),c.update(s),s.length%16>0&&c.update(o.subarray(s.length%16));var h=new Uint8Array(8);a&&n.writeUint64LE(a.length,h),c.update(h),n.writeUint64LE(s.length,h),c.update(h);for(var u=c.digest(),f=0;f<u.length;f++)t[f]=u[f];c.clean(),i.wipe(u),i.wipe(h)},a}();t.ChaCha20Poly1305=a}(la);var Aa={},xa={},Na={};Object.defineProperty(Na,"__esModule",{value:!0});function Ma(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Na.isSerializableHash=Ma,Object.defineProperty(xa,"__esModule",{value:!0});var Ta=Na,Ra=Ea,Pa=fn,Ua=function(){function t(t,e){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);e.length>this.blockSize?this._inner.update(e).finish(r).clean():r.set(e);for(var i=0;i<r.length;i++)r[i]^=54;this._inner.update(r);for(var i=0;i<r.length;i++)r[i]^=106;this._outer.update(r),Ta.isSerializableHash(this._inner)&&Ta.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Pa.wipe(r)}return t.prototype.reset=function(){if(!Ta.isSerializableHash(this._inner)||!Ta.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ta.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ta.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(t){return this._inner.update(t),this},t.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},t.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},t.prototype.saveState=function(){if(!Ta.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(t){if(!Ta.isSerializableHash(this._inner)||!Ta.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(t){if(!Ta.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},t}();xa.HMAC=Ua;function $a(t,e,r){var i=new Ua(t,e);i.update(r);var n=i.digest();return i.clean(),n}xa.hmac=$a,xa.equal=Ra.equal,Object.defineProperty(Aa,"__esModule",{value:!0});var Da=xa,Ca=fn,ka=function(){function t(t,e,r,i){r===void 0&&(r=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var n=Da.hmac(this._hash,r,e);this._hmac=new Da.HMAC(t,n),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(t){for(var e=new Uint8Array(t),r=0;r<e.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),e[r]=this._buffer[this._bufpos++];return e},t.prototype.clean=function(){this._hmac.clean(),Ca.wipe(this._buffer),Ca.wipe(this._counter),this._bufpos=0},t}(),La=Aa.HKDF=ka,Fa={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=gn,r=fn;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function i(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return i.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},i.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},i.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},i.prototype.update=function(t,e){if(e===void 0&&(e=t.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=e,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&e>0;)this._buffer[this._bufferLength++]=t[r++],e--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(e>=this.blockSize&&(r=s(this._temp,this._state,t,r,e),e%=this.blockSize);e>0;)this._buffer[this._bufferLength++]=t[r++],e--;return this},i.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,i=this._bufferLength,n=r/536870912|0,o=r<<3,a=r%64<56?64:128;this._buffer[i]=128;for(var c=i+1;c<a-8;c++)this._buffer[c]=0;e.writeUint32BE(n,this._buffer,a-8),e.writeUint32BE(o,this._buffer,a-4),s(this._temp,this._state,this._buffer,0,a),this._finished=!0}for(var c=0;c<this.digestLength/4;c++)e.writeUint32BE(this._state[c],t,c*4);return this},i.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},i.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},i.prototype.restoreState=function(t){return this._state.set(t.state),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},i.prototype.cleanSavedState=function(t){r.wipe(t.state),t.buffer&&r.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},i}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(t,r,i,s,o){for(;o>=64;){for(var a=r[0],c=r[1],h=r[2],u=r[3],f=r[4],l=r[5],d=r[6],p=r[7],w=0;w<16;w++){var y=s+w*4;t[w]=e.readUint32BE(i,y)}for(var w=16;w<64;w++){var v=t[w-2],b=(v>>>17|v<<32-17)^(v>>>19|v<<32-19)^v>>>10;v=t[w-15];var m=(v>>>7|v<<32-7)^(v>>>18|v<<32-18)^v>>>3;t[w]=(b+t[w-7]|0)+(m+t[w-16]|0)}for(var w=0;w<64;w++){var b=(((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&l^~f&d)|0)+(p+(n[w]+t[w]|0)|0)|0,m=((a>>>2|a<<32-2)^(a>>>13|a<<32-13)^(a>>>22|a<<32-22))+(a&c^a&h^c&h)|0;p=d,d=l,l=f,f=u+b|0,u=h,h=c,c=a,a=b+m|0}r[0]+=a,r[1]+=c,r[2]+=h,r[3]+=u,r[4]+=f,r[5]+=l,r[6]+=d,r[7]+=p,s+=64,o-=64}return s}function o(t){var e=new i;e.update(t);var r=e.digest();return e.clean(),r}t.hash=o})(Fa);var Va={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=nn,r=fn;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(t){const e=new Float64Array(16);if(t)for(let r=0;r<t.length;r++)e[r]=t[r];return e}const n=new Uint8Array(32);n[0]=9;const s=i([56129,1]);function o(t){let e=1;for(let r=0;r<16;r++){let i=t[r]+e+65535;e=Math.floor(i/65536),t[r]=i-e*65536}t[0]+=e-1+37*(e-1)}function a(t,e,r){const i=~(r-1);for(let r=0;r<16;r++){const n=i&(t[r]^e[r]);t[r]^=n,e[r]^=n}}function c(t,e){const r=i(),n=i();for(let t=0;t<16;t++)n[t]=e[t];o(n),o(n),o(n);for(let t=0;t<2;t++){r[0]=n[0]-65517;for(let t=1;t<15;t++)r[t]=n[t]-65535-(r[t-1]>>16&1),r[t-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const t=r[15]>>16&1;r[14]&=65535,a(n,r,1-t)}for(let e=0;e<16;e++)t[2*e]=n[e]&255,t[2*e+1]=n[e]>>8}function h(t,e){for(let r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function u(t,e,r){for(let i=0;i<16;i++)t[i]=e[i]+r[i]}function f(t,e,r){for(let i=0;i<16;i++)t[i]=e[i]-r[i]}function l(t,e,r){let i,n,s=0,o=0,a=0,c=0,h=0,u=0,f=0,l=0,d=0,p=0,w=0,y=0,v=0,b=0,m=0,_=0,g=0,E=0,O=0,j=0,S=0,I=0,A=0,x=0,N=0,M=0,T=0,R=0,P=0,U=0,$=0,D=r[0],C=r[1],k=r[2],L=r[3],F=r[4],V=r[5],q=r[6],G=r[7],K=r[8],B=r[9],z=r[10],W=r[11],H=r[12],J=r[13],X=r[14],Y=r[15];i=e[0],s+=i*D,o+=i*C,a+=i*k,c+=i*L,h+=i*F,u+=i*V,f+=i*q,l+=i*G,d+=i*K,p+=i*B,w+=i*z,y+=i*W,v+=i*H,b+=i*J,m+=i*X,_+=i*Y,i=e[1],o+=i*D,a+=i*C,c+=i*k,h+=i*L,u+=i*F,f+=i*V,l+=i*q,d+=i*G,p+=i*K,w+=i*B,y+=i*z,v+=i*W,b+=i*H,m+=i*J,_+=i*X,g+=i*Y,i=e[2],a+=i*D,c+=i*C,h+=i*k,u+=i*L,f+=i*F,l+=i*V,d+=i*q,p+=i*G,w+=i*K,y+=i*B,v+=i*z,b+=i*W,m+=i*H,_+=i*J,g+=i*X,E+=i*Y,i=e[3],c+=i*D,h+=i*C,u+=i*k,f+=i*L,l+=i*F,d+=i*V,p+=i*q,w+=i*G,y+=i*K,v+=i*B,b+=i*z,m+=i*W,_+=i*H,g+=i*J,E+=i*X,O+=i*Y,i=e[4],h+=i*D,u+=i*C,f+=i*k,l+=i*L,d+=i*F,p+=i*V,w+=i*q,y+=i*G,v+=i*K,b+=i*B,m+=i*z,_+=i*W,g+=i*H,E+=i*J,O+=i*X,j+=i*Y,i=e[5],u+=i*D,f+=i*C,l+=i*k,d+=i*L,p+=i*F,w+=i*V,y+=i*q,v+=i*G,b+=i*K,m+=i*B,_+=i*z,g+=i*W,E+=i*H,O+=i*J,j+=i*X,S+=i*Y,i=e[6],f+=i*D,l+=i*C,d+=i*k,p+=i*L,w+=i*F,y+=i*V,v+=i*q,b+=i*G,m+=i*K,_+=i*B,g+=i*z,E+=i*W,O+=i*H,j+=i*J,S+=i*X,I+=i*Y,i=e[7],l+=i*D,d+=i*C,p+=i*k,w+=i*L,y+=i*F,v+=i*V,b+=i*q,m+=i*G,_+=i*K,g+=i*B,E+=i*z,O+=i*W,j+=i*H,S+=i*J,I+=i*X,A+=i*Y,i=e[8],d+=i*D,p+=i*C,w+=i*k,y+=i*L,v+=i*F,b+=i*V,m+=i*q,_+=i*G,g+=i*K,E+=i*B,O+=i*z,j+=i*W,S+=i*H,I+=i*J,A+=i*X,x+=i*Y,i=e[9],p+=i*D,w+=i*C,y+=i*k,v+=i*L,b+=i*F,m+=i*V,_+=i*q,g+=i*G,E+=i*K,O+=i*B,j+=i*z,S+=i*W,I+=i*H,A+=i*J,x+=i*X,N+=i*Y,i=e[10],w+=i*D,y+=i*C,v+=i*k,b+=i*L,m+=i*F,_+=i*V,g+=i*q,E+=i*G,O+=i*K,j+=i*B,S+=i*z,I+=i*W,A+=i*H,x+=i*J,N+=i*X,M+=i*Y,i=e[11],y+=i*D,v+=i*C,b+=i*k,m+=i*L,_+=i*F,g+=i*V,E+=i*q,O+=i*G,j+=i*K,S+=i*B,I+=i*z,A+=i*W,x+=i*H,N+=i*J,M+=i*X,T+=i*Y,i=e[12],v+=i*D,b+=i*C,m+=i*k,_+=i*L,g+=i*F,E+=i*V,O+=i*q,j+=i*G,S+=i*K,I+=i*B,A+=i*z,x+=i*W,N+=i*H,M+=i*J,T+=i*X,R+=i*Y,i=e[13],b+=i*D,m+=i*C,_+=i*k,g+=i*L,E+=i*F,O+=i*V,j+=i*q,S+=i*G,I+=i*K,A+=i*B,x+=i*z,N+=i*W,M+=i*H,T+=i*J,R+=i*X,P+=i*Y,i=e[14],m+=i*D,_+=i*C,g+=i*k,E+=i*L,O+=i*F,j+=i*V,S+=i*q,I+=i*G,A+=i*K,x+=i*B,N+=i*z,M+=i*W,T+=i*H,R+=i*J,P+=i*X,U+=i*Y,i=e[15],_+=i*D,g+=i*C,E+=i*k,O+=i*L,j+=i*F,S+=i*V,I+=i*q,A+=i*G,x+=i*K,N+=i*B,M+=i*z,T+=i*W,R+=i*H,P+=i*J,U+=i*X,$+=i*Y,s+=38*g,o+=38*E,a+=38*O,c+=38*j,h+=38*S,u+=38*I,f+=38*A,l+=38*x,d+=38*N,p+=38*M,w+=38*T,y+=38*R,v+=38*P,b+=38*U,m+=38*$,n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,s+=n-1+37*(n-1),n=1,i=s+n+65535,n=Math.floor(i/65536),s=i-n*65536,i=o+n+65535,n=Math.floor(i/65536),o=i-n*65536,i=a+n+65535,n=Math.floor(i/65536),a=i-n*65536,i=c+n+65535,n=Math.floor(i/65536),c=i-n*65536,i=h+n+65535,n=Math.floor(i/65536),h=i-n*65536,i=u+n+65535,n=Math.floor(i/65536),u=i-n*65536,i=f+n+65535,n=Math.floor(i/65536),f=i-n*65536,i=l+n+65535,n=Math.floor(i/65536),l=i-n*65536,i=d+n+65535,n=Math.floor(i/65536),d=i-n*65536,i=p+n+65535,n=Math.floor(i/65536),p=i-n*65536,i=w+n+65535,n=Math.floor(i/65536),w=i-n*65536,i=y+n+65535,n=Math.floor(i/65536),y=i-n*65536,i=v+n+65535,n=Math.floor(i/65536),v=i-n*65536,i=b+n+65535,n=Math.floor(i/65536),b=i-n*65536,i=m+n+65535,n=Math.floor(i/65536),m=i-n*65536,i=_+n+65535,n=Math.floor(i/65536),_=i-n*65536,s+=n-1+37*(n-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=h,t[5]=u,t[6]=f,t[7]=l,t[8]=d,t[9]=p,t[10]=w,t[11]=y,t[12]=v,t[13]=b,t[14]=m,t[15]=_}function d(t,e){l(t,e,e)}function p(t,e){const r=i();for(let t=0;t<16;t++)r[t]=e[t];for(let t=253;t>=0;t--)d(r,r),t!==2&&t!==4&&l(r,r,e);for(let e=0;e<16;e++)t[e]=r[e]}function w(t,e){const r=new Uint8Array(32),n=new Float64Array(80),o=i(),w=i(),y=i(),v=i(),b=i(),m=i();for(let e=0;e<31;e++)r[e]=t[e];r[31]=t[31]&127|64,r[0]&=248,h(n,e);for(let t=0;t<16;t++)w[t]=n[t];o[0]=v[0]=1;for(let t=254;t>=0;--t){const e=r[t>>>3]>>>(t&7)&1;a(o,w,e),a(y,v,e),u(b,o,y),f(o,o,y),u(y,w,v),f(w,w,v),d(v,b),d(m,o),l(o,y,o),l(y,w,b),u(b,o,y),f(o,o,y),d(w,o),f(y,v,m),l(o,y,s),u(o,o,v),l(y,y,o),l(o,v,m),l(v,w,n),d(w,b),a(o,w,e),a(y,v,e)}for(let t=0;t<16;t++)n[t+16]=o[t],n[t+32]=y[t],n[t+48]=w[t],n[t+64]=v[t];const _=n.subarray(32),g=n.subarray(16);p(_,_),l(g,g,_);const E=new Uint8Array(32);return c(E,g),E}t.scalarMult=w;function y(t){return w(t,n)}t.scalarMultBase=y;function v(e){if(e.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const r=new Uint8Array(e);return{publicKey:y(r),secretKey:r}}t.generateKeyPairFromSeed=v;function b(t){const i=(0,e.randomBytes)(32,t),n=v(i);return(0,r.wipe)(i),n}t.generateKeyPair=b;function m(e,r,i=!1){if(e.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(r.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const n=w(e,r);if(i){let t=0;for(let e=0;e<n.length;e++)t|=n[e];if(t===0)throw new Error("X25519: invalid shared key")}return n}t.sharedKey=m})(Va);var qa=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},Ga=function(){function t(t,e,r){this.name=t,this.version=e,this.os=r,this.type="browser"}return t}(),Ka=function(){function t(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return t}(),Ba=function(){function t(t,e,r,i){this.name=t,this.version=e,this.os=r,this.bot=i,this.type="bot-device"}return t}(),za=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Wa=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Ha=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Ja=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Xa=3,Ya=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Ha]],Za=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Qa(t){return t?ec(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Wa:typeof navigator<"u"?ec(navigator.userAgent):ic()}function tc(t){return t!==""&&Ya.reduce((function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]}),!1)}function ec(t){var e=tc(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new za;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Xa&&(n=qa(qa([],n,!0),nc(Xa-n.length),!0)):n=[];var s=n.join("."),o=rc(t),a=Ja.exec(t);return a&&a[1]?new Ba(r,s,o,a[1]):new Ga(r,s,o)}function rc(t){for(var e=0,r=Za.length;e<r;e++){var i=Za[e],n=i[0],s=i[1],o=s.exec(t);if(o)return n}return null}function ic(){var t=typeof process<"u"&&process.version;return t?new Ka(process.version.slice(1)):null}function nc(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var sc={};Object.defineProperty(sc,"__esModule",{value:!0}),sc.getLocalStorage=sc.getLocalStorageOrThrow=sc.getCrypto=sc.getCryptoOrThrow=yc=sc.getLocation=sc.getLocationOrThrow=dc=sc.getNavigator=sc.getNavigatorOrThrow=uc=sc.getDocument=sc.getDocumentOrThrow=sc.getFromWindowOrThrow=sc.getFromWindow=void 0;function oc(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}sc.getFromWindow=oc;function ac(t){const e=oc(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}sc.getFromWindowOrThrow=ac;function cc(){return ac("document")}sc.getDocumentOrThrow=cc;function hc(){return oc("document")}var uc=sc.getDocument=hc;function fc(){return ac("navigator")}sc.getNavigatorOrThrow=fc;function lc(){return oc("navigator")}var dc=sc.getNavigator=lc;function pc(){return ac("location")}sc.getLocationOrThrow=pc;function wc(){return oc("location")}var yc=sc.getLocation=wc;function vc(){return ac("crypto")}sc.getCryptoOrThrow=vc;function bc(){return oc("crypto")}sc.getCrypto=bc;function mc(){return ac("localStorage")}sc.getLocalStorageOrThrow=mc;function _c(){return oc("localStorage")}sc.getLocalStorage=_c;var gc={};Object.defineProperty(gc,"__esModule",{value:!0});var Ec=gc.getWindowMetadata=void 0;const Oc=sc;function jc(){let t,e;try{t=Oc.getDocumentOrThrow(),e=Oc.getLocationOrThrow()}catch{return null}function r(){const r=t.getElementsByTagName("link"),i=[];for(let t=0;t<r.length;t++){const n=r[t],s=n.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const t=n.getAttribute("href");if(t)if(t.toLowerCase().indexOf("https:")===-1&&t.toLowerCase().indexOf("http:")===-1&&t.indexOf("//")!==0){let r=e.protocol+"//"+e.host;if(t.indexOf("/")===0)r+=t;else{const i=e.pathname.split("/");i.pop();const n=i.join("/");r+=n+"/"+t}i.push(r)}else if(t.indexOf("//")===0){const r=e.protocol+t;i.push(r)}else i.push(t)}}return i}function i(...e){const r=t.getElementsByTagName("meta");for(let t=0;t<r.length;t++){const i=r[t],n=["itemprop","property","name"].map((t=>i.getAttribute(t))).filter((t=>t?e.includes(t):!1));if(n.length&&n){const t=i.getAttribute("content");if(t)return t}}return""}function n(){let e=i("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}function s(){return i("description","og:description","twitter:description","keywords")}const o=n(),a=s(),c=e.origin,h=r();return{description:a,url:c,icons:h,name:o}}Ec=gc.getWindowMetadata=jc;var Sc={},Ic=t=>encodeURIComponent(t).replace(/[!'()*]/g,(t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)),Ac="%[a-f0-9]{2}",xc=new RegExp(Ac,"gi"),Nc=new RegExp("("+Ac+")+","gi");function Mc(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Mc(r),Mc(i))}function Tc(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(xc),r=1;r<e.length;r++)t=Mc(e,r).join(""),e=t.match(xc);return t}}function Rc(t){for(var e={"%FE%FF":"","%FF%FE":""},r=Nc.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Tc(r[0]);i!==r[0]&&(e[r[0]]=i)}r=Nc.exec(t)}e["%C2"]="";for(var n=Object.keys(e),s=0;s<n.length;s++){var o=n[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var Pc=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Rc(t)}},Uc=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},$c=function(t,e){for(var r={},i=Object.keys(t),n=Array.isArray(e),s=0;s<i.length;s++){var o=i[s],a=t[o];(n?e.indexOf(o)!==-1:e(o,a,t))&&(r[o]=a)}return r};(function(t){const e=Ic,r=Pc,i=Uc,n=$c,s=t=>t==null,o=Symbol("encodeFragmentIdentifier");function a(t){switch(t.arrayFormat){case"index":return e=>(r,i)=>{const n=r.length;return i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?r:i===null?[...r,[u(e,t),"[",n,"]"].join("")]:[...r,[u(e,t),"[",u(n,t),"]=",u(i,t)].join("")]};case"bracket":return e=>(r,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?r:i===null?[...r,[u(e,t),"[]"].join("")]:[...r,[u(e,t),"[]=",u(i,t)].join("")];case"colon-list-separator":return e=>(r,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?r:i===null?[...r,[u(e,t),":list="].join("")]:[...r,[u(e,t),":list=",u(i,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return r=>(i,n)=>n===void 0||t.skipNull&&n===null||t.skipEmptyString&&n===""?i:(n=n===null?"":n,i.length===0?[[u(r,t),e,u(n,t)].join("")]:[[i,u(n,t)].join(t.arrayFormatSeparator)])}default:return e=>(r,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?r:i===null?[...r,u(e,t)]:[...r,[u(e,t),"=",u(i,t)].join("")]}}function c(t){let e;switch(t.arrayFormat){case"index":return(t,r,i)=>{if(e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),!e){i[t]=r;return}i[t]===void 0&&(i[t]={}),i[t][e[1]]=r};case"bracket":return(t,r,i)=>{if(e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[].concat(i[t],r)};case"colon-list-separator":return(t,r,i)=>{if(e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[].concat(i[t],r)};case"comma":case"separator":return(e,r,i)=>{const n=typeof r=="string"&&r.includes(t.arrayFormatSeparator),s=typeof r=="string"&&!n&&f(r,t).includes(t.arrayFormatSeparator);r=s?f(r,t):r;const o=n||s?r.split(t.arrayFormatSeparator).map((e=>f(e,t))):r===null?r:f(r,t);i[e]=o};case"bracket-separator":return(e,r,i)=>{const n=/(\[\])$/.test(e);if(e=e.replace(/\[\]$/,""),!n){i[e]=r&&f(r,t);return}const s=r===null?[]:r.split(t.arrayFormatSeparator).map((e=>f(e,t)));if(i[e]===void 0){i[e]=s;return}i[e]=[].concat(i[e],s)};default:return(t,e,r)=>{if(r[t]===void 0){r[t]=e;return}r[t]=[].concat(r[t],e)}}}function h(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function u(t,r){return r.encode?r.strict?e(t):encodeURIComponent(t):t}function f(t,e){return e.decode?r(t):t}function l(t){return Array.isArray(t)?t.sort():typeof t=="object"?l(Object.keys(t)).sort(((t,e)=>Number(t)-Number(e))).map((e=>t[e])):t}function d(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function p(t){let e="";const r=t.indexOf("#");return r!==-1&&(e=t.slice(r)),e}function w(t){t=d(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function y(t,e){return e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?t=Number(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")&&(t=t.toLowerCase()==="true"),t}function v(t,e){e=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},e),h(e.arrayFormatSeparator);const r=c(e),n=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return n;for(const s of t.split("&")){if(s==="")continue;let[t,o]=i(e.decode?s.replace(/\+/g," "):s,"=");o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:f(o,e),r(f(t,e),o,n)}for(const t of Object.keys(n)){const r=n[t];if(typeof r=="object"&&r!==null)for(const t of Object.keys(r))r[t]=y(r[t],e);else n[t]=y(r,e)}return e.sort===!1?n:(e.sort===!0?Object.keys(n).sort():Object.keys(n).sort(e.sort)).reduce(((t,e)=>{const r=n[e];return Boolean(r)&&typeof r=="object"&&!Array.isArray(r)?t[e]=l(r):t[e]=r,t}),Object.create(null))}t.extract=w,t.parse=v,t.stringify=(t,e)=>{if(!t)return"";e=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},e),h(e.arrayFormatSeparator);const r=r=>e.skipNull&&s(t[r])||e.skipEmptyString&&t[r]==="",i=a(e),n={};for(const e of Object.keys(t))r(e)||(n[e]=t[e]);const o=Object.keys(n);return e.sort!==!1&&o.sort(e.sort),o.map((r=>{const n=t[r];return n===void 0?"":n===null?u(r,e):Array.isArray(n)?n.length===0&&e.arrayFormat==="bracket-separator"?u(r,e)+"[]":n.reduce(i(r),[]).join("&"):u(r,e)+"="+u(n,e)})).filter((t=>t.length>0)).join("&")},t.parseUrl=(t,e)=>{e=Object.assign({decode:!0},e);const[r,n]=i(t,"#");return Object.assign({url:r.split("?")[0]||"",query:v(w(t),e)},e&&e.parseFragmentIdentifier&&n?{fragmentIdentifier:f(n,e)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0,[o]:!0},r);const i=d(e.url).split("?")[0]||"",n=t.extract(e.url),s=t.parse(n,{sort:!1}),a=Object.assign(s,e.query);let c=t.stringify(a,r);c&&(c=`?${c}`);let h=p(e.url);return e.fragmentIdentifier&&(h=`#${r[o]?u(e.fragmentIdentifier,r):e.fragmentIdentifier}`),`${i}${c}${h}`},t.pick=(e,r,i)=>{i=Object.assign({parseFragmentIdentifier:!0,[o]:!1},i);const{url:s,query:a,fragmentIdentifier:c}=t.parseUrl(e,i);return t.stringifyUrl({url:s,query:n(a,r),fragmentIdentifier:c},i)},t.exclude=(e,r,i)=>{const n=Array.isArray(r)?t=>!r.includes(t):(t,e)=>!r(t,e);return t.pick(e,n,i)}})(Sc);const Dc={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},Cc="base10",kc="base16",Lc="base64pad",Fc="utf8",Vc=0,qc=1,Gc=0,Kc=1,Bc=12,zc=32;function Wc(){const t=Va.generateKeyPair();return{privateKey:ia(t.secretKey,kc),publicKey:ia(t.publicKey,kc)}}function Hc(){const t=nn.randomBytes(zc);return ia(t,kc)}function Jc(t,e){const r=Va.sharedKey(na(t,kc),na(e,kc)),i=new La(Fa.SHA256,r).expand(zc);return ia(i,kc)}function Xc(t){const e=Fa.hash(na(t,kc));return ia(e,kc)}function Yc(t){const e=Fa.hash(na(t,Fc));return ia(e,kc)}function Zc(t){return na(`${t}`,Cc)}function Qc(t){return Number(ia(t,Cc))}function th(t){const e=Zc(typeof t.type<"u"?t.type:Vc);if(Qc(e)===qc&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?na(t.senderPublicKey,kc):void 0,i=typeof t.iv<"u"?na(t.iv,kc):nn.randomBytes(Bc),n=new la.ChaCha20Poly1305(na(t.symKey,kc)).seal(i,na(t.message,Fc));return rh({type:e,sealed:n,iv:i,senderPublicKey:r})}function eh(t){const e=new la.ChaCha20Poly1305(na(t.symKey,kc)),{sealed:r,iv:i}=ih(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return ia(n,Fc)}function rh(t){if(Qc(t.type)===qc){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ia(ws([t.type,t.senderPublicKey,t.iv,t.sealed]),Lc)}return ia(ws([t.type,t.iv,t.sealed]),Lc)}function ih(t){const e=na(t,Lc),r=e.slice(Gc,Kc),i=Kc;if(Qc(r)===qc){const t=i+zc,n=t+Bc,s=e.slice(i,t),o=e.slice(t,n),a=e.slice(n);return{type:r,sealed:a,iv:o,senderPublicKey:s}}const n=i+Bc,s=e.slice(i,n),o=e.slice(n);return{type:r,sealed:o,iv:s}}function nh(t,e){const r=ih(t);return sh({type:Qc(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ia(r.senderPublicKey,kc):void 0,receiverPublicKey:e?.receiverPublicKey})}function sh(t){const e=t?.type||Vc;if(e===qc){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function oh(t){return t.type===qc&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var ah=Object.defineProperty,ch=Object.getOwnPropertySymbols,hh=Object.prototype.hasOwnProperty,uh=Object.prototype.propertyIsEnumerable,fh=(t,e,r)=>e in t?ah(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lh=(t,e)=>{for(var r in e||(e={}))hh.call(e,r)&&fh(t,r,e[r]);if(ch)for(var r of ch(e))uh.call(e,r)&&fh(t,r,e[r]);return t};const dh="ReactNative",ph={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},wh="js";function yh(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function vh(){return!uc()&&!!dc()&&navigator.product===dh}function bh(){return!yh()&&!!dc()}function mh(){return vh()?ph.reactNative:yh()?ph.node:bh()?ph.browser:ph.unknown}function _h(t,e){let r=Sc.parse(t);return r=lh(lh({},r),e),t=Sc.stringify(r),t}function gh(){return Ec()||{name:"",description:"",url:"",icons:[""]}}function Eh(){const t=Qa();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Oh(){var t;const e=mh();return e===ph.browser?[e,((t=yc())==null?void 0:t.host)||"unknown"].join(":"):e}function jh(t,e,r){const i=Eh(),n=Oh();return[[t,e].join("-"),[wh,r].join("-"),i,n].join("/")}function Sh({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s}){const o=r.split("?"),a=jh(t,e,i),c={auth:n,ua:a,projectId:s},h=_h(o[1]||"",c);return o[0]+"?"+h}function Ih(t,e){return t.filter((t=>e.includes(t))).length===t.length}function Ah(t){return Object.fromEntries(t.entries())}function xh(t){return new Map(Object.entries(t))}function Nh(t,e){return Ae.fromMiliseconds((e||Date.now())+Ae.toMiliseconds(t))}function Mh(t){return Ae.fromMiliseconds(Date.now())>=Ae.toMiliseconds(t)}function Th(){const t=Ae.toMiliseconds(Ae.FIVE_MINUTES);let e,r,i;return{resolve:t=>{i&&e&&(clearTimeout(i),e(t))},reject:t=>{i&&r&&(clearTimeout(i),r(t))},done:()=>new Promise(((n,s)=>{i=setTimeout(s,t),e=n,r=s}))}}function Rh(t,e){return new Promise((async(r,i)=>{const n=setTimeout((()=>i()),e),s=await t;clearTimeout(n),r(s)}))}function Ph(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Uh(t){return Ph("topic",t)}function $h(t){return Ph("id",t)}function Dh(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Ch(t,e){return`${t}${e?`:${e}`:""}`}const kh="irn";function Lh(t){return t?.relay||{protocol:kh}}function Fh(t){const e=Dc[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Vh=Object.defineProperty,qh=Object.getOwnPropertySymbols,Gh=Object.prototype.hasOwnProperty,Kh=Object.prototype.propertyIsEnumerable,Bh=(t,e,r)=>e in t?Vh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zh=(t,e)=>{for(var r in e||(e={}))Gh.call(e,r)&&Bh(t,r,e[r]);if(qh)for(var r of qh(e))Kh.call(e,r)&&Bh(t,r,e[r]);return t};function Wh(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach((e=>{if(e.startsWith(i)){const n=e.replace(i,""),s=t[e];r[n]=s}})),r}function Hh(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Sc.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:o.symKey,relay:Wh(o)}}function Jh(t,e="-"){const r="relay",i={};return Object.keys(t).forEach((n=>{const s=r+e+n;t[n]&&(i[s]=t[n])})),i}function Xh(t){return`${t.protocol}:${t.topic}@${t.version}?`+Sc.stringify(zh({symKey:t.symKey},Jh(t.relay)))}function Yh(t){const e=[];return t.forEach((t=>{const[r,i]=t.split(":");e.push(`${r}:${i}`)})),e}function Zh(t){const e=[];return Object.values(t).forEach((t=>{e.push(...Yh(t.accounts)),t.extension&&t.extension.forEach((t=>{e.push(...Yh(t.accounts))}))})),e}function Qh(t,e){const r=[];return Object.values(t).forEach((t=>{Yh(t.accounts).includes(e)&&r.push(...t.methods),t.extension&&t.extension.forEach((t=>{Yh(t.accounts).includes(e)&&r.push(...t.methods)}))})),r}function tu(t,e){const r=[];return Object.values(t).forEach((t=>{Yh(t.accounts).includes(e)&&r.push(...t.events),t.extension&&t.extension.forEach((t=>{Yh(t.accounts).includes(e)&&r.push(...t.events)}))})),r}const eu={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ru={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function iu(t,e){const{message:r,code:i}=ru[t];return{message:e?`${r} ${e}`:r,code:i}}function nu(t,e){const{message:r,code:i}=eu[t];return{message:e?`${r} ${e}`:r,code:i}}function su(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function ou(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function au(t){return typeof t>"u"}function cu(t,e){return e&&au(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function hu(t,e){return e&&au(t)?!0:typeof t=="number"&&!isNaN(t)}function uu(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return Ih(n,i)?(i.forEach((e=>{const{accounts:i,methods:n,events:o,extension:a}=t.namespaces[e],c=Yh(i),h=r[e];(!Ih(h.chains,c)||!Ih(h.methods,n)||!Ih(h.events,o))&&(s=!1),s&&a&&a.forEach((t=>{var e;const{accounts:r,methods:i,events:n}=t,o=Yh(r);(e=h.extension)!=null&&e.find((t=>Ih(t.chains,o)&&Ih(t.methods,i)&&Ih(t.events,n)))||(s=!1)}))})),s):!1}function fu(t){return cu(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function lu(t){if(cu(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&fu(t)}}return!1}function du(t){if(cu(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function pu(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function wu(t){return t?.topic}function yu(t,e){let r=null;return cu(t?.publicKey,!1)||(r=iu("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function vu(t,e){let r=null;return au(t?.extension)||(!su(t.extension)||!t.extension.length)&&(r=iu("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function bu(t){let e=!0;return su(t)?t.length&&(e=t.every((t=>cu(t,!1)))):e=!1,e}function mu(t,e,r){let i=null;return su(e)?e.forEach((e=>{i||(!fu(e)||!e.includes(t))&&(i=nu("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))})):i=nu("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function _u(t,e){let r=null;return Object.entries(t).forEach((([t,i])=>{if(r)return;const n=mu(t,i?.chains,`${e} requiredNamespace`),s=vu(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach((i=>{if(r)return;const n=mu(t,i.chains,`${e} extension`);n&&(r=n)}))})),r}function gu(t,e){let r=null;return su(t)?t.forEach((t=>{r||lu(t)||(r=nu("UNSUPPORTED_ACCOUNTS",`${e}, account ${t} should be a string and conform to "namespace:chainId:address" format`))})):r=nu("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Eu(t,e){let r=null;return Object.values(t).forEach((t=>{if(r)return;const i=gu(t?.accounts,`${e} namespace`),n=vu(t,e);i?r=i:n?r=n:t.extension&&t.extension.forEach((t=>{if(r)return;const i=gu(t.accounts,`${e} extension`);i&&(r=i)}))})),r}function Ou(t,e){let r=null;return bu(t?.methods)?bu(t?.events)||(r=nu("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=nu("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function ju(t,e){let r=null;return Object.values(t).forEach((t=>{if(r)return;const i=Ou(t,`${e}, namespace`),n=vu(t,e);i?r=i:n?r=n:t.extension&&t.extension.forEach((t=>{if(r)return;const i=Ou(t,`${e}, extension`);i&&(r=i)}))})),r}function Su(t,e){let r=null;if(t&&ou(t)){const i=ju(t,e);i&&(r=i);const n=_u(t,e);n&&(r=n)}else r=iu("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function Iu(t,e){let r=null;if(t&&ou(t)){const i=ju(t,e);i&&(r=i);const n=Eu(t,e);n&&(r=n)}else r=iu("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Au(t){return cu(t.protocol,!0)}function xu(t,e){let r=!1;return e&&!t?r=!0:t&&su(t)&&t.length&&t.forEach((t=>{r=Au(t)})),r}function Nu(t){return typeof t=="number"}function Mu(t){return typeof t<"u"&&typeof t!==null}function Tu(t){return!(!t||typeof t!="object"||!t.code||!hu(t.code,!1)||!t.message||!cu(t.message,!1))}function Ru(t){return!(au(t)||!cu(t.method,!1))}function Pu(t){return!(au(t)||au(t.result)&&au(t.error)||!hu(t.id,!1)||!cu(t.jsonrpc,!1))}function Uu(t){return!(au(t)||!cu(t.name,!1))}function $u(t,e){return!(!fu(e)||!Zh(t).includes(e))}function Du(t,e,r){return cu(r,!1)?Qh(t,e).includes(r):!1}function Cu(t,e,r){return cu(r,!1)?tu(t,e).includes(r):!1}function ku(t,e,r){let i=null;const n=Object.keys(t),s=Object.keys(e);return Ih(n,s)?n.forEach((n=>{var s;if(i)return;const o=t[n].chains,a=Yh(e[n].accounts);Ih(o,a)?Ih(t[n].methods,e[n].methods)?Ih(t[n].events,e[n].events)?t[n].extension&&!e[n].extension?i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${n}`):t[n].extension&&e[n].extension&&((s=t[n].extension)==null||s.forEach((({methods:t,events:s,chains:o})=>{var a;i||(a=e[n].extension)!=null&&a.find((e=>{const r=Yh(e.accounts);return Ih(o,r)&&Ih(s,e.events)&&Ih(t,e.methods)}))||(i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${n}`))}))):i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${n}`):i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${n}`):i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${n}`)})):i=iu("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}const Lu="PARSE_ERROR",Fu="INVALID_REQUEST",Vu="METHOD_NOT_FOUND",qu="INVALID_PARAMS",Gu="INTERNAL_ERROR",Ku="SERVER_ERROR",Bu=[-32700,-32600,-32601,-32602,-32603],zu={[Lu]:{code:-32700,message:"Parse error"},[Fu]:{code:-32600,message:"Invalid Request"},[Vu]:{code:-32601,message:"Method not found"},[qu]:{code:-32602,message:"Invalid params"},[Gu]:{code:-32603,message:"Internal error"},[Ku]:{code:-32e3,message:"Server error"}},Wu=Ku;function Hu(t){return Bu.includes(t)}function Ju(t){return Object.keys(zu).includes(t)?zu[t]:zu[Wu]}function Xu(t){const e=Object.values(zu).find((e=>e.code===t));return e||zu[Wu]}function Yu(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Zu={};
/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Qu=function(t,e){return Qu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Qu(t,e)};function tf(t,e){Qu(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ef=function(){return ef=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},ef.apply(this,arguments)};function rf(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function nf(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(n<3?o(s):n>3?o(e,r,s):o(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function sf(t,e){return function(r,i){e(r,i,t)}}function of(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function af(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))}function cf(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(o){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=o[0]&2?n.return:o[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;switch(n=0,s&&(o=[o[0]&2,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return r.label++,{value:o[1],done:!1};case 5:r.label++,n=o[1],o=[0];continue;case 7:o=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1],s=o;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(o);break}s[2]&&r.ops.pop(),r.trys.pop();continue}o=e.call(t,r)}catch(t){o=[6,t],n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function hf(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function uf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ff(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lf(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],o;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function df(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(lf(arguments[e]));return t}function pf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,n++)i[n]=s[o];return i}function wf(t){return this instanceof wf?(this.v=t,this):new wf(t)}function yf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,i){s.push([t,e,r,i])>1||a(t,e)}))})}function a(t,e){try{c(i[t](e))}catch(t){f(s[0][3],t)}}function c(t){t.value instanceof wf?Promise.resolve(t.value.v).then(h,u):f(s[0][2],t)}function h(t){a("next",t)}function u(t){a("throw",t)}function f(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function vf(t){var e,r;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,n){e[i]=t[i]?function(e){return(r=!r)?{value:wf(t[i](e)),done:i==="return"}:n?n(e):e}:n}}function bf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ff=="function"?ff(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(e){r[e]=t[e]&&function(r){return new Promise((function(i,s){r=t[e](r),n(i,s,r.done,r.value)}))}}function n(t,e,r,i){Promise.resolve(i).then((function(e){t({value:e,done:r})}),e)}}function mf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _f(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function gf(t){return t&&t.__esModule?t:{default:t}}function Ef(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Of(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var jf=Object.freeze({__proto__:null,__extends:tf,get __assign(){return ef},__rest:rf,__decorate:nf,__param:sf,__metadata:of,__awaiter:af,__generator:cf,__createBinding:hf,__exportStar:uf,__values:ff,__read:lf,__spread:df,__spreadArrays:pf,__await:wf,__asyncGenerator:yf,__asyncDelegator:vf,__asyncValues:bf,__makeTemplateObject:mf,__importStar:_f,__importDefault:gf,__classPrivateFieldGet:Ef,__classPrivateFieldSet:Of}),Sf=s(jf),If={},Af;function xf(){if(Af)return If;Af=1,Object.defineProperty(If,"__esModule",{value:!0}),If.isBrowserCryptoAvailable=If.getSubtleCrypto=If.getBrowerCrypto=void 0;function t(){return r?.crypto||r?.msCrypto||{}}If.getBrowerCrypto=t;function e(){const e=t();return e.subtle||e.webkitSubtle}If.getSubtleCrypto=e;function i(){return!!t()&&!!e()}return If.isBrowserCryptoAvailable=i,If}var Nf={},Mf;function Tf(){if(Mf)return Nf;Mf=1,Object.defineProperty(Nf,"__esModule",{value:!0}),Nf.isBrowser=Nf.isNode=Nf.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Nf.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Nf.isNode=e;function r(){return!t()&&!e()}return Nf.isBrowser=r,Nf}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Sf;e.__exportStar(xf(),t),e.__exportStar(Tf(),t)})(Zu);function Rf(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function Pf(t,e,r){return{id:r||Rf(),jsonrpc:"2.0",method:t,params:e}}function Uf(t,e){return{id:t,jsonrpc:"2.0",result:e}}function $f(t,e,r){return{id:t,jsonrpc:"2.0",error:Df(e,r)}}function Df(t,e){return typeof t>"u"?Ju(Gu):(typeof t=="string"&&(t=Object.assign(Object.assign({},Ju(Ku)),{message:t})),typeof e<"u"&&(t.data=e),Hu(t.code)&&(t=Xu(t.code)),t)}class Cf{}class kf extends Cf{constructor(){super()}}class Lf extends kf{constructor(t){super()}}const Ff="^https?:",Vf="^wss?:";function qf(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Gf(t,e){const r=qf(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Kf(t){return Gf(t,Ff)}function Bf(t){return Gf(t,Vf)}function zf(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Wf(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Hf(t){return Wf(t)&&"method"in t}function Jf(t){return Wf(t)&&(Xf(t)||Yf(t))}function Xf(t){return"result"in t}function Yf(t){return"error"in t}class Zf extends Lf{constructor(t){super(t),this.events=new Ee.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async request(t,e){return this.requestStrict(Pf(t.method,t.params||[]),e)}async requestStrict(t,e){return new Promise((async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(t){i(t)}this.events.on(`${t.id}`,(t=>{Yf(t)?i(t.error):r(t.result)}));try{await this.connection.send(t,e)}catch(t){i(t)}}))}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Jf(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(t=>this.onPayload(t))),this.connection.on("close",(()=>this.events.emit("disconnect"))),this.connection.on("error",(t=>this.events.emit("error",t))),this.hasRegisteredEventListeners=!0)}}var Qf={exports:{}},tl=typeof Reflect=="object"?Reflect:null,el=tl&&typeof tl.apply=="function"?tl.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},rl;tl&&typeof tl.ownKeys=="function"?rl=tl.ownKeys:Object.getOwnPropertySymbols?rl=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:rl=function(t){return Object.getOwnPropertyNames(t)};function il(t){console&&console.warn&&console.warn(t)}var nl=Number.isNaN||function(t){return t!==t};function sl(){sl.init.call(this)}Qf.exports=sl,Qf.exports.once=vl,sl.EventEmitter=sl,sl.prototype._events=void 0,sl.prototype._eventsCount=0,sl.prototype._maxListeners=void 0;var ol=10;function al(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(sl,"defaultMaxListeners",{enumerable:!0,get:function(){return ol},set:function(t){if(typeof t!="number"||t<0||nl(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ol=t}}),sl.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},sl.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||nl(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function cl(t){return t._maxListeners===void 0?sl.defaultMaxListeners:t._maxListeners}sl.prototype.getMaxListeners=function(){return cl(this)},sl.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[t];if(a===void 0)return!1;if(typeof a=="function")el(a,this,e);else for(var c=a.length,h=pl(a,c),r=0;r<c;++r)el(h[r],this,e);return!0};function hl(t,e,r,i){var n,s,o;if(al(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=cl(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,il(a)}return t}sl.prototype.addListener=function(t,e){return hl(this,t,e,!1)},sl.prototype.on=sl.prototype.addListener,sl.prototype.prependListener=function(t,e){return hl(this,t,e,!0)};function ul(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function fl(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=ul.bind(i);return n.listener=r,i.wrapFn=n,n}sl.prototype.once=function(t,e){return al(e),this.on(t,fl(this,t,e)),this},sl.prototype.prependOnceListener=function(t,e){return al(e),this.prependListener(t,fl(this,t,e)),this},sl.prototype.removeListener=function(t,e){var r,i,n,s,o;if(al(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():wl(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},sl.prototype.off=sl.prototype.removeListener,sl.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function ll(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?yl(n):pl(n,n.length)}sl.prototype.listeners=function(t){return ll(this,t,!0)},sl.prototype.rawListeners=function(t){return ll(this,t,!1)},sl.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):dl.call(t,e)},sl.prototype.listenerCount=dl;function dl(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}sl.prototype.eventNames=function(){return this._eventsCount>0?rl(this._events):[]};function pl(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function wl(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function yl(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function vl(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}ml(t,e,s,{once:!0}),e!=="error"&&bl(t,n,{once:!0})}))}function bl(t,e,r){typeof t.on=="function"&&ml(t,"error",e,r)}function ml(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const _l=10,gl=()=>typeof e<"u"&&typeof e.WebSocket<"u"?e.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:i,El=()=>typeof window<"u",Ol=gl();class jl{constructor(t){if(this.url=t,this.events=new Qf.exports.EventEmitter,this.registering=!1,!Bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(t,e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(en(t))}catch(e){this.onError(t.id,e)}}register(t=this.url){if(!Bf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise(((t,e)=>{this.events.once("register_error",(t=>{this.resetMaxListeners(),e(t)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return e(new Error("WebSocket connection is missing or invalid"));t(this.socket)}))}))}return this.url=t,this.registering=!0,new Promise(((e,r)=>{const i=Zu.isReactNative()?void 0:{rejectUnauthorized:!zf(t)},n=new Ol(t,[],i);El()?n.onerror=t=>{const e=t;r(this.emitError(e.error))}:n.on("error",(t=>{r(this.emitError(t))})),n.onopen=()=>{this.onOpen(n),e(n)}}))}onOpen(t){t.onmessage=t=>this.onPayload(t),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?tn(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const r=this.parseError(e),i=r.message||r.toString(),n=$f(t,i);this.events.emit("payload",n)}parseError(t,e=this.url){return Yu(t,e,"WS")}resetMaxListeners(){this.events.getMaxListeners()>_l&&this.events.setMaxListeners(_l)}emitError(t){const e=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",e),e}}var Sl={exports:{}};(function(t,e){var i=200,n="__lodash_hash_undefined__",s=1,o=2,a=9007199254740991,c="[object Arguments]",h="[object Array]",u="[object AsyncFunction]",f="[object Boolean]",l="[object Date]",d="[object Error]",p="[object Function]",w="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Null]",m="[object Object]",_="[object Promise]",g="[object Proxy]",E="[object RegExp]",O="[object Set]",j="[object String]",S="[object Symbol]",I="[object Undefined]",A="[object WeakMap]",x="[object ArrayBuffer]",N="[object DataView]",M="[object Float32Array]",T="[object Float64Array]",R="[object Int8Array]",P="[object Int16Array]",U="[object Int32Array]",$="[object Uint8Array]",D="[object Uint8ClampedArray]",C="[object Uint16Array]",k="[object Uint32Array]",L=/[\\^$.*+?()[\]{}|]/g,F=/^\[object .+?Constructor\]$/,V=/^(?:0|[1-9]\d*)$/,q={};q[M]=q[T]=q[R]=q[P]=q[U]=q[$]=q[D]=q[C]=q[k]=!0,q[c]=q[h]=q[x]=q[f]=q[N]=q[l]=q[d]=q[p]=q[y]=q[v]=q[m]=q[E]=q[O]=q[j]=q[A]=!1;var G=typeof r=="object"&&r&&r.Object===Object&&r,K=typeof self=="object"&&self&&self.Object===Object&&self,B=G||K||Function("return this")(),z=e&&!e.nodeType&&e,W=z&&!0&&t&&!t.nodeType&&t,H=W&&W.exports===z,J=H&&G.process,X=function(){try{return J&&J.binding&&J.binding("util")}catch{}}(),Y=X&&X.isTypedArray;function Z(t,e){for(var r=-1,i=t==null?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}function Q(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}function tt(t,e){for(var r=-1,i=t==null?0:t.length;++r<i;)if(e(t[r],r,t))return!0;return!1}function et(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}function rt(t){return function(e){return t(e)}}function it(t,e){return t.has(e)}function nt(t,e){return t?.[e]}function st(t){var e=-1,r=Array(t.size);return t.forEach((function(t,i){r[++e]=[i,t]})),r}function ot(t,e){return function(r){return t(e(r))}}function at(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var ct=Array.prototype,ht=Function.prototype,ut=Object.prototype,ft=B["__core-js_shared__"],lt=ht.toString,dt=ut.hasOwnProperty,pt=function(){var t=/[^.]+$/.exec(ft&&ft.keys&&ft.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),wt=ut.toString,yt=RegExp("^"+lt.call(dt).replace(L,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vt=H?B.Buffer:void 0,bt=B.Symbol,mt=B.Uint8Array,_t=ut.propertyIsEnumerable,gt=ct.splice,Et=bt?bt.toStringTag:void 0,Ot=Object.getOwnPropertySymbols,jt=vt?vt.isBuffer:void 0,St=ot(Object.keys,Object),It=Ae(B,"DataView"),At=Ae(B,"Map"),xt=Ae(B,"Promise"),Nt=Ae(B,"Set"),Mt=Ae(B,"WeakMap"),Tt=Ae(Object,"create"),Rt=De(It),Pt=De(At),Ut=De(xt),$t=De(Nt),Dt=De(Mt),Ct=bt?bt.prototype:void 0,kt=Ct?Ct.valueOf:void 0;function Lt(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Ft(){this.__data__=Tt?Tt(null):{},this.size=0}function Vt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function qt(t){var e=this.__data__;if(Tt){var r=e[t];return r===n?void 0:r}return dt.call(e,t)?e[t]:void 0}function Gt(t){var e=this.__data__;return Tt?e[t]!==void 0:dt.call(e,t)}function Kt(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Tt&&e===void 0?n:e,this}Lt.prototype.clear=Ft,Lt.prototype.delete=Vt,Lt.prototype.get=qt,Lt.prototype.has=Gt,Lt.prototype.set=Kt;function Bt(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function zt(){this.__data__=[],this.size=0}function Wt(t){var e=this.__data__,r=de(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():gt.call(e,r,1),--this.size,!0}function Ht(t){var e=this.__data__,r=de(e,t);return r<0?void 0:e[r][1]}function Jt(t){return de(this.__data__,t)>-1}function Xt(t,e){var r=this.__data__,i=de(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}Bt.prototype.clear=zt,Bt.prototype.delete=Wt,Bt.prototype.get=Ht,Bt.prototype.has=Jt,Bt.prototype.set=Xt;function Yt(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function Zt(){this.size=0,this.__data__={hash:new Lt,map:new(At||Bt),string:new Lt}}function Qt(t){var e=Ie(this,t).delete(t);return this.size-=e?1:0,e}function te(t){return Ie(this,t).get(t)}function ee(t){return Ie(this,t).has(t)}function re(t,e){var r=Ie(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}Yt.prototype.clear=Zt,Yt.prototype.delete=Qt,Yt.prototype.get=te,Yt.prototype.has=ee,Yt.prototype.set=re;function ie(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Yt;++e<r;)this.add(t[e])}function ne(t){return this.__data__.set(t,n),this}function se(t){return this.__data__.has(t)}ie.prototype.add=ie.prototype.push=ne,ie.prototype.has=se;function oe(t){var e=this.__data__=new Bt(t);this.size=e.size}function ae(){this.__data__=new Bt,this.size=0}function ce(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function he(t){return this.__data__.get(t)}function ue(t){return this.__data__.has(t)}function fe(t,e){var r=this.__data__;if(r instanceof Bt){var n=r.__data__;if(!At||n.length<i-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Yt(n)}return r.set(t,e),this.size=r.size,this}oe.prototype.clear=ae,oe.prototype.delete=ce,oe.prototype.get=he,oe.prototype.has=ue,oe.prototype.set=fe;function le(t,e){var r=Le(t),i=!r&&ke(t),n=!r&&!i&&Ve(t),s=!r&&!i&&!n&&We(t),o=r||i||n||s,a=o?et(t.length,String):[],c=a.length;for(var h in t)(e||dt.call(t,h))&&!(o&&(h=="length"||n&&(h=="offset"||h=="parent")||s&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||Te(h,c)))&&a.push(h);return a}function de(t,e){for(var r=t.length;r--;)if(Ce(t[r][0],e))return r;return-1}function pe(t,e,r){var i=e(t);return Le(t)?i:Q(i,r(t))}function we(t){return t==null?t===void 0?I:b:Et&&Et in Object(t)?xe(t):$e(t)}function ye(t){return ze(t)&&we(t)==c}function ve(t,e,r,i,n){return t===e?!0:t==null||e==null||!ze(t)&&!ze(e)?t!==t&&e!==e:be(t,e,r,i,ve,n)}function be(t,e,r,i,n,o){var a=Le(t),u=Le(e),f=a?h:Me(t),l=u?h:Me(e);f=f==c?m:f,l=l==c?m:l;var d=f==m,p=l==m,w=f==l;if(w&&Ve(t)){if(!Ve(e))return!1;a=!0,d=!1}if(w&&!d)return o||(o=new oe),a||We(t)?Ee(t,e,r,i,n,o):Oe(t,e,f,r,i,n,o);if(!(r&s)){var y=d&&dt.call(t,"__wrapped__"),v=p&&dt.call(e,"__wrapped__");if(y||v){var b=y?t.value():t,_=v?e.value():e;return o||(o=new oe),n(b,_,r,i,o)}}return w?(o||(o=new oe),je(t,e,r,i,n,o)):!1}function me(t){if(!Be(t)||Pe(t))return!1;var e=Ge(t)?yt:F;return e.test(De(t))}function _e(t){return ze(t)&&Ke(t.length)&&!!q[we(t)]}function ge(t){if(!Ue(t))return St(t);var e=[];for(var r in Object(t))dt.call(t,r)&&r!="constructor"&&e.push(r);return e}function Ee(t,e,r,i,n,a){var c=r&s,h=t.length,u=e.length;if(h!=u&&!(c&&u>h))return!1;var f=a.get(t);if(f&&a.get(e))return f==e;var l=-1,d=!0,p=r&o?new ie:void 0;for(a.set(t,e),a.set(e,t);++l<h;){var w=t[l],y=e[l];if(i)var v=c?i(y,w,l,e,t,a):i(w,y,l,t,e,a);if(v!==void 0){if(v)continue;d=!1;break}if(p){if(!tt(e,(function(t,e){if(!it(p,e)&&(w===t||n(w,t,r,i,a)))return p.push(e)}))){d=!1;break}}else if(!(w===y||n(w,y,r,i,a))){d=!1;break}}return a.delete(t),a.delete(e),d}function Oe(t,e,r,i,n,a,c){switch(r){case N:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!a(new mt(t),new mt(e)));case f:case l:case v:return Ce(+t,+e);case d:return t.name==e.name&&t.message==e.message;case E:case j:return t==e+"";case y:var h=st;case O:var u=i&s;if(h||(h=at),t.size!=e.size&&!u)return!1;var p=c.get(t);if(p)return p==e;i|=o,c.set(t,e);var w=Ee(h(t),h(e),i,n,a,c);return c.delete(t),w;case S:if(kt)return kt.call(t)==kt.call(e)}return!1}function je(t,e,r,i,n,o){var a=r&s,c=Se(t),h=c.length,u=Se(e),f=u.length;if(h!=f&&!a)return!1;for(var l=h;l--;){var d=c[l];if(!(a?d in e:dt.call(e,d)))return!1}var p=o.get(t);if(p&&o.get(e))return p==e;var w=!0;o.set(t,e),o.set(e,t);for(var y=a;++l<h;){d=c[l];var v=t[d],b=e[d];if(i)var m=a?i(b,v,d,e,t,o):i(v,b,d,t,e,o);if(!(m===void 0?v===b||n(v,b,r,i,o):m)){w=!1;break}y||(y=d=="constructor")}if(w&&!y){var _=t.constructor,g=e.constructor;_!=g&&"constructor"in t&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof g=="function"&&g instanceof g)&&(w=!1)}return o.delete(t),o.delete(e),w}function Se(t){return pe(t,He,Ne)}function Ie(t,e){var r=t.__data__;return Re(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Ae(t,e){var r=nt(t,e);return me(r)?r:void 0}function xe(t){var e=dt.call(t,Et),r=t[Et];try{t[Et]=void 0;var i=!0}catch{}var n=wt.call(t);return i&&(e?t[Et]=r:delete t[Et]),n}var Ne=Ot?function(t){return t==null?[]:(t=Object(t),Z(Ot(t),(function(e){return _t.call(t,e)})))}:Je,Me=we;(It&&Me(new It(new ArrayBuffer(1)))!=N||At&&Me(new At)!=y||xt&&Me(xt.resolve())!=_||Nt&&Me(new Nt)!=O||Mt&&Me(new Mt)!=A)&&(Me=function(t){var e=we(t),r=e==m?t.constructor:void 0,i=r?De(r):"";if(i)switch(i){case Rt:return N;case Pt:return y;case Ut:return _;case $t:return O;case Dt:return A}return e});function Te(t,e){return e=e??a,!!e&&(typeof t=="number"||V.test(t))&&t>-1&&t%1==0&&t<e}function Re(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Pe(t){return!!pt&&pt in t}function Ue(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||ut;return t===r}function $e(t){return wt.call(t)}function De(t){if(t!=null){try{return lt.call(t)}catch{}try{return t+""}catch{}}return""}function Ce(t,e){return t===e||t!==t&&e!==e}var ke=ye(function(){return arguments}())?ye:function(t){return ze(t)&&dt.call(t,"callee")&&!_t.call(t,"callee")},Le=Array.isArray;function Fe(t){return t!=null&&Ke(t.length)&&!Ge(t)}var Ve=jt||Xe;function qe(t,e){return ve(t,e)}function Ge(t){if(!Be(t))return!1;var e=we(t);return e==p||e==w||e==u||e==g}function Ke(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=a}function Be(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function ze(t){return t!=null&&typeof t=="object"}var We=Y?rt(Y):_e;function He(t){return Fe(t)?le(t):ge(t)}function Je(){return[]}function Xe(){return!1}t.exports=qe})(Sl,Sl.exports);var Il=Sl.exports,Al=Object.defineProperty,xl=Object.getOwnPropertySymbols,Nl=Object.prototype.hasOwnProperty,Ml=Object.prototype.propertyIsEnumerable,Tl=(t,e,r)=>e in t?Al(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rl=(t,e)=>{for(var r in e||(e={}))Nl.call(e,r)&&Tl(t,r,e[r]);if(xl)for(var r of xl(e))Ml.call(e,r)&&Tl(t,r,e[r]);return t};function Pl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=n}var a=t.length,c=t.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(e.length===0)return"";for(var r=0,i=0,n=0,s=e.length;n!==s&&e[n]===0;)n++,r++;for(var o=(s-n)*u+1>>>0,h=new Uint8Array(o);n!==s;){for(var f=e[n],l=0,d=o-1;(f!==0||l<i)&&d!==-1;d--,l++)f+=256*h[d]>>>0,h[d]=f%a>>>0,f=f/a>>>0;if(f!==0)throw new Error("Non-zero carry");i=l,n++}for(var p=o-i;p!==o&&h[p]===0;)p++;for(var w=c.repeat(r);p<o;++p)w+=t.charAt(h[p]);return w}function l(t){if(typeof t!="string")throw new TypeError("Expected String");if(t.length===0)return new Uint8Array;var e=0;if(t[e]!==" "){for(var i=0,n=0;t[e]===c;)i++,e++;for(var s=(t.length-e)*h+1>>>0,o=new Uint8Array(s);t[e];){var u=r[t.charCodeAt(e)];if(u===255)return;for(var f=0,l=s-1;(u!==0||f<n)&&l!==-1;l--,f++)u+=a*o[l]>>>0,o[l]=u%256>>>0,u=u/256>>>0;if(u!==0)throw new Error("Non-zero carry");n=f,e++}if(t[e]!==" "){for(var d=s-n;d!==s&&o[d]===0;)d++;for(var p=new Uint8Array(i+(s-d)),w=i;d!==s;)p[w++]=o[d++];return p}}}function d(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}return{encode:f,decodeUnsafe:l,decode:d}}var Ul=Pl,$l=Ul;const Dl=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Cl=t=>(new TextEncoder).encode(t),kl=t=>(new TextDecoder).decode(t);class Ll{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Fl{constructor(t,e,r){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ql(this,t)}}class Vl{constructor(t){this.decoders=t}or(t){return ql(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ql=(t,e)=>new Vl(Rl(Rl({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class Gl{constructor(t,e,r,i){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=i,this.encoder=new Ll(t,e,r),this.decoder=new Fl(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Kl=({name:t,prefix:e,encode:r,decode:i})=>new Gl(t,e,r,i),Bl=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=$l(r,e);return Kl({prefix:t,name:e,encode:i,decode:t=>Dl(n(t))})},zl=(t,e,r,i)=>{const n={};for(let t=0;t<e.length;++t)n[e[t]]=t;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,h=0;for(let e=0;e<s;++e){const s=n[t[e]];if(s===void 0)throw new SyntaxError(`Non-${i} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Wl=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",o=0,a=0;for(let i=0;i<t.length;++i)for(a=a<<8|t[i],o+=8;o>r;)o-=r,s+=e[n&a>>o];if(o&&(s+=e[n&a<<r-o]),i)for(;s.length*r&7;)s+="=";return s},Hl=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Kl({prefix:e,name:t,encode(t){return Wl(t,i,r)},decode(e){return zl(e,i,r,t)}}),Jl=Kl({prefix:"\0",name:"identity",encode:t=>kl(t),decode:t=>Cl(t)});var Xl=Object.freeze({__proto__:null,identity:Jl});const Yl=Hl({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Zl=Object.freeze({__proto__:null,base2:Yl});const Ql=Hl({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var td=Object.freeze({__proto__:null,base8:Ql});const ed=Bl({prefix:"9",name:"base10",alphabet:"0123456789"});var rd=Object.freeze({__proto__:null,base10:ed});const id=Hl({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nd=Hl({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sd=Object.freeze({__proto__:null,base16:id,base16upper:nd});const od=Hl({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ad=Hl({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cd=Hl({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hd=Hl({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ud=Hl({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),fd=Hl({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ld=Hl({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dd=Hl({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),pd=Hl({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wd=Object.freeze({__proto__:null,base32:od,base32upper:ad,base32pad:cd,base32padupper:hd,base32hex:ud,base32hexupper:fd,base32hexpad:ld,base32hexpadupper:dd,base32z:pd});const yd=Bl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),vd=Bl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var bd=Object.freeze({__proto__:null,base36:yd,base36upper:vd});const md=Bl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_d=Bl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var gd=Object.freeze({__proto__:null,base58btc:md,base58flickr:_d});const Ed=Hl({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Od=Hl({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jd=Hl({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Sd=Hl({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Id=Object.freeze({__proto__:null,base64:Ed,base64pad:Od,base64url:jd,base64urlpad:Sd});const Ad=Array.from(""),xd=Ad.reduce(((t,e,r)=>(t[r]=e,t)),[]),Nd=Ad.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]);function Md(t){return t.reduce(((t,e)=>(t+=xd[e],t)),"")}function Td(t){const e=[];for(const r of t){const t=Nd[r.codePointAt(0)];if(t===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}const Rd=Kl({prefix:"",name:"base256emoji",encode:Md,decode:Td});var Pd=Object.freeze({__proto__:null,base256emoji:Rd}),Ud=Ld,$d=128,Dd=127,Cd=~Dd,kd=Math.pow(2,31);function Ld(t,e,r){e=e||[],r=r||0;for(var i=r;t>=kd;)e[r++]=t&255|$d,t/=128;for(;t&Cd;)e[r++]=t&255|$d,t>>>=7;return e[r]=t|0,Ld.bytes=r-i+1,e}var Fd=Gd,Vd=128,qd=127;function Gd(t,e){var r=0,e=e||0,i=0,n=e,s,o=t.length;do{if(n>=o)throw Gd.bytes=0,new RangeError("Could not decode varint");s=t[n++],r+=i<28?(s&qd)<<i:(s&qd)*Math.pow(2,i),i+=7}while(s>=Vd);return Gd.bytes=n-e,r}var Kd=Math.pow(2,7),Bd=Math.pow(2,14),zd=Math.pow(2,21),Wd=Math.pow(2,28),Hd=Math.pow(2,35),Jd=Math.pow(2,42),Xd=Math.pow(2,49),Yd=Math.pow(2,56),Zd=Math.pow(2,63),Qd=function(t){return t<Kd?1:t<Bd?2:t<zd?3:t<Wd?4:t<Hd?5:t<Jd?6:t<Xd?7:t<Yd?8:t<Zd?9:10},tp={encode:Ud,decode:Fd,encodingLength:Qd},ep=tp;const rp=(t,e,r=0)=>(ep.encode(t,e,r),e),ip=t=>ep.encodingLength(t),np=(t,e)=>{const r=e.byteLength,i=ip(t),n=i+ip(r),s=new Uint8Array(n+r);return rp(t,s,0),rp(r,s,i),s.set(e,n),new sp(t,r,e,s)};class sp{constructor(t,e,r,i){this.code=t,this.size=e,this.digest=r,this.bytes=i}}const op=({name:t,code:e,encode:r})=>new ap(t,e,r);class ap{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?np(this.code,e):e.then((t=>np(this.code,t)))}else throw Error("Unknown type, must be binary type")}}const cp=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),hp=op({name:"sha2-256",code:18,encode:cp("SHA-256")}),up=op({name:"sha2-512",code:19,encode:cp("SHA-512")});var fp=Object.freeze({__proto__:null,sha256:hp,sha512:up});const lp=0,dp="identity",pp=Dl;var wp=Object.freeze({__proto__:null,identity:{code:lp,name:dp,encode:pp,digest:t=>np(lp,pp(t))}});new TextEncoder,new TextDecoder;const yp=Rl(Rl(Rl(Rl(Rl(Rl(Rl(Rl(Rl(Rl({},Xl),Zl),td),rd),sd),wd),bd),gd),Id),Pd);Rl(Rl({},fp),wp);function vp(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function bp(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const mp=bp("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),_p=bp("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{t=t.substring(1);const e=vp(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),gp=Rl({utf8:mp,"utf-8":mp,hex:yp.base16,latin1:_p,ascii:_p,binary:_p},yp);function Ep(t,e="utf8"){const r=gp[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const Op="wc",jp=2,Sp="core",Ip=`${Op}@${2}:${Sp}:`,Ap={name:Sp,logger:"error"},xp={database:":memory:"},Np="crypto",Mp="client_ed25519_seed",Tp=Ae.ONE_DAY,Rp="keychain",Pp="0.3",Up="messages",$p="0.3",Dp=Ae.SIX_HOURS,Cp="publisher",kp="irn",Lp="error",Fp="wss://relay.walletconnect.com",Vp="relayer",qp={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed"},Gp="_subscription",Kp={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Bp=Ae.ONE_SECOND,zp="2.1.3",Wp="0.3",Hp={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Jp="subscription",Xp="0.3",Yp=Ae.FIVE_SECONDS*1e3,Zp="pairing",Qp="0.3",tw={wc_pairingDelete:{req:{ttl:Ae.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Ae.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Ae.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Ae.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Ae.ONE_DAY,prompt:!1,tag:0},res:{ttl:Ae.ONE_DAY,prompt:!1,tag:0}}},ew={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},rw="history",iw="0.3",nw="expirer",sw={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ow="0.3";class aw{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=Rp,this.version=Pp,this.initialized=!1,this.storagePrefix=Ip,this.init=async()=>{if(!this.initialized){const t=await this.getKeyChain();typeof t<"u"&&(this.keychain=t),this.initialized=!0}},this.has=t=>(this.isInitialized(),this.keychain.has(t)),this.set=async(t,e)=>{this.isInitialized(),this.keychain.set(t,e),await this.persist()},this.get=t=>{this.isInitialized();const e=this.keychain.get(t);if(typeof e>"u"){const{message:e}=iu("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e},this.del=async t=>{this.isInitialized(),this.keychain.delete(t),await this.persist()},this.core=t,this.logger=Kr.generateChildLogger(e,this.name)}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Ah(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xh(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}class cw{constructor(t,e,r){this.core=t,this.logger=e,this.name=Np,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=t=>(this.isInitialized(),this.keychain.has(t)),this.getClientId=async()=>{this.isInitialized();const t=await this.getClientSeed(),e=ua(t);return oa(e.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const t=Wc();return this.setPrivateKey(t.publicKey,t.privateKey)},this.signJWT=async t=>{this.isInitialized();const e=await this.getClientSeed(),r=ua(e),i=Hc();return await fa(i,t,Tp,r)},this.generateSharedKey=(t,e,r)=>{this.isInitialized();const i=this.getPrivateKey(t),n=Jc(i,e);return this.setSymKey(n,r)},this.setSymKey=async(t,e)=>{this.isInitialized();const r=e||Xc(t);return await this.keychain.set(r,t),r},this.deleteKeyPair=async t=>{this.isInitialized(),await this.keychain.del(t)},this.deleteSymKey=async t=>{this.isInitialized(),await this.keychain.del(t)},this.encode=async(t,e,r)=>{this.isInitialized();const i=sh(r),n=en(e);if(oh(i)){const e=i.senderPublicKey,r=i.receiverPublicKey;t=await this.generateSharedKey(e,r)}const s=this.getSymKey(t),{type:o,senderPublicKey:a}=i;return th({type:o,symKey:s,message:n,senderPublicKey:a})},this.decode=async(t,e,r)=>{this.isInitialized();const i=nh(e,r);if(oh(i)){const e=i.receiverPublicKey,r=i.senderPublicKey;t=await this.generateSharedKey(e,r)}const n=this.getSymKey(t),s=eh({symKey:n,encoded:e});return tn(s)},this.core=t,this.logger=Kr.generateChildLogger(e,this.name),this.keychain=r||new aw(this.core,this.logger)}get context(){return Kr.getLoggerContext(this.logger)}getPayloadType(t){const e=ih(t);return Qc(e.type)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Mp)}catch{t=Hc(),await this.keychain.set(Mp,t)}return Ep(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}class hw extends zi{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=Up,this.version=$p,this.initialized=!1,this.storagePrefix=Ip,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const t=await this.getRelayerMessages();typeof t<"u"&&(this.messages=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}finally{this.initialized=!0}}},this.set=async(t,e)=>{this.isInitialized();const r=Yc(e);let i=this.messages.get(t);return typeof i>"u"&&(i={}),typeof i[r]<"u"||(i[r]=e,this.messages.set(t,i),await this.persist()),r},this.get=t=>{this.isInitialized();let e=this.messages.get(t);return typeof e>"u"&&(e={}),e},this.has=(t,e)=>{this.isInitialized();const r=this.get(t),i=Yc(e);return typeof r[i]<"u"},this.del=async t=>{this.isInitialized(),this.messages.delete(t),await this.persist()},this.logger=Kr.generateChildLogger(t,this.name),this.core=e}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Ah(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xh(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}class uw extends Wi{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new R.exports.EventEmitter,this.name=Cp,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(t,e,r)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:e,opts:r}});try{const i=r?.ttl||Dp,n=Lh(r),s=r?.prompt||!1,o=r?.tag||0,a={topic:t,message:e,opts:{ttl:i,relay:n,prompt:s,tag:o}},c=Yc(e);this.queue.set(c,a);try{await await Rh(this.rpcPublish(t,e,i,n,s,o),this.publishTimeout)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(qp.connection_stalled);return}this.onPublish(c,a),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:e,opts:r}})}catch(t){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(t),t}},this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.relayer=t,this.logger=Kr.generateChildLogger(e,this.name),this.registerEventListeners()}get context(){return Kr.getLoggerContext(this.logger)}rpcPublish(t,e,r,i,n,s){var o,a,c,h;const u={method:Fh(i.protocol).publish,params:{topic:t,message:e,ttl:r,prompt:n,tag:s}};return au((o=u.params)==null?void 0:o.prompt)&&((a=u.params)==null||delete a.prompt),au((c=u.params)==null?void 0:c.tag)&&((h=u.params)==null||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:u}),this.relayer.provider.request(u)}onPublish(t,e){this.queue.delete(t)}checkQueue(){this.queue.forEach((async t=>{const{topic:e,message:r,opts:i}=t;await this.publish(e,r,i)}))}registerEventListeners(){this.relayer.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,(()=>{this.checkQueue()}))}}class fw{constructor(){this.map=new Map,this.set=(t,e)=>{const r=this.get(t);this.exists(t,e)||this.map.set(t,[...r,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,e))return;const i=r.filter((t=>t!==e));if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var lw=Object.defineProperty,dw=Object.defineProperties,pw=Object.getOwnPropertyDescriptors,ww=Object.getOwnPropertySymbols,yw=Object.prototype.hasOwnProperty,vw=Object.prototype.propertyIsEnumerable,bw=(t,e,r)=>e in t?lw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mw=(t,e)=>{for(var r in e||(e={}))yw.call(e,r)&&bw(t,r,e[r]);if(ww)for(var r of ww(e))vw.call(e,r)&&bw(t,r,e[r]);return t},_w=(t,e)=>dw(t,pw(e));class gw extends Xi{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new fw,this.events=new R.exports.EventEmitter,this.name=Jp,this.version=Xp,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Ip,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(t,e)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:e}});try{const r=Lh(e),i={topic:t,relay:r};this.pending.set(t,i);const n=await this.rpcSubscribe(t,r);return this.onSubscribe(n,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:e}}),n}catch(t){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(t),t}},this.unsubscribe=async(t,e)=>{this.isInitialized(),typeof e?.id<"u"?await this.unsubscribeById(t,e.id,e):await this.unsubscribeByTopic(t,e)},this.isSubscribed=async t=>this.topics.includes(t)?!0:await new Promise(((e,r)=>{const i=new Ae.Watch;i.start(this.pendingSubscriptionWatchLabel);const n=setInterval((()=>{!this.pending.has(t)&&this.topics.includes(t)&&(clearInterval(n),i.stop(this.pendingSubscriptionWatchLabel),e(!0)),i.elapsed(this.pendingSubscriptionWatchLabel)>=Yp&&(clearInterval(n),i.stop(this.pendingSubscriptionWatchLabel),r(!1))}),this.pendingSubInterval)})),this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=t,this.logger=Kr.generateChildLogger(e,this.name)}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let r=!1;try{r=this.getSubscription(t).topic===e}catch{}return r}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,e){const r=this.topicMap.get(t);await Promise.all(r.map((async r=>await this.unsubscribeById(t,r,e))))}async unsubscribeById(t,e,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:r}});try{const i=Lh(r);await this.rpcUnsubscribe(t,e,i);const n=nu("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,n),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:r}})}catch(t){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(t),t}}async rpcSubscribe(t,e){const r={method:Fh(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let i;try{i=await await Rh(this.relayer.provider.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(qp.connection_stalled)}return i}rpcUnsubscribe(t,e,r){const i={method:Fh(r.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,e){this.setSubscription(t,_w(mw({},e),{id:t})),this.pending.delete(e.topic)}onResubscribe(t,e){this.addSubscription(t,_w(mw({},e),{id:t})),this.pending.delete(e.topic)}async onUnsubscribe(t,e,r){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e))}addSubscription(t,e){this.subscriptions.set(t,mw({},e)),this.topicMap.set(e.topic,t),this.events.emit(Hp.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:e}=iu("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(Hp.deleted,_w(mw({},r),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Hp.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map((async t=>await this.resubscribe(t)))),this.events.emit(Hp.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:t}=iu("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:e,relay:r}=t,i={topic:e,relay:r};this.pending.set(i.topic,i);const n=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(n,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach((async t=>{const e=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(e,t)}))}registerEventListeners(){this.relayer.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,(()=>{this.checkPending()})),this.relayer.on(qp.connect,(async()=>{await this.onConnect()})),this.relayer.on(qp.disconnect,(()=>{this.onDisconnect()})),this.events.on(Hp.created,(async t=>{const e=Hp.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})),this.events.on(Hp.deleted,(async t=>{const e=Hp.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Ew=Object.defineProperty,Ow=Object.getOwnPropertySymbols,jw=Object.prototype.hasOwnProperty,Sw=Object.prototype.propertyIsEnumerable,Iw=(t,e,r)=>e in t?Ew(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Aw=(t,e)=>{for(var r in e||(e={}))jw.call(e,r)&&Iw(t,r,e[r]);if(Ow)for(var r of Ow(e))Sw.call(e,r)&&Iw(t,r,e[r]);return t};class xw extends Hi{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new R.exports.EventEmitter,this.name=Vp,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Kr.generateChildLogger(t.logger,this.name):u(Kr.getDefaultLoggerOptions({level:t.logger||Lp})),this.messages=new hw(this.logger,t.core),this.subscriber=new gw(this,this.logger),this.publisher=new uw(this,this.logger),this.relayUrl=t?.relayUrl||Fp,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Kr.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,e,r){this.isInitialized(),await this.publisher.publish(t,e,r),await this.recordMessageEvent({topic:t,message:e})}async subscribe(t,e){this.isInitialized();let r="";return await Promise.all([new Promise((e=>{this.subscriber.once(Hp.created,(r=>{r.topic===t&&e()}))})),new Promise((async i=>{r=await this.subscriber.subscribe(t,e),i()}))]),r}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(qp.transport_closed)}async transportOpen(t){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise((t=>{this.initialized||t(),this.subscriber.once(Hp.resubscribed,(()=>{t()}))})),await Promise.race([this.provider.connect(),new Promise(((t,e)=>this.once(qp.transport_closed,(()=>{e()}))))])])}catch(t){const e=t;if(!/socket hang up/i.test(e.message))throw new Error(e.message);this.logger.error(e),this.events.emit(qp.transport_closed)}}async restartTransport(t){await this.transportClose(),await new Promise((t=>setTimeout(t,Bp))),await this.transportOpen(t)}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new Zf(new jl(Sh({sdkVersion:zp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:e,message:r}=t;await this.messages.set(e,r)}async shouldIgnoreMessageEvent(t){const{topic:e,message:r}=t;return await this.subscriber.isSubscribed(e)?this.messages.has(e,r):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Hf(t)){if(!t.method.endsWith(Gp))return;const e=t.params,{topic:r,message:i}=e.data,n={topic:r,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Aw({type:"event",event:e.id},n)),this.events.emit(e.id,n),await this.acknowledgePayload(t),await this.onMessageEvent(n)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(qp.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=Uf(t.id,!0);await this.provider.connection.send(e)}registerEventListeners(){this.provider.on(Kp.payload,(t=>this.onProviderPayload(t))),this.provider.on(Kp.connect,(()=>{this.events.emit(qp.connect)})),this.provider.on(Kp.disconnect,(()=>{this.events.emit(qp.disconnect),this.attemptToReconnect()})),this.provider.on(Kp.error,(t=>this.events.emit(qp.error,t))),this.events.on(qp.connection_stalled,(async()=>{await this.restartTransport()}))}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout((async()=>{await this.transportOpen()}),Ae.toMiliseconds(Bp))}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Nw=Object.defineProperty,Mw=Object.getOwnPropertySymbols,Tw=Object.prototype.hasOwnProperty,Rw=Object.prototype.propertyIsEnumerable,Pw=(t,e,r)=>e in t?Nw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Uw=(t,e)=>{for(var r in e||(e={}))Tw.call(e,r)&&Pw(t,r,e[r]);if(Mw)for(var r of Mw(e))Rw.call(e,r)&&Pw(t,r,e[r]);return t};class $w extends Ji{constructor(t,e,r,i=Ip,n=void 0){super(t,e,r,i),this.core=t,this.logger=e,this.name=r,this.map=new Map,this.version=Wp,this.cached=[],this.initialized=!1,this.storagePrefix=Ip,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>{pu(t)?this.map.set(t.id,t):wu(t)?this.map.set(t.topic,t):this.getKey&&t!==null&&!au(t)&&this.map.set(this.getKey(t),t)})),this.cached=[],this.initialized=!0)},this.set=async(t,e)=>{this.isInitialized(),this.map.has(t)?await this.update(t,e):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:t,value:e}),this.map.set(t,e),await this.persist())},this.get=t=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:t}),this.getData(t)),this.getAll=t=>(this.isInitialized(),t?this.values.filter((e=>Object.keys(t).every((r=>Il(e[r],t[r]))))):this.values),this.update=async(t,e)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:t,update:e});const r=Uw(Uw({},this.getData(t)),e);this.map.set(t,r),await this.persist()},this.delete=async(t,e)=>{this.isInitialized(),this.map.has(t)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:t,reason:e}),this.map.delete(t),await this.persist())},this.logger=Kr.generateChildLogger(e,this.name),this.storagePrefix=i,this.getKey=n}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){const{message:e}=iu("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(e),new Error(e)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:t}=iu("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Dw{constructor(t,e){this.core=t,this.logger=e,this.name=Zp,this.version=Qp,this.events=new R.exports,this.initialized=!1,this.storagePrefix=Ip,this.ignoredPayloadTypes=[qc],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:t})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...t])]},this.create=async()=>{this.isInitialized();const t=Hc(),e=await this.core.crypto.setSymKey(t),r=Nh(Ae.FIVE_MINUTES),i={protocol:kp},n={topic:e,expiry:r,relay:i,active:!1},s=Xh({protocol:this.core.protocol,version:this.core.version,topic:e,symKey:t,relay:i});return await this.pairings.set(e,n),await this.core.relayer.subscribe(e),this.core.expirer.set(e,r),{topic:e,uri:s}},this.pair=async t=>{this.isInitialized(),this.isValidPair(t);const{topic:e,symKey:r,relay:i}=Hh(t.uri),n=Nh(Ae.FIVE_MINUTES),s={topic:e,relay:i,expiry:n,active:!1};return await this.pairings.set(e,s),await this.core.crypto.setSymKey(r,e),await this.core.relayer.subscribe(e,{relay:i}),this.core.expirer.set(e,n),t.activatePairing&&await this.activate({topic:e}),s},this.activate=async({topic:t})=>{this.isInitialized();const e=Nh(Ae.THIRTY_DAYS);await this.pairings.update(t,{active:!0,expiry:e}),this.core.expirer.set(t,e)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:e}=t;if(this.pairings.keys.includes(e)){const t=await this.sendRequest(e,"wc_pairingPing",{}),{done:r,resolve:i,reject:n}=Th();this.events.once(Ch("pairing_ping",t),(({error:t})=>{t?n(t):i()})),await r()}},this.updateExpiry=async({topic:t,expiry:e})=>{this.isInitialized(),await this.pairings.update(t,{expiry:e})},this.updateMetadata=async({topic:t,metadata:e})=>{this.isInitialized(),await this.pairings.update(t,{peerMetadata:e})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:e}=t;this.pairings.keys.includes(e)&&(await this.sendRequest(e,"wc_pairingDelete",nu("USER_DISCONNECTED")),await this.deletePairing(e))},this.sendRequest=async(t,e,r)=>{const i=Pf(e,r),n=await this.core.crypto.encode(t,i),s=tw[e].req;return this.core.history.set(t,i),await this.core.relayer.publish(t,n,s),i.id},this.sendResult=async(t,e,r)=>{const i=Uf(t,r),n=await this.core.crypto.encode(e,i),s=await this.core.history.get(e,t),o=tw[s.request.method].res;await this.core.relayer.publish(e,n,o),await this.core.history.resolve(i)},this.sendError=async(t,e,r)=>{const i=$f(t,r),n=await this.core.crypto.encode(e,i),s=await this.core.history.get(e,t),o=tw[s.request.method]?tw[s.request.method].res:tw.unregistered_method.res;await this.core.relayer.publish(e,n,o),await this.core.history.resolve(i)},this.deletePairing=async(t,e)=>{await this.core.relayer.unsubscribe(t),await Promise.all([this.pairings.delete(t,nu("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(t),e?Promise.resolve():this.core.expirer.del(t)])},this.cleanup=async()=>{const t=this.pairings.getAll().filter((t=>Mh(t.expiry)));await Promise.all(t.map((t=>this.deletePairing(t.topic))))},this.onRelayEventRequest=t=>{const{topic:e,payload:r}=t;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(e,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(e,r);default:return this.onUnknownRpcMethodRequest(e,r)}},this.onRelayEventResponse=async t=>{const{topic:e,payload:r}=t,i=(await this.core.history.get(e,r.id)).request.method;switch(i){case"wc_pairingPing":return this.onPairingPingResponse(e,r);default:return this.onUnknownRpcMethodResponse(i)}},this.onPairingPingRequest=async(t,e)=>{const{id:r}=e;try{this.isValidPing({topic:t}),await this.sendResult(r,t,!0),this.events.emit("pairing_ping",{id:r,topic:t})}catch(e){await this.sendError(r,t,e),this.logger.error(e)}},this.onPairingPingResponse=(t,e)=>{const{id:r}=e;setTimeout((()=>{Xf(e)?this.events.emit(Ch("pairing_ping",r),{}):Yf(e)&&this.events.emit(Ch("pairing_ping",r),{error:e.error})}),500)},this.onPairingDeleteRequest=async(t,e)=>{const{id:r}=e;try{this.isValidDisconnect({topic:t}),await this.sendResult(r,t,!0),await this.deletePairing(t),this.events.emit("pairing_delete",{id:r,topic:t})}catch(e){await this.sendError(r,t,e),this.logger.error(e)}},this.onUnknownRpcMethodRequest=async(t,e)=>{const{id:r,method:i}=e;try{if(this.registeredMethods.includes(i))return;const e=nu("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,t,e),this.logger.error(e)}catch(e){await this.sendError(r,t,e),this.logger.error(e)}},this.onUnknownRpcMethodResponse=t=>{this.registeredMethods.includes(t)||this.logger.error(nu("WC_METHOD_UNSUPPORTED",t))},this.isValidPair=t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`pair() params: ${t}`);throw new Error(e)}if(!du(t.uri)){const{message:e}=iu("MISSING_OR_INVALID",`pair() uri: ${t.uri}`);throw new Error(e)}},this.isValidPing=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidPairingTopic(e)},this.isValidDisconnect=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidPairingTopic(e)},this.isValidPairingTopic=async t=>{if(!cu(t,!1)){const{message:e}=iu("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.pairings.keys.includes(t)){const{message:e}=iu("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(Mh(this.pairings.get(t).expiry)){await this.deletePairing(t);const{message:e}=iu("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}},this.core=t,this.logger=Kr.generateChildLogger(e,this.name),this.pairings=new $w(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Kr.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(qp.message,(async t=>{const{topic:e,message:r}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;const i=await this.core.crypto.decode(e,r);Hf(i)?(this.core.history.set(e,i),this.onRelayEventRequest({topic:e,payload:i})):Jf(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:e,payload:i}))}))}registerExpirerEvents(){this.core.expirer.on(sw.expired,(async t=>{const{topic:e}=Dh(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit("pairing_expire",{topic:e}))}))}}class Cw extends Bi{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new R.exports.EventEmitter,this.name=rw,this.version=iw,this.cached=[],this.initialized=!1,this.storagePrefix=Ip,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.records.set(t.id,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(t,e,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:t,request:e,chainId:r}),this.records.has(e.id))return;const i={id:e.id,topic:t,request:{method:e.method,params:e.params||null},chainId:r};this.records.set(i.id,i),this.events.emit(ew.created,i)},this.resolve=async t=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:t}),!this.records.has(t.id))return;const e=await this.getRecord(t.id);typeof e.response>"u"&&(e.response=Yf(t)?{error:t.error}:{result:t.result},this.records.set(e.id,e),this.events.emit(ew.updated,e))},this.get=async(t,e)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:t,id:e}),await this.getRecord(e)),this.delete=(t,e)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:e}),this.values.forEach((r=>{if(r.topic===t){if(typeof e<"u"&&r.id!==e)return;this.records.delete(r.id),this.events.emit(ew.deleted,r)}}))},this.exists=async(t,e)=>(this.isInitialized(),this.records.has(e)?(await this.getRecord(e)).topic===t:!1),this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.logger=Kr.generateChildLogger(e,this.name)}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach((e=>{if(typeof e.response<"u")return;const r={topic:e.topic,request:Pf(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(r)})),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:e}=iu("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ew.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:t}=iu("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ew.created,(t=>{const e=ew.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})),this.events.on(ew.updated,(t=>{const e=ew.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})),this.events.on(ew.deleted,(t=>{const e=ew.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}class kw extends Yi{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new R.exports.EventEmitter,this.name=nw,this.version=ow,this.cached=[],this.initialized=!1,this.storagePrefix=Ip,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.expirations.set(t.target,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=t=>{try{const e=this.formatTarget(t);return typeof this.getExpiration(e)<"u"}catch{return!1}},this.set=(t,e)=>{this.isInitialized();const r=this.formatTarget(t),i={target:r,expiry:e};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(sw.created,{target:r,expiration:i})},this.get=t=>{this.isInitialized();const e=this.formatTarget(t);return this.getExpiration(e)},this.del=t=>{this.isInitialized();const e=this.formatTarget(t);if(this.has(e)){const t=this.getExpiration(e);this.expirations.delete(e),this.events.emit(sw.deleted,{target:e,expiration:t})}},this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.logger=Kr.generateChildLogger(e,this.name)}get context(){return Kr.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Uh(t);if(typeof t=="number")return $h(t);const{message:e}=iu("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(sw.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:t}=iu("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:e}=iu("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(e),new Error(e)}return e}checkExpiry(t,e){const{expiry:r}=e;Ae.toMiliseconds(r)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(sw.expired,{target:t,expiration:e})}checkExpirations(){this.expirations.forEach(((t,e)=>this.checkExpiry(e,t)))}registerEventListeners(){this.core.heartbeat.on(Wt.HEARTBEAT_EVENTS.pulse,(()=>this.checkExpirations())),this.events.on(sw.created,(t=>{const e=sw.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})),this.events.on(sw.expired,(t=>{const e=sw.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})),this.events.on(sw.deleted,(t=>{const e=sw.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Lw=Object.defineProperty,Fw=Object.getOwnPropertySymbols,Vw=Object.prototype.hasOwnProperty,qw=Object.prototype.propertyIsEnumerable,Gw=(t,e,r)=>e in t?Lw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kw=(t,e)=>{for(var r in e||(e={}))Vw.call(e,r)&&Gw(t,r,e[r]);if(Fw)for(var r of Fw(e))qw.call(e,r)&&Gw(t,r,e[r]);return t};class Bw extends Ki{constructor(t){super(t),this.protocol=Op,this.version=jp,this.name=Sp,this.events=new R.exports.EventEmitter,this.initialized=!1,this.on=(t,e)=>this.events.on(t,e),this.once=(t,e)=>this.events.once(t,e),this.off=(t,e)=>this.events.off(t,e),this.removeListener=(t,e)=>this.events.removeListener(t,e),this.projectId=t?.projectId;const e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:u(Kr.getDefaultLoggerOptions({level:t?.logger||Ap.logger}));this.logger=Kr.generateChildLogger(e,this.name),this.heartbeat=new Wt.HeartBeat,this.crypto=new cw(this,this.logger,t?.keychain),this.history=new Cw(this,this.logger),this.expirer=new kw(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new zt(Kw(Kw({},xp),t?.storageOptions)),this.relayer=new xw({core:this,logger:this.logger,relayUrl:t?.relayUrl,projectId:this.projectId}),this.pairing=new Dw(this,this.logger)}static async init(t){const e=new Bw(t);return await e.initialize(),e}get context(){return Kr.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(t){throw this.logger.warn(`Core Initilization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const zw=Bw;var Ww={exports:{}},Hw=typeof Reflect=="object"?Reflect:null,Jw=Hw&&typeof Hw.apply=="function"?Hw.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},Xw;Hw&&typeof Hw.ownKeys=="function"?Xw=Hw.ownKeys:Object.getOwnPropertySymbols?Xw=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Xw=function(t){return Object.getOwnPropertyNames(t)};function Yw(t){console&&console.warn&&console.warn(t)}var Zw=Number.isNaN||function(t){return t!==t};function Qw(){Qw.init.call(this)}Ww.exports=Qw,Ww.exports.once=fy,Qw.EventEmitter=Qw,Qw.prototype._events=void 0,Qw.prototype._eventsCount=0,Qw.prototype._maxListeners=void 0;var ty=10;function ey(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Qw,"defaultMaxListeners",{enumerable:!0,get:function(){return ty},set:function(t){if(typeof t!="number"||t<0||Zw(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ty=t}}),Qw.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Qw.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Zw(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function ry(t){return t._maxListeners===void 0?Qw.defaultMaxListeners:t._maxListeners}Qw.prototype.getMaxListeners=function(){return ry(this)},Qw.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[t];if(a===void 0)return!1;if(typeof a=="function")Jw(a,this,e);else for(var c=a.length,h=cy(a,c),r=0;r<c;++r)Jw(h[r],this,e);return!0};function iy(t,e,r,i){var n,s,o;if(ey(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=ry(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Yw(a)}return t}Qw.prototype.addListener=function(t,e){return iy(this,t,e,!1)},Qw.prototype.on=Qw.prototype.addListener,Qw.prototype.prependListener=function(t,e){return iy(this,t,e,!0)};function ny(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function sy(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=ny.bind(i);return n.listener=r,i.wrapFn=n,n}Qw.prototype.once=function(t,e){return ey(e),this.on(t,sy(this,t,e)),this},Qw.prototype.prependOnceListener=function(t,e){return ey(e),this.prependListener(t,sy(this,t,e)),this},Qw.prototype.removeListener=function(t,e){var r,i,n,s,o;if(ey(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():hy(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},Qw.prototype.off=Qw.prototype.removeListener,Qw.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function oy(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?uy(n):cy(n,n.length)}Qw.prototype.listeners=function(t){return oy(this,t,!0)},Qw.prototype.rawListeners=function(t){return oy(this,t,!1)},Qw.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ay.call(t,e)},Qw.prototype.listenerCount=ay;function ay(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Qw.prototype.eventNames=function(){return this._eventsCount>0?Xw(this._events):[]};function cy(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function hy(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function uy(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function fy(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}dy(t,e,s,{once:!0}),e!=="error"&&ly(t,n,{once:!0})}))}function ly(t,e,r){typeof t.on=="function"&&dy(t,"error",e,r)}function dy(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const py="wc",wy=2,yy="client",vy=`${py}@${wy}:${yy}:`,by={name:yy,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},my="proposal",_y="session",gy=Ae.SEVEN_DAYS,Ey="engine",Oy={wc_sessionPropose:{req:{ttl:Ae.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Ae.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Ae.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Ae.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Ae.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Ae.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Ae.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Ae.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Ae.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Ae.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Ae.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Ae.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Ae.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Ae.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Ae.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Ae.THIRTY_SECONDS,prompt:!1,tag:1115}}},jy="request";var Sy=Object.defineProperty,Iy=Object.defineProperties,Ay=Object.getOwnPropertyDescriptors,xy=Object.getOwnPropertySymbols,Ny=Object.prototype.hasOwnProperty,My=Object.prototype.propertyIsEnumerable,Ty=(t,e,r)=>e in t?Sy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ry=(t,e)=>{for(var r in e||(e={}))Ny.call(e,r)&&Ty(t,r,e[r]);if(xy)for(var r of xy(e))My.call(e,r)&&Ty(t,r,e[r]);return t},Py=(t,e)=>Iy(t,Ay(e));class Uy extends Qi{constructor(t){super(t),this.name=Ey,this.events=new Ww.exports,this.initialized=!1,this.ignoredPayloadTypes=[qc],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Oy)}),this.initialized=!0)},this.connect=async t=>{this.isInitialized(),await this.isValidConnect(t);const{pairingTopic:e,requiredNamespaces:r,relays:i}=t;let n=e,s,o=!1;if(n&&(o=this.client.core.pairing.pairings.get(n).active),!n||!o){const{topic:t,uri:e}=await this.client.core.pairing.create();n=t,s=e}const a=await this.client.core.crypto.generateKeyPair(),c={requiredNamespaces:r,relays:i??[{protocol:kp}],proposer:{publicKey:a,metadata:this.client.metadata}},{reject:h,resolve:u,done:f}=Th();if(this.events.once(Ch("session_connect"),(async({error:t,session:e})=>{if(t)h(t);else if(e){e.self.publicKey=a;const t=Py(Ry({},e),{requiredNamespaces:r});await this.client.session.set(e.topic,t),await this.setExpiry(e.topic,e.expiry),n&&await this.client.core.pairing.updateMetadata({topic:n,metadata:e.peer.metadata}),u(t)}})),!n){const{message:t}=iu("NO_MATCHING_KEY",`connect() pairing topic: ${n}`);throw new Error(t)}const l=await this.sendRequest(n,"wc_sessionPropose",c),d=Nh(Ae.FIVE_MINUTES);return await this.setProposal(l,Ry({id:l,expiry:d},c)),{uri:s,approval:f}},this.pair=async t=>(this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{this.isInitialized(),await this.isValidApprove(t);const{id:e,relayProtocol:r,namespaces:i}=t,{pairingTopic:n,proposer:s,requiredNamespaces:o}=this.client.proposal.get(e),a=await this.client.core.crypto.generateKeyPair(),c=s.publicKey,h=await this.client.core.crypto.generateSharedKey(a,c),u={relay:{protocol:r??"irn"},namespaces:i,requiredNamespaces:o,controller:{publicKey:a,metadata:this.client.metadata},expiry:Nh(gy)};await this.client.core.relayer.subscribe(h);const f=await this.sendRequest(h,"wc_sessionSettle",u),{done:l,resolve:d,reject:p}=Th();this.events.once(Ch("session_approve",f),(({error:t})=>{t?p(t):d(this.client.session.get(h))}));const w=Py(Ry({},u),{topic:h,acknowledged:!1,self:u.controller,peer:{publicKey:s.publicKey,metadata:s.metadata},controller:a});return await this.client.session.set(h,w),await this.setExpiry(h,Nh(gy)),n&&await this.client.core.pairing.updateMetadata({topic:n,metadata:w.peer.metadata}),n&&e&&(await this.sendResult(e,n,{relay:{protocol:r??"irn"},responderPublicKey:a}),await this.client.proposal.delete(e,nu("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:n})),{topic:h,acknowledged:l}},this.reject=async t=>{this.isInitialized(),await this.isValidReject(t);const{id:e,reason:r}=t,{pairingTopic:i}=this.client.proposal.get(e);i&&(await this.sendError(e,i,r),await this.client.proposal.delete(e,nu("USER_DISCONNECTED")))},this.update=async t=>{this.isInitialized(),await this.isValidUpdate(t);const{topic:e,namespaces:r}=t,i=await this.sendRequest(e,"wc_sessionUpdate",{namespaces:r}),{done:n,resolve:s,reject:o}=Th();return this.events.once(Ch("session_update",i),(({error:t})=>{t?o(t):s()})),await this.client.session.update(e,{namespaces:r}),{acknowledged:n}},this.extend=async t=>{this.isInitialized(),await this.isValidExtend(t);const{topic:e}=t,r=await this.sendRequest(e,"wc_sessionExtend",{}),{done:i,resolve:n,reject:s}=Th();return this.events.once(Ch("session_extend",r),(({error:t})=>{t?s(t):n()})),await this.setExpiry(e,Nh(gy)),{acknowledged:i}},this.request=async t=>{this.isInitialized(),await this.isValidRequest(t);const{chainId:e,request:r,topic:i}=t,n=await this.sendRequest(i,"wc_sessionRequest",{request:r,chainId:e}),{done:s,resolve:o,reject:a}=Th();return this.events.once(Ch("session_request",n),(({error:t,result:e})=>{t?a(t):o(e)})),await s()},this.respond=async t=>{this.isInitialized(),await this.isValidRespond(t);const{topic:e,response:r}=t,{id:i}=r;Xf(r)?await this.sendResult(i,e,r.result):Yf(r)&&await this.sendError(i,e,r.error),this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0})},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:e}=t;if(this.client.session.keys.includes(e)){const t=await this.sendRequest(e,"wc_sessionPing",{}),{done:r,resolve:i,reject:n}=Th();this.events.once(Ch("session_ping",t),(({error:t})=>{t?n(t):i()})),await r()}else this.client.core.pairing.pairings.keys.includes(e)&&await this.client.core.pairing.ping({topic:e})},this.emit=async t=>{this.isInitialized(),await this.isValidEmit(t);const{topic:e,event:r,chainId:i}=t;await this.sendRequest(e,"wc_sessionEvent",{event:r,chainId:i})},this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:e}=t;this.client.session.keys.includes(e)?(await this.sendRequest(e,"wc_sessionDelete",nu("USER_DISCONNECTED")),await this.deleteSession(e)):await this.client.core.pairing.disconnect({topic:e})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter((e=>uu(e,t)))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(t,e)=>{const{self:r}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),await Promise.all([this.client.session.delete(t,nu("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(r.publicKey),this.client.core.crypto.deleteSymKey(t),e?Promise.resolve():this.client.core.expirer.del(t)])},this.deleteProposal=async(t,e)=>{await Promise.all([this.client.proposal.delete(t,nu("USER_DISCONNECTED")),e?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,e,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,e),r?Promise.resolve():this.client.core.expirer.del(t)])},this.setExpiry=async(t,e)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:e}),this.client.core.expirer.set(t,e)},this.setProposal=async(t,e)=>{await this.client.proposal.set(t,e),this.client.core.expirer.set(t,e.expiry)},this.setPendingSessionRequest=async t=>{const e=Oy.wc_sessionRequest.req.ttl,{id:r,topic:i,params:n}=t;await this.client.pendingRequest.set(r,{id:r,topic:i,params:n}),e&&this.client.core.expirer.set(r,e)},this.sendRequest=async(t,e,r)=>{const i=Pf(e,r),n=await this.client.core.crypto.encode(t,i),s=Oy[e].req;return this.client.core.history.set(t,i),this.client.core.relayer.publish(t,n,s),i.id},this.sendResult=async(t,e,r)=>{const i=Uf(t,r),n=await this.client.core.crypto.encode(e,i),s=await this.client.core.history.get(e,t),o=Oy[s.request.method].res;this.client.core.relayer.publish(e,n,o),await this.client.core.history.resolve(i)},this.sendError=async(t,e,r)=>{const i=$f(t,r),n=await this.client.core.crypto.encode(e,i),s=await this.client.core.history.get(e,t),o=Oy[s.request.method].res;this.client.core.relayer.publish(e,n,o),await this.client.core.history.resolve(i)},this.cleanup=async()=>{const t=[],e=[];this.client.session.getAll().forEach((e=>{Mh(e.expiry)&&t.push(e.topic)})),this.client.proposal.getAll().forEach((t=>{Mh(t.expiry)&&e.push(t.id)})),await Promise.all([...t.map((t=>this.deleteSession(t))),...e.map((t=>this.deleteProposal(t)))])},this.onRelayEventRequest=t=>{const{topic:e,payload:r}=t,i=r.method;switch(i){case"wc_sessionPropose":return this.onSessionProposeRequest(e,r);case"wc_sessionSettle":return this.onSessionSettleRequest(e,r);case"wc_sessionUpdate":return this.onSessionUpdateRequest(e,r);case"wc_sessionExtend":return this.onSessionExtendRequest(e,r);case"wc_sessionPing":return this.onSessionPingRequest(e,r);case"wc_sessionDelete":return this.onSessionDeleteRequest(e,r);case"wc_sessionRequest":return this.onSessionRequest(e,r);case"wc_sessionEvent":return this.onSessionEventRequest(e,r);default:return this.client.logger.info(`Unsupported request method ${i}`)}},this.onRelayEventResponse=async t=>{const{topic:e,payload:r}=t,i=(await this.client.core.history.get(e,r.id)).request.method;switch(i){case"wc_sessionPropose":return this.onSessionProposeResponse(e,r);case"wc_sessionSettle":return this.onSessionSettleResponse(e,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(e,r);case"wc_sessionExtend":return this.onSessionExtendResponse(e,r);case"wc_sessionPing":return this.onSessionPingResponse(e,r);case"wc_sessionRequest":return this.onSessionRequestResponse(e,r);default:return this.client.logger.info(`Unsupported response method ${i}`)}},this.onSessionProposeRequest=async(t,e)=>{const{params:r,id:i}=e;try{this.isValidConnect(Ry({},e.params));const n=Nh(Ae.FIVE_MINUTES),s=Ry({id:i,pairingTopic:t,expiry:n},r);await this.setProposal(i,s),this.client.events.emit("session_proposal",{id:i,params:s})}catch(e){await this.sendError(i,t,e),this.client.logger.error(e)}},this.onSessionProposeResponse=async(t,e)=>{const{id:r}=e;if(Xf(e)){const{result:i}=e;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:i});const n=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});const s=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const o=i.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});const a=await this.client.core.crypto.generateSharedKey(s,o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:a});const c=await this.client.core.relayer.subscribe(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:t})}else Yf(e)&&(await this.client.proposal.delete(r,nu("USER_DISCONNECTED")),this.events.emit(Ch("session_connect"),{error:e.error}))},this.onSessionSettleRequest=async(t,e)=>{const{id:r,params:i}=e;try{this.isValidSessionSettleRequest(i);const{relay:r,controller:n,expiry:s,namespaces:o}=e.params,a={topic:t,relay:r,expiry:s,namespaces:o,acknowledged:!0,controller:n.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:n.publicKey,metadata:n.metadata}};await this.sendResult(e.id,t,!0),this.events.emit(Ch("session_connect"),{session:a})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.onSessionSettleResponse=async(t,e)=>{const{id:r}=e;Xf(e)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(Ch("session_approve",r),{})):Yf(e)&&(await this.client.session.delete(t,nu("USER_DISCONNECTED")),this.events.emit(Ch("session_approve",r),{error:e.error}))},this.onSessionUpdateRequest=async(t,e)=>{const{params:r,id:i}=e;try{this.isValidUpdate(Ry({topic:t},r)),await this.client.session.update(t,{namespaces:r.namespaces}),await this.sendResult(i,t,!0),this.client.events.emit("session_update",{id:i,topic:t,params:r})}catch(e){await this.sendError(i,t,e),this.client.logger.error(e)}},this.onSessionUpdateResponse=(t,e)=>{const{id:r}=e;Xf(e)?this.events.emit(Ch("session_update",r),{}):Yf(e)&&this.events.emit(Ch("session_update",r),{error:e.error})},this.onSessionExtendRequest=async(t,e)=>{const{id:r}=e;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Nh(gy)),await this.sendResult(r,t,!0),this.client.events.emit("session_extend",{id:r,topic:t})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.onSessionExtendResponse=(t,e)=>{const{id:r}=e;Xf(e)?this.events.emit(Ch("session_extend",r),{}):Yf(e)&&this.events.emit(Ch("session_extend",r),{error:e.error})},this.onSessionPingRequest=async(t,e)=>{const{id:r}=e;try{this.isValidPing({topic:t}),await this.sendResult(r,t,!0),this.client.events.emit("session_ping",{id:r,topic:t})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.onSessionPingResponse=(t,e)=>{const{id:r}=e;setTimeout((()=>{Xf(e)?this.events.emit(Ch("session_ping",r),{}):Yf(e)&&this.events.emit(Ch("session_ping",r),{error:e.error})}),500)},this.onSessionDeleteRequest=async(t,e)=>{const{id:r}=e;try{this.isValidDisconnect({topic:t,reason:e.params}),await this.sendResult(r,t,!0),await this.deleteSession(t),this.client.events.emit("session_delete",{id:r,topic:t})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.onSessionRequest=async(t,e)=>{const{id:r,params:i}=e;try{this.isValidRequest(Ry({topic:t},i)),await this.setPendingSessionRequest({id:r,topic:t,params:i}),this.client.events.emit("session_request",{id:r,topic:t,params:i})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.onSessionRequestResponse=(t,e)=>{const{id:r}=e;Xf(e)?this.events.emit(Ch("session_request",r),{result:e.result}):Yf(e)&&this.events.emit(Ch("session_request",r),{error:e.error})},this.onSessionEventRequest=async(t,e)=>{const{id:r,params:i}=e;try{this.isValidEmit(Ry({topic:t},i)),this.client.events.emit("session_event",{id:r,topic:t,params:i})}catch(e){await this.sendError(r,t,e),this.client.logger.error(e)}},this.isValidConnect=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(e)}const{pairingTopic:e,requiredNamespaces:r,relays:i}=t;au(e)||await this.isValidPairingTopic(e);const n=Su(r,"connect()");if(n)throw new Error(n.message);if(!xu(i,!0)){const{message:t}=iu("MISSING_OR_INVALID",`connect() relays: ${i}`);throw new Error(t)}},this.isValidApprove=async t=>{if(!Mu(t))throw new Error(iu("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:e,namespaces:r,relayProtocol:i}=t;await this.isValidProposalId(e);const n=this.client.proposal.get(e),s=Iu(r,"approve()");if(s)throw new Error(s.message);const o=ku(n.requiredNamespaces,r,"update()");if(o)throw new Error(o.message);if(!cu(i,!0)){const{message:t}=iu("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(t)}},this.isValidReject=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(e)}const{id:e,reason:r}=t;if(await this.isValidProposalId(e),!Tu(r)){const{message:t}=iu("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidSessionSettleRequest=t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(e)}const{relay:e,controller:r,namespaces:i,expiry:n}=t;if(!Au(e)){const{message:t}=iu("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(t)}const s=yu(r,"onSessionSettleRequest()");if(s)throw new Error(s.message);const o=Iu(i,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(Mh(n)){const{message:t}=iu("EXPIRED","onSessionSettleRequest()");throw new Error(t)}},this.isValidUpdate=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(e)}const{topic:e,namespaces:r}=t;await this.isValidSessionTopic(e);const i=this.client.session.get(e),n=Iu(r,"update()");if(n)throw new Error(n.message);const s=ku(i.requiredNamespaces,r,"update()");if(s)throw new Error(s.message)},this.isValidExtend=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionTopic(e)},this.isValidRequest=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(e)}const{topic:e,request:r,chainId:i}=t;await this.isValidSessionTopic(e);const{namespaces:n}=this.client.session.get(e);if(!$u(n,i)){const{message:t}=iu("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(t)}if(!Ru(r)){const{message:t}=iu("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(t)}if(!Du(n,i,r.method)){const{message:t}=iu("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(t)}},this.isValidRespond=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(e)}const{topic:e,response:r}=t;if(await this.isValidSessionTopic(e),!Pu(r)){const{message:t}=iu("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidPing=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionOrPairingTopic(e)},this.isValidEmit=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(e)}const{topic:e,event:r,chainId:i}=t;await this.isValidSessionTopic(e);const{namespaces:n}=this.client.session.get(e);if(!$u(n,i)){const{message:t}=iu("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(t)}if(!Uu(r)){const{message:t}=iu("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}if(!Cu(n,i,r.name)){const{message:t}=iu("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidDisconnect=async t=>{if(!Mu(t)){const{message:e}=iu("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionOrPairingTopic(e)}}isInitialized(){if(!this.initialized){const{message:t}=iu("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(qp.message,(async t=>{const{topic:e,message:r}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(r)))return;const i=await this.client.core.crypto.decode(e,r);Hf(i)?(this.client.core.history.set(e,i),this.onRelayEventRequest({topic:e,payload:i})):Jf(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:e,payload:i}))}))}registerExpirerEvents(){this.client.core.expirer.on(sw.expired,(async t=>{const{topic:e,id:r}=Dh(t.target);if(r&&this.getPendingSessionRequests()[r])return await this.deletePendingSessionRequest(r,iu("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession(e,!0),this.client.events.emit("session_expire",{topic:e})):r&&await this.deleteProposal(r,!0)}))}isValidPairingTopic(t){if(!cu(t,!1)){const{message:e}=iu("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=iu("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(Mh(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=iu("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!cu(t,!1)){const{message:e}=iu("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(!this.client.session.keys.includes(t)){const{message:e}=iu("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(Mh(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:e}=iu("EXPIRED",`session topic: ${t}`);throw new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(cu(t,!1)){const{message:e}=iu("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{const{message:e}=iu("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}async isValidProposalId(t){if(!Nu(t)){const{message:e}=iu("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=iu("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(Mh(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:e}=iu("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class $y extends $w{constructor(t,e){super(t,e,my,vy),this.core=t,this.logger=e}}class Dy extends $w{constructor(t,e){super(t,e,_y,vy),this.core=t,this.logger=e}}class Cy extends $w{constructor(t,e){super(t,e,jy,vy),this.core=t,this.logger=e}}class ky extends Zi{constructor(t){super(t),this.protocol=py,this.version=wy,this.name=by.name,this.events=new Ww.exports.EventEmitter,this.on=(t,e)=>this.events.on(t,e),this.once=(t,e)=>this.events.once(t,e),this.off=(t,e)=>this.events.off(t,e),this.removeListener=(t,e)=>this.events.removeListener(t,e),this.removeAllListeners=t=>this.events.removeAllListeners(t),this.connect=async t=>{try{return await this.engine.connect(t)}catch(t){throw this.logger.error(t.message),t}},this.pair=async t=>{try{return await this.engine.pair(t)}catch(t){throw this.logger.error(t.message),t}},this.approve=async t=>{try{return await this.engine.approve(t)}catch(t){throw this.logger.error(t.message),t}},this.reject=async t=>{try{return await this.engine.reject(t)}catch(t){throw this.logger.error(t.message),t}},this.update=async t=>{try{return await this.engine.update(t)}catch(t){throw this.logger.error(t.message),t}},this.extend=async t=>{try{return await this.engine.extend(t)}catch(t){throw this.logger.error(t.message),t}},this.request=async t=>{try{return await this.engine.request(t)}catch(t){throw this.logger.error(t.message),t}},this.respond=async t=>{try{return await this.engine.respond(t)}catch(t){throw this.logger.error(t.message),t}},this.ping=async t=>{try{return await this.engine.ping(t)}catch(t){throw this.logger.error(t.message),t}},this.emit=async t=>{try{return await this.engine.emit(t)}catch(t){throw this.logger.error(t.message),t}},this.disconnect=async t=>{try{return await this.engine.disconnect(t)}catch(t){throw this.logger.error(t.message),t}},this.find=t=>{try{return this.engine.find(t)}catch(t){throw this.logger.error(t.message),t}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(t){throw this.logger.error(t.message),t}},this.name=t?.name||by.name,this.metadata=t?.metadata||gh();const e=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:u(Kr.getDefaultLoggerOptions({level:t?.logger||by.logger}));this.core=t?.core||new zw(t),this.logger=Kr.generateChildLogger(e,this.name),this.session=new Dy(this.core,this.logger),this.proposal=new $y(this.core,this.logger),this.pendingRequest=new Cy(this.core,this.logger),this.engine=new Uy(this)}static async init(t){const e=new ky(t);return await e.initialize(),e}get context(){return Kr.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(t){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(t.message),t}}}var Ly={exports:{}};(function(t,e){var i=typeof self<"u"?self:r,n=function(){function t(){this.fetch=!1,this.DOMException=i.DOMException}return t.prototype=i,new t}();(function(t){(function(e){var r={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function i(t){return t&&DataView.prototype.isPrototypeOf(t)}if(r.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(t){return t&&n.indexOf(Object.prototype.toString.call(t))>-1};function o(t){if(typeof t!="string"&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function a(t){return typeof t!="string"&&(t=String(t)),t}function c(t){var e={next:function(){var e=t.shift();return{done:e===void 0,value:e}}};return r.iterable&&(e[Symbol.iterator]=function(){return e}),e}function h(t){this.map={},t instanceof h?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}h.prototype.append=function(t,e){t=o(t),e=a(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},h.prototype.delete=function(t){delete this.map[o(t)]},h.prototype.get=function(t){return t=o(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(o(t))},h.prototype.set=function(t,e){this.map[o(t)]=a(e)},h.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},h.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),c(t)},h.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),c(t)},h.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),c(t)},r.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);function u(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function f(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function l(t){var e=new FileReader,r=f(e);return e.readAsArrayBuffer(t),r}function d(t){var e=new FileReader,r=f(e);return e.readAsText(t),r}function p(t){for(var e=new Uint8Array(t),r=new Array(e.length),i=0;i<e.length;i++)r[i]=String.fromCharCode(e[i]);return r.join("")}function w(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(t){this._bodyInit=t,t?typeof t=="string"?this._bodyText=t:r.blob&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:r.formData&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():r.arrayBuffer&&r.blob&&i(t)?(this._bodyArrayBuffer=w(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(t)||s(t))?this._bodyArrayBuffer=w(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||(typeof t=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var t=u(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(l)}),this.text=function(){var t=u(this);if(t)return t;if(this._bodyBlob)return d(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(p(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(t){var e=t.toUpperCase();return v.indexOf(e)>-1?e:t}function m(t,e){e=e||{};var r=e.body;if(t instanceof m){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,!r&&t._bodyInit!=null&&(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new h(e.headers)),this.method=b(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),i=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(n))}})),e}function g(t){var e=new h,r=t.replace(/\r?\n[\t ]+/g," ");return r.split(/\r?\n/).forEach((function(t){var r=t.split(":"),i=r.shift().trim();if(i){var n=r.join(":").trim();e.append(i,n)}})),e}y.call(m.prototype);function E(t,e){e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new h(e.headers),this.url=e.url||"",this._initBody(t)}y.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var t=new E(null,{status:0,statusText:""});return t.type="error",t};var O=[301,302,303,307,308];E.redirect=function(t,e){if(O.indexOf(e)===-1)throw new RangeError("Invalid status code");return new E(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch{e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function j(t,i){return new Promise((function(n,s){var o=new m(t,i);if(o.signal&&o.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var t={status:a.status,statusText:a.statusText,headers:g(a.getAllResponseHeaders()||"")};t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL");var e="response"in a?a.response:a.responseText;n(new E(e,t))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new e.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),o.credentials==="include"?a.withCredentials=!0:o.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&r.blob&&(a.responseType="blob"),o.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),o.signal&&(o.signal.addEventListener("abort",c),a.onreadystatechange=function(){a.readyState===4&&o.signal.removeEventListener("abort",c)}),a.send(typeof o._bodyInit>"u"?null:o._bodyInit)}))}return j.polyfill=!0,t.fetch||(t.fetch=j,t.Headers=h,t.Request=m,t.Response=E),e.Headers=h,e.Request=m,e.Response=E,e.fetch=j,Object.defineProperty(e,"__esModule",{value:!0}),e})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Ly,Ly.exports);var Fy=n(Ly.exports);const Vy={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},qy=10;class Gy{constructor(t){if(this.url=t,this.events=new Ee.EventEmitter,this.isAvailable=!1,this.registering=!1,!Kf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,e){this.isAvailable||await this.register();try{const e=en(t),r=await(await Fy(this.url,Object.assign(Object.assign({},Vy),{body:e}))).json();this.onPayload({data:r})}catch(e){this.onError(t.id,e)}}async register(t=this.url){if(!Kf(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise(((t,e)=>{this.events.once("register_error",(t=>{this.resetMaxListeners(),e(t)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return e(new Error("HTTP connection is missing or invalid"));t()}))}))}this.url=t,this.registering=!0;try{const e=en({id:1,jsonrpc:"2.0",method:"test",params:[]});await Fy(t,Object.assign(Object.assign({},Vy),{body:e})),this.onOpen()}catch(t){const e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?tn(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const r=this.parseError(e),i=r.message||r.toString(),n=$f(t,i);this.events.emit("payload",n)}parseError(t,e=this.url){return Yu(t,e,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>qy&&this.events.setMaxListeners(qy)}}function Ky(t){var e;const r=(e=t[Object.keys(t)[0]])==null?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}function By(t,e){let r;return e.rpcMap&&(r=e.rpcMap[zy([t])]),r}function zy(t){return Number(t[0].split(":")[1])}class Wy{constructor(t){this.name="eip155",this.namespace=t.namespace,this.client=t.client,this.events=t.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(t){var e;switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const r=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0";return this.setDefaultChain(parseInt(r,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){if(this.chainId=parseInt(t),!this.httpProviders[t]){const r=e||By(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit("chainChanged",this.chainId)}createHttpProvider(t,e){const r=e||By(t,this.namespace);return typeof r>"u"?void 0:new Zf(new Gy(r))}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{t[e]=this.createHttpProvider(e)})),t}getAccounts(){const t=this.namespace.accounts;return t?t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2]))||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return parseInt(t.split(":")[1])}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}}class Hy{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=t.events,this.client=t.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{t[e]=this.createHttpProvider(e)})),t}getDefaultChainId(){if(this.chainId)return this.chainId;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const r=e||By(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||By(t,this.namespace);return typeof r>"u"?void 0:new Zf(new Gy(r))}}const Jy="error",Xy="wss://relay.walletconnect.com",Yy="wc",Zy="universal_provider",Qy=`${Yy}@${2}:${Zy}:`;var tv={exports:{}},ev=typeof Reflect=="object"?Reflect:null,rv=ev&&typeof ev.apply=="function"?ev.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)},iv;ev&&typeof ev.ownKeys=="function"?iv=ev.ownKeys:Object.getOwnPropertySymbols?iv=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:iv=function(t){return Object.getOwnPropertyNames(t)};function nv(t){console&&console.warn&&console.warn(t)}var sv=Number.isNaN||function(t){return t!==t};function ov(){ov.init.call(this)}tv.exports=ov,tv.exports.once=bv,ov.EventEmitter=ov,ov.prototype._events=void 0,ov.prototype._eventsCount=0,ov.prototype._maxListeners=void 0;var av=10;function cv(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(ov,"defaultMaxListeners",{enumerable:!0,get:function(){return av},set:function(t){if(typeof t!="number"||t<0||sv(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");av=t}}),ov.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ov.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||sv(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function hv(t){return t._maxListeners===void 0?ov.defaultMaxListeners:t._maxListeners}ov.prototype.getMaxListeners=function(){return hv(this)},ov.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var i=t==="error",n=this._events;if(n!==void 0)i=i&&n.error===void 0;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=n[t];if(a===void 0)return!1;if(typeof a=="function")rv(a,this,e);else for(var c=a.length,h=wv(a,c),r=0;r<c;++r)rv(h[r],this,e);return!0};function uv(t,e,r,i){var n,s,o;if(cv(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),n=hv(t),n>0&&o.length>n&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,nv(a)}return t}ov.prototype.addListener=function(t,e){return uv(this,t,e,!1)},ov.prototype.on=ov.prototype.addListener,ov.prototype.prependListener=function(t,e){return uv(this,t,e,!0)};function fv(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function lv(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=fv.bind(i);return n.listener=r,i.wrapFn=n,n}ov.prototype.once=function(t,e){return cv(e),this.on(t,lv(this,t,e)),this},ov.prototype.prependOnceListener=function(t,e){return cv(e),this.prependListener(t,lv(this,t,e)),this},ov.prototype.removeListener=function(t,e){var r,i,n,s,o;if(cv(e),i=this._events,i===void 0)return this;if(r=i[t],r===void 0)return this;if(r===e||r.listener===e)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if(typeof r!="function"){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;n===0?r.shift():yv(r,n),r.length===1&&(i[t]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",t,o||e)}return this},ov.prototype.off=ov.prototype.removeListener,ov.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[t]),this;if(arguments.length===0){var n=Object.keys(r),s;for(i=0;i<n.length;++i)s=n[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],typeof e=="function")this.removeListener(t,e);else if(e!==void 0)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this};function dv(t,e,r){var i=t._events;if(i===void 0)return[];var n=i[e];return n===void 0?[]:typeof n=="function"?r?[n.listener||n]:[n]:r?vv(n):wv(n,n.length)}ov.prototype.listeners=function(t){return dv(this,t,!0)},ov.prototype.rawListeners=function(t){return dv(this,t,!1)},ov.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):pv.call(t,e)},ov.prototype.listenerCount=pv;function pv(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}ov.prototype.eventNames=function(){return this._eventsCount>0?iv(this._events):[]};function wv(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function yv(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function vv(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function bv(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",n),r([].slice.call(arguments))}_v(t,e,s,{once:!0}),e!=="error"&&mv(t,n,{once:!0})}))}function mv(t,e,r){typeof t.on=="function"&&_v(t,"error",e,r)}function _v(t,e,r,i){if(typeof t.on=="function")i.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var gv=Object.defineProperty,Ev=Object.defineProperties,Ov=Object.getOwnPropertyDescriptors,jv=Object.getOwnPropertySymbols,Sv=Object.prototype.hasOwnProperty,Iv=Object.prototype.propertyIsEnumerable,Av=(t,e,r)=>e in t?gv(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xv=(t,e)=>{for(var r in e||(e={}))Sv.call(e,r)&&Av(t,r,e[r]);if(jv)for(var r of jv(e))Iv.call(e,r)&&Av(t,r,e[r]);return t},Nv=(t,e)=>Ev(t,Ov(e));class Mv{constructor(t){this.events=new tv.exports,this.rpcProviders={},this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:u(Kr.getDefaultLoggerOptions({level:t?.logger||Jy}))}static async init(t){const e=new Mv(t);return await e.initialize(),e}async request(t,e){var r;const[i,n]=this.validateChain(e);return await this.getProvider(i).request({request:xv({},t),chainId:`${i}:${n}`,topic:(r=this.session)==null?void 0:r.topic})}sendAsync(t,e,r){this.request(t,r).then((t=>e(null,t))).catch((t=>e(t,void 0)))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return await this.request({method:"eth_requestAccounts",params:[]})}async disconnect(){if(!this.client)throw new Error("Sign Client not initialized");await this.client.disconnect({topic:this.session.topic,reason:nu("USER_DISCONNECTED")})}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");return this.setNamespaces(t.namespaces),this.createProviders(),t.skipPairing===!0?void 0:await this.pair(t.pairingTopic)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){const{uri:e,approval:r}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces});return e&&(this.uri=e,this.events.emit("display_uri",e)),this.session=await r(),this.onSessionUpdate(),this.session}setDefaultChain(t,e){const[r,i]=this.validateChain(t);this.getProvider(r).setDefaultChain(i,e)}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${Qy}/namespaces`),this.namespaces&&this.createProviders(),this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await ky.init({logger:this.providerOpts.logger||Jy,relayUrl:this.providerOpts.relayUrl||Xy,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach((t=>{switch(t){case"eip155":this.rpcProviders[t]=new Wy({client:this.client,namespace:this.namespaces[t],events:this.events});break;case"solana":this.rpcProviders[t]=new Hy({client:this.client,namespace:this.namespaces[t],events:this.events});break}}))}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",(t=>{this.events.emit("session_ping",t)})),this.client.on("session_event",(t=>{this.events.emit("session_event",t)})),this.client.on("session_update",(({topic:t,params:e})=>{var r;const{namespaces:i}=e,n=(r=this.client)==null?void 0:r.session.get(t);this.session=Nv(xv({},n),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})})),this.client.on("session_delete",(()=>{this.events.emit("session_delete")}))}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach((t=>this.getProvider(t).updateNamespace(this.session.namespaces[t])))}setNamespaces(t){if(!t||!Object.keys(t).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${Qy}/namespaces`,t),this.namespaces=t}validateChain(t){const[e,r]=t?.split(":")||["",""];if(e&&!Object.keys(this.namespaces).includes(e))throw new Error(`Invalid namespace: ${e}`);return!e||!r?Ky(this.namespaces):[e,r]}}const Tv=Mv;t.UniversalProvider=Tv,t.default=Mv,Object.defineProperty(t,"__esModule",{value:!0})}))}));const s=r(n);var o=undefined&&undefined.__awaiter||function(t,e,r,i){function n(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,s){function o(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i["throw"](t))}catch(t){s(t)}}function c(t){t.done?r(t.value):n(t.value).then(o,a)}c((i=i.apply(t,e||[])).next())}))};var a=undefined&&undefined.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");while(o&&(o=0,a[0]&&(r=0)),r)try{if(i=1,n&&(s=a[0]&2?n["return"]:a[0]?n["throw"]||((s=n["return"])&&s.call(n),0):n.next)&&!(s=s.call(n,a[1])).done)return s;if(n=0,s)a=[a[0]&2,s.value];switch(a[0]){case 0:case 1:s=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;n=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!s||a[1]>s[0]&&a[1]<s[3])){r.label=a[1];break}if(a[0]===6&&r.label<s[1]){r.label=s[1];s=a;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(a);break}if(s[2])r.ops.pop();r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t];n=0}finally{i=s=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var c={1:"https://ethereum.publicnode.com",5:"https://eth-goerli.g.alchemy.com/v2/yVhq9zPJorAWsw-F87fEabSUl7cCU6z4",137:"https://polygon-rpc.com/",80001:"https://polygon-mumbai.g.alchemy.com/v2/rVI6pOV4irVsrw20cJxc1fxK_1cSeiY0",56:"https://bsc-dataseed.binance.org/",43114:"https://api.avax.network/ext/bc/C/rpc",250:"https://rpc.fantom.network/",25:"https://evm-cronos.crypto.org",42161:"https://arb1.arbitrum.io/rpc",10:"https://mainnet.optimism.io"};var h=["eip155:1","eip155:137","eip155:250","eip155:25","eip155:42161","eip155:10"];var u=function(){return o(void 0,void 0,void 0,(function(){return a(this,(function(t){switch(t.label){case 0:return[4,s.init({projectId:"2ec7ead81da1226703ad789c0b2f7b30",logger:"debug",relayUrl:"wss://relay.walletconnect.com"})];case 1:return[2,t.sent()]}}))}))};export{c as CUSTOM_RPCS_FOR_WC_V2,h as WC_V2_CHAINS,u as getWalletConnectV2ProviderInstance};
//# sourceMappingURL=p-884301fd.js.map